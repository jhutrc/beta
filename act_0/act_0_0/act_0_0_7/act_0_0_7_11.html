

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>1 &#8212; Challenges, Skills, and Opportunities</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'act_0/act_0_0/act_0_0_7/act_0_0_7_11';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="https://raw.githubusercontent.com/jhutrc/jhutrc.github.io/main/png/hub_and_spoke.jpg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="https://raw.githubusercontent.com/jhutrc/jhutrc.github.io/main/png/hub_and_spoke.jpg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../intro.html">
                    Welcome to Fena
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Challenges</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../act_1/act_1_0/act_1_0_0/act_1_0_0_1.html">1. Rigor</a></li>




<li class="toctree-l1"><a class="reference internal" href="../../../act_1/act_1_0/act_1_0_0/act_1_0_0_2.html">2. Error</a></li>




<li class="toctree-l1"><a class="reference internal" href="../../../act_1/act_1_0/act_1_0_0/act_1_0_0_3.html">3. Sloppiness</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Project</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../act_1/act_1_0/act_1_0_1/act_1_0_1_1.html">4. Manuscripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_1/act_1_0/act_1_0_1/act_1_0_1_2.html">5. Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_1/act_1_0/act_1_0_1/act_1_0_1_3.html">6. Git</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Numeracy</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../act_2/act_2_2/act_2_2_0/act_2_2_0_1.html">7. Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_2/act_2_2/act_2_2_0/act_2_2_0_2.html">8. R</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_2/act_2_2/act_2_2_0/act_2_2_0_3.html">9. Stata</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Literacy</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../act_3/act_3_0/act_3_0_0/act_3_0_0_1.html">10. Open Science</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_3/act_3_0/act_3_0_0/act_3_0_0_2.html">11. Self-Publishing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_3/act_3_0/act_3_0_0/act_3_0_0_3.html">12. Grants</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Workflow</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../act_3/act_3_1/act_3_1_0/act_3_1_0_1.html">13. Automate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_3/act_3_1/act_3_1_0/act_3_1_0_2.html">14. Bash</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../act_3/act_3_1/act_3_1_0/act_3_1_0_3.html">15. Unix</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../act_3/act_3_1/act_3_1_1/act_3_1_1_1.html"></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../act_3/act_3_1/act_3_1_1/act_3_1_1_2.html"></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../act_3/act_3_1/act_3_1_1/act_3_1_1_3.html"></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../act_3/act_3_2/act_3_2_0/act_3_2_0_1.html"></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../act_3/act_3_2/act_3_2_0/act_3_2_0_2.html"></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../act_3/act_3_2/act_3_2_0/act_3_2_0_3.html"></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../act_3/act_3_2/act_3_2_1/act_3_2_1_1.html"></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../act_3/act_3_2/act_3_2_1/act_3_2_1_2.html"></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../act_3/act_3_2/act_3_2_1/act_3_2_1_3.html"></a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/act_0/act_0_0/act_0_0_7/act_0_0_7_11.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>1</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">1</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">2</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">3</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sources">3.1 sources</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#packages">3.2 packages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#variables">3.3 variables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table1">3.4 table1</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#datasets">3.5 datasets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#time-to-event">3.6 time-to-event</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#kaplan-meier">3.7 kaplan-meier</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cox-model">3.8 cox model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fig1">3.9 fig1</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fig2">3.10 fig2</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">3.11 time-to-event</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">3.12 kaplan-meier</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">3.13 cox model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">3.14 fig1</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fig3">3.15 fig3</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fig4">3.16 fig4</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fig4-kaplan-meier">3.17 fig4 kaplan-meier</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lincom">3.18 lincom</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hr-95-ci">3.19 hr, 95%ci</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">3.20 kaplan-meier</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#coef-matrix">3.21 coef matrix</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#var-cov-matrix">3.22 var-cov matrix</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="id1">
<h1>1<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h1>
<p>Matt/Abi code-snippet to guide one using ‘cat_trauma’ function</p>
<p>1.1 Install the relevant packages</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">suppressWarnings</span><span class="p">({</span>
<span class="w">  </span><span class="nf">invisible</span><span class="p">({</span>
<span class="w">    </span><span class="nf">rm</span><span class="p">(</span><span class="n">list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">ls</span><span class="p">())</span>

<span class="w">    </span><span class="nf">if </span><span class="p">(</span><span class="o">!</span><span class="nf">require</span><span class="p">(</span><span class="n">icdpicr</span><span class="p">,</span><span class="w"> </span><span class="n">quietly</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">warn.conflicts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">))</span><span class="w"> </span><span class="nf">install.packages</span><span class="p">(</span><span class="s">&#39;icdpicr&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="nf">if </span><span class="p">(</span><span class="o">!</span><span class="nf">require</span><span class="p">(</span><span class="n">dplyr</span><span class="p">,</span><span class="w"> </span><span class="n">quietly</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">warn.conflicts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">))</span><span class="w"> </span><span class="nf">install.packages</span><span class="p">(</span><span class="s">&#39;dplyr&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="nf">if </span><span class="p">(</span><span class="o">!</span><span class="nf">require</span><span class="p">(</span><span class="n">readr</span><span class="p">,</span><span class="w"> </span><span class="n">quietly</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">warn.conflicts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">))</span><span class="w"> </span><span class="nf">install.packages</span><span class="p">(</span><span class="s">&#39;readr&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="nf">if </span><span class="p">(</span><span class="o">!</span><span class="nf">require</span><span class="p">(</span><span class="n">tidyr</span><span class="p">,</span><span class="w"> </span><span class="n">quietly</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">warn.conflicts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">))</span><span class="w"> </span><span class="nf">install.packages</span><span class="p">(</span><span class="s">&#39;tidyr&#39;</span><span class="p">)</span>

<span class="w">    </span><span class="nf">library</span><span class="p">(</span><span class="n">icdpicr</span><span class="p">,</span><span class="w"> </span><span class="n">quietly</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">warn.conflicts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
<span class="w">    </span><span class="nf">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">,</span><span class="w"> </span><span class="n">quietly</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">warn.conflicts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
<span class="w">    </span><span class="nf">library</span><span class="p">(</span><span class="n">readr</span><span class="p">,</span><span class="w"> </span><span class="n">quietly</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">warn.conflicts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
<span class="w">    </span><span class="nf">library</span><span class="p">(</span><span class="n">tidyr</span><span class="p">,</span><span class="w"> </span><span class="n">quietly</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">warn.conflicts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
<span class="w">  </span><span class="p">})</span>
<span class="p">})</span>
</pre></div>
</div>
<p>1.2 Get some documentation</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ls</span><span class="p">(</span><span class="s">&quot;package:icdpicr&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>1.3 Study the syntax</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print</span><span class="p">(</span><span class="n">cat_trauma</span><span class="p">)</span>
</pre></div>
</div>
<p>1.4 What is the value of dx_pre?</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print</span><span class="p">(</span><span class="n">injury</span><span class="p">)</span>
</pre></div>
</div>
<p>1.5 As such, the syntax is:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># use subset of injury given its size</span>
<span class="n">inj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">injury</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">100</span><span class="p">,</span><span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">]</span>
<span class="n">df_score</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">cat_trauma</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">inj</span><span class="p">,</span><span class="w"> </span><span class="n">dx_pre</span><span class="o">=</span><span class="s">&quot;dx&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">icd10</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">i10_iss_method</span><span class="o">=</span><span class="s">&quot;roc_max_NIS&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">calc_method</span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">verbose</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
<span class="c1"># visualize the output</span>
<span class="n">df_score</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">9</span><span class="p">,</span><span class="m">1</span><span class="o">:</span><span class="m">9</span><span class="p">];</span><span class="w"> </span><span class="n">df_score</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">9</span><span class="p">,</span><span class="m">10</span><span class="o">:</span><span class="m">14</span><span class="p">];</span><span class="w"> </span><span class="n">df_score</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">9</span><span class="p">,</span><span class="m">15</span><span class="o">:</span><span class="m">18</span><span class="p">];</span><span class="w"> </span><span class="n">df_score</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">9</span><span class="p">,</span><span class="m">34</span><span class="o">:</span><span class="m">35</span><span class="p">]</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="id2">
<h1>2<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h1>
<p>Calvin Matthew’s code-snippet for NHANES Table 1</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">install.packages</span><span class="p">(</span><span class="s">&quot;tableone&quot;</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">tableone</span><span class="p">)</span>
<span class="nf">install.packages</span><span class="p">(</span><span class="s">&quot;tidyverse&quot;</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span>
<span class="nf">install.packages</span><span class="p">(</span><span class="s">&quot;NHANES&quot;</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">NHANES</span><span class="p">)</span>
<span class="nf">install.packages</span><span class="p">(</span><span class="s">&quot;dplyr&quot;</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span>
<span class="nf">install.packages</span><span class="p">(</span><span class="s">&quot;nhanesA&quot;</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">nhanesA</span><span class="p">)</span>

<span class="c1"># Creating Dataset With All Years</span>
<span class="n">demo</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">bind_rows</span><span class="p">(</span><span class="nf">nhanes</span><span class="p">(</span><span class="s">&quot;DEMO&quot;</span><span class="p">),</span><span class="nf">nhanes</span><span class="p">(</span><span class="s">&quot;DEMO_B&quot;</span><span class="p">,</span><span class="s">&quot;DEMO_C&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;DEMO_D&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;DEMO_E&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;DEMO_F&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;DEMO_G&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;DEMO_H&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;DEMO_I&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;DEMO_J&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;DEMO_P&quot;</span><span class="p">))</span>
<span class="c1"># Categorical Data</span>
<span class="n">demo</span><span class="p">[</span><span class="s">&quot;RIAGENDR&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">count</span><span class="p">(</span><span class="n">RIAGENDR</span><span class="p">)</span>
<span class="n">catVars</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;DMDEDUC2&quot;</span><span class="p">,</span><span class="s">&quot;RIAGENDR&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;RIDRETH1&quot;</span><span class="p">)</span>
<span class="n">demo</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">subset</span><span class="p">(</span><span class="n">demo</span><span class="p">,</span><span class="w"> </span><span class="n">RIDAGEYR</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">17</span><span class="p">)</span>
<span class="n">tab</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">CreateTableOne</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">demo</span><span class="p">,</span><span class="w"> </span><span class="n">factorVars</span><span class="o">=</span><span class="n">catVars</span><span class="p">)</span>

<span class="c1"># Sorted Categorical and Continuous Outputs</span>
<span class="nf">print</span><span class="p">(</span><span class="n">tab</span><span class="o">$</span><span class="n">CatTable</span><span class="p">,</span><span class="w"> </span><span class="n">showAllLevels</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">tab</span><span class="o">$</span><span class="n">ContTable</span><span class="p">,</span><span class="w"> </span><span class="n">nonnormal</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
<span class="n">summary_table</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">all_years_data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">summarize</span><span class="p">(</span>
<span class="n">MedianAge</span><span class="o">=</span><span class="nf">median</span><span class="p">(</span><span class="n">Age</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">),</span>
<span class="n">MedianSBP</span><span class="o">=</span><span class="nf">median</span><span class="p">(</span><span class="n">BPSysAve</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">),</span>
<span class="n">MedianDBP</span><span class="o">=</span><span class="nf">median</span><span class="p">(</span><span class="n">BPDiaAve</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">),</span>
<span class="n">MedianCreatinine</span><span class="o">=</span><span class="nf">median</span><span class="p">(</span><span class="n">LBDSCRSI</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">),</span>
<span class="n">MedianBMI</span><span class="o">=</span><span class="nf">median</span><span class="p">(</span><span class="n">BMI</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">),</span>
<span class="n">MedianHbA1c</span><span class="o">=</span><span class="nf">median</span><span class="p">(</span><span class="n">HbA1c</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">),</span>
<span class="n">MedianuACR</span><span class="o">=</span><span class="nf">median</span><span class="p">(</span><span class="n">uACR</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">),</span>
<span class="n">MedianGlucose</span><span class="o">=</span><span class="nf">median</span><span class="p">(</span><span class="n">Pulse</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">),</span>
<span class="n">FemalePercentage</span><span class="o">=</span><span class="nf">mean</span><span class="p">(</span><span class="n">Sex</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Female&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">),</span>
<span class="n">HypertensionPercentage</span><span class="o">=</span><span class="nf">mean</span><span class="p">(</span><span class="n">Hypertension</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Yes&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">),</span>
<span class="n">SmokePercentage</span><span class="o">=</span><span class="nf">mean</span><span class="p">(</span><span class="n">SmokingStatus</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Current&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">),</span>
<span class="n">RaceEthnicityPercentage</span><span class="o">=</span><span class="nf">table</span><span class="p">(</span><span class="n">RaceEthnicity</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">RaceEthnicity</span><span class="p">),</span>
<span class="n">EducationPercentage</span><span class="o">=</span><span class="nf">table</span><span class="p">(</span><span class="n">Education</span><span class="p">)</span>
<span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">summary_table</span><span class="p">)</span>

<span class="c1"># Cohort Percentage One-by-One</span>
<span class="n">nhanes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">subset</span><span class="p">(</span><span class="nf">nhanes</span><span class="p">(</span><span class="s">&quot;DEMO_P&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">RIDAGEYR</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">17</span><span class="p">)</span>
<span class="n">divisor</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">count</span><span class="p">(</span><span class="n">nhanes</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id3">
<h1>3<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h1>
<p>Andrew code for Risk of ESRD in donors</p>
<hr class="docutils" />
<section id="sources">
<h2>3.1 sources<a class="headerlink" href="#sources" title="Permalink to this heading">#</a></h2>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># sources</span>
<span class="n">vars.donor_live.dta</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;don_id&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s">&quot;don_recov_dt&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s">&quot;don_age&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s">&quot;don_gender&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s">&quot;don_race&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s">&quot;don_hist_cigarette&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s">&quot;don_diab&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s">&quot;don_hist_hyperten&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s">&quot;don_hgt_cm&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s">&quot;don_wgt_kg&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s">&quot;don_ki_creat_preop&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s">&quot;don_bp_preop_syst&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s">&quot;don_bp_preop_diast&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s">&quot;don_education&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s">&quot;don_relationship_ty&quot;</span>
<span class="w">              </span><span class="p">)</span>

<span class="n">vars.don_liv_cms.dta</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;pers_esrd_first_service_dt&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s">&quot;pers_ssa_death_dt&quot;</span>
<span class="w">              </span><span class="p">)</span>

<span class="n">vars.ki.dta</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;don_id&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s">&quot;rec_age_at_tx&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s">&quot;rec_dgn&quot;</span>
<span class="w">              </span><span class="p">)</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="packages">
<h2>3.2 packages<a class="headerlink" href="#packages" title="Permalink to this heading">#</a></h2>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># packages</span>
<span class="nf">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">haven</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">tableone</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">Hmisc</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">nephro</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">survival</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">survminer</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">lmtest</span><span class="p">)</span>

<span class="c1"># data: File paths go here</span>
<span class="c1"># Global path </span>
<span class="n">global.path</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&quot;~amassie/mock_cdrg/&quot;</span>

<span class="c1"># donor_live data goes on the following line</span>
<span class="n">d1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read_dta</span><span class="p">(</span><span class="nf">paste0</span><span class="p">(</span><span class="n">global.path</span><span class="p">,</span><span class="s">&quot;donor_live.dta&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="w">       </span><span class="nf">select</span><span class="p">(</span><span class="nf">all_of</span><span class="p">(</span><span class="n">vars.donor_live.dta</span><span class="p">),</span><span class="w"> </span><span class="nf">all_of</span><span class="p">(</span><span class="n">vars.don_liv_cms.dta</span><span class="p">))</span>


<span class="c1"># tx_ki dataframe here </span>
<span class="n">d2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read_dta</span><span class="p">(</span><span class="nf">paste0</span><span class="p">(</span><span class="n">global.path</span><span class="p">,</span><span class="s">&quot;tx_ki.dta&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="w">       </span><span class="nf">select</span><span class="p">(</span><span class="n">vars.ki.dta</span><span class="p">)</span>

<span class="n">d</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">left_join </span><span class="p">(</span><span class="n">d1</span><span class="p">,</span><span class="w"> </span><span class="n">d2</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="s">&quot;don_id&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="variables">
<h2>3.3 variables<a class="headerlink" href="#variables" title="Permalink to this heading">#</a></h2>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># table1 columns</span>
<span class="n">d</span><span class="o">$</span><span class="n">race</span><span class="w"> </span><span class="o">&lt;-</span><span class="w">    </span><span class="nf">fct_collapse</span><span class="p">(</span><span class="nf">as.factor</span><span class="p">(</span><span class="n">d</span><span class="o">$</span><span class="n">don_race</span><span class="p">),</span>
<span class="w">  </span><span class="s">&quot;Asian&quot;</span><span class="o">=</span><span class="s">&quot;64&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="s">&quot;Black&quot;</span><span class="o">=</span><span class="s">&quot;16&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="s">&quot;Hispanic&quot;</span><span class="o">=</span><span class="s">&quot;2000&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="s">&quot;White&quot;</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;8&quot;</span><span class="p">,</span><span class="s">&quot;24&quot;</span><span class="p">,</span><span class="s">&quot;32&quot;</span><span class="p">,</span><span class="s">&quot;40&quot;</span><span class="p">,</span><span class="s">&quot;48&quot;</span><span class="p">,</span><span class="s">&quot;56&quot;</span><span class="p">,</span><span class="s">&quot;72&quot;</span><span class="p">,</span><span class="s">&quot;80&quot;</span><span class="p">,</span><span class="s">&quot;88&quot;</span><span class="p">,</span><span class="s">&quot;96&quot;</span><span class="p">,</span><span class="s">&quot;104&quot;</span><span class="p">,</span><span class="s">&quot;112&quot;</span><span class="p">,</span><span class="s">&quot;128&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s">&quot;136&quot;</span><span class="p">,</span><span class="s">&quot;144&quot;</span><span class="p">,</span><span class="s">&quot;152&quot;</span><span class="p">,</span><span class="s">&quot;160&quot;</span><span class="p">,</span><span class="s">&quot;192&quot;</span><span class="p">,</span><span class="s">&quot;200&quot;</span><span class="p">,</span><span class="s">&quot;224&quot;</span><span class="p">,</span><span class="s">&quot;232&quot;</span><span class="p">,</span><span class="s">&quot;248&quot;</span><span class="p">,</span><span class="s">&quot;1024&quot;</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># table1 rows</span>
<span class="n">d</span><span class="o">$</span><span class="n">famRisk</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">fct_collapse</span><span class="p">(</span><span class="nf">as.factor</span><span class="p">(</span><span class="n">d</span><span class="o">$</span><span class="n">don_relationship_ty</span><span class="p">),</span>
<span class="w">  </span><span class="s">&quot;Parent&quot;</span><span class="o">=</span><span class="s">&quot;1&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="s">&quot;Child&quot;</span><span class="o">=</span><span class="s">&quot;2&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="s">&quot;Twin&quot;</span><span class="o">=</span><span class="s">&quot;3&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="s">&quot;Sibling&quot;</span><span class="o">=</span><span class="s">&quot;4&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="s">&quot;Other&quot;</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;5&quot;</span><span class="p">,</span><span class="s">&quot;6&quot;</span><span class="p">),</span>
<span class="w">  </span><span class="s">&quot;Unrelated&quot;</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;7&quot;</span><span class="p">,</span><span class="s">&quot;8&quot;</span><span class="p">,</span><span class="s">&quot;9&quot;</span><span class="p">,</span><span class="s">&quot;10&quot;</span><span class="p">,</span><span class="s">&quot;11&quot;</span><span class="p">,</span><span class="s">&quot;12&quot;</span><span class="p">,</span><span class="s">&quot;14&quot;</span><span class="p">,</span><span class="s">&quot;15&quot;</span><span class="p">,</span><span class="s">&quot;998&quot;</span><span class="p">,</span><span class="s">&quot;999&quot;</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">d</span><span class="o">$</span><span class="n">spouse</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">fct_collapse</span><span class="p">(</span><span class="nf">as.factor</span><span class="p">(</span><span class="n">d</span><span class="o">$</span><span class="n">don_relationship_ty</span><span class="p">),</span>
<span class="w">  </span><span class="s">&quot;Spouse&quot;</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;7&quot;</span><span class="p">,</span><span class="s">&quot;8&quot;</span><span class="p">),</span>
<span class="w">  </span><span class="s">&quot;Non-spouse&quot;</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;1&quot;</span><span class="p">,</span><span class="s">&quot;2&quot;</span><span class="p">,</span><span class="s">&quot;3&quot;</span><span class="p">,</span><span class="s">&quot;4&quot;</span><span class="p">,</span><span class="s">&quot;5&quot;</span><span class="p">,</span><span class="s">&quot;6&quot;</span><span class="p">,</span><span class="s">&quot;9&quot;</span><span class="p">,</span><span class="s">&quot;10&quot;</span><span class="p">,</span><span class="s">&quot;11&quot;</span><span class="p">,</span><span class="s">&quot;12&quot;</span><span class="p">,</span><span class="s">&quot;14&quot;</span><span class="p">,</span><span class="s">&quot;15&quot;</span><span class="p">,</span><span class="s">&quot;998&quot;</span><span class="p">,</span><span class="s">&quot;999&quot;</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">d</span><span class="o">$</span><span class="n">educ</span><span class="w"> </span><span class="o">&lt;-</span><span class="w">    </span><span class="nf">fct_collapse</span><span class="p">(</span><span class="nf">as.factor</span><span class="p">(</span><span class="n">d</span><span class="o">$</span><span class="n">don_education</span><span class="p">),</span>
<span class="w">  </span><span class="s">&quot;&lt;High School&quot;</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;1&quot;</span><span class="p">,</span><span class="s">&quot;2&quot;</span><span class="p">,</span><span class="s">&quot;3&quot;</span><span class="p">),</span>
<span class="w">  </span><span class="s">&quot;Attended College&quot;</span><span class="o">=</span><span class="s">&quot;4&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="s">&quot;Graduate&quot;</span><span class="o">=</span><span class="s">&quot;5&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="s">&quot;Postgraduate&quot;</span><span class="o">=</span><span class="s">&quot;6&quot;</span>
<span class="p">)</span>

<span class="c1"># replace study-specific codes with NA</span>
<span class="n">d</span><span class="o">$</span><span class="n">educ</span><span class="p">[</span><span class="n">d</span><span class="o">$</span><span class="n">educ</span><span class="o">==</span><span class="m">998</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NA</span>
<span class="n">d</span><span class="o">$</span><span class="n">educ</span><span class="p">[</span><span class="n">d</span><span class="o">$</span><span class="n">educ</span><span class="o">==</span><span class="m">996</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NA</span>

<span class="n">d</span><span class="o">$</span><span class="n">year</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">substring</span><span class="p">(</span><span class="n">d</span><span class="o">$</span><span class="n">don_recov_dt</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">4</span><span class="p">))</span>

<span class="n">d</span><span class="o">$</span><span class="n">dm</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NA</span>
<span class="n">d</span><span class="o">$</span><span class="n">dm</span><span class="p">[</span><span class="n">d</span><span class="o">$</span><span class="n">don_diab</span><span class="o">==</span><span class="s">&quot;Y&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span>
<span class="n">d</span><span class="o">$</span><span class="n">dm</span><span class="p">[</span><span class="n">d</span><span class="o">$</span><span class="n">don_diab</span><span class="o">==</span><span class="s">&quot;N&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0</span>

<span class="n">d</span><span class="o">$</span><span class="n">htn</span><span class="w"> </span><span class="o">&lt;-</span><span class="w">     </span><span class="nf">fct_collapse</span><span class="p">(</span><span class="nf">as.factor</span><span class="p">(</span><span class="n">d</span><span class="o">$</span><span class="n">don_hist_hyperten</span><span class="p">),</span>
<span class="w">   </span><span class="s">&quot;Hypertension&quot;</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;2&quot;</span><span class="p">,</span><span class="s">&quot;3&quot;</span><span class="p">,</span><span class="s">&quot;4&quot;</span><span class="p">,</span><span class="s">&quot;5&quot;</span><span class="p">),</span>
<span class="w">   </span><span class="s">&quot;No Hypertension&quot;</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;1&quot;</span><span class="p">,</span><span class="s">&quot;998&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">d</span><span class="o">$</span><span class="n">htn</span><span class="p">[</span><span class="n">d</span><span class="o">$</span><span class="n">don_hist_hyperten</span><span class="o">==</span><span class="m">998</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NA</span>

<span class="n">d</span><span class="o">$</span><span class="n">cig</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NA</span>
<span class="n">d</span><span class="o">$</span><span class="n">cig</span><span class="p">[</span><span class="n">d</span><span class="o">$</span><span class="n">don_hist_cigarette</span><span class="o">==</span><span class="s">&quot;Y&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span>
<span class="n">d</span><span class="o">$</span><span class="n">cig</span><span class="p">[</span><span class="n">d</span><span class="o">$</span><span class="n">don_hist_cigarette</span><span class="o">==</span><span class="s">&quot;N&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0</span>

<span class="n">d</span><span class="o">$</span><span class="n">rec.dgn</span><span class="w"> </span><span class="o">&lt;-</span><span class="nf">fct_collapse</span><span class="p">(</span><span class="nf">as.factor</span><span class="p">(</span><span class="n">d</span><span class="o">$</span><span class="n">rec_dgn</span><span class="p">),</span>
<span class="w">  </span><span class="s">&quot;Diabetes&quot;</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;3011&quot;</span><span class="p">,</span><span class="s">&quot;3012&quot;</span><span class="p">,</span><span class="s">&quot;3038&quot;</span><span class="p">,</span><span class="s">&quot;3039&quot;</span><span class="p">,</span><span class="s">&quot;3069&quot;</span><span class="p">,</span><span class="s">&quot;3070&quot;</span><span class="p">,</span><span class="s">&quot;3071&quot;</span><span class="p">,</span><span class="s">&quot;5001&quot;</span><span class="p">,</span><span class="s">&quot;5002&quot;</span><span class="p">,</span><span class="s">&quot;5009&quot;</span><span class="p">),</span>
<span class="w">  </span><span class="s">&quot;Hypertension&quot;</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;3034&quot;</span><span class="p">,</span><span class="s">&quot;3040&quot;</span><span class="p">,</span><span class="s">&quot;3050&quot;</span><span class="p">,</span><span class="s">&quot;3066&quot;</span><span class="p">),</span>
<span class="w">  </span><span class="s">&quot;Glomerulonephritis&quot;</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;3000&quot;</span><span class="p">,</span><span class="s">&quot;3001&quot;</span><span class="p">,</span><span class="s">&quot;3002&quot;</span><span class="p">,</span><span class="s">&quot;3003&quot;</span><span class="p">,</span><span class="s">&quot;3004&quot;</span><span class="p">,</span><span class="s">&quot;3005&quot;</span><span class="p">,</span><span class="s">&quot;3006&quot;</span><span class="p">,</span><span class="s">&quot;3041&quot;</span><span class="p">,</span>
<span class="w">                         </span><span class="s">&quot;3042&quot;</span><span class="p">,</span><span class="s">&quot;3043&quot;</span><span class="p">,</span><span class="s">&quot;3051&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;3064&quot;</span><span class="p">,</span><span class="s">&quot;3068&quot;</span><span class="p">,</span><span class="s">&quot;3018&quot;</span><span class="p">,</span><span class="s">&quot;3019&quot;</span><span class="p">,</span><span class="s">&quot;3024&quot;</span><span class="p">,</span>
<span class="w">                         </span><span class="s">&quot;3033&quot;</span><span class="p">,</span><span class="s">&quot;3035&quot;</span><span class="p">,</span><span class="s">&quot;3053&quot;</span><span class="p">,</span><span class="s">&quot;3054&quot;</span><span class="p">,</span><span class="s">&quot;3055&quot;</span><span class="p">,</span><span class="s">&quot;3056&quot;</span><span class="p">,</span><span class="s">&quot;3057&quot;</span><span class="p">),</span>
<span class="w">  </span><span class="s">&quot;Cystic Kidney Disease&quot;</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;3008&quot;</span><span class="p">,</span><span class="s">&quot;3028&quot;</span><span class="p">),</span>
<span class="w">  </span><span class="s">&quot;Urologic Disease&quot;</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;3013&quot;</span><span class="p">,</span><span class="s">&quot;3014&quot;</span><span class="p">,</span><span class="s">&quot;3015&quot;</span><span class="p">,</span><span class="s">&quot;3031&quot;</span><span class="p">,</span><span class="s">&quot;3032&quot;</span><span class="p">,</span><span class="s">&quot;3036&quot;</span><span class="p">),</span>
<span class="w">  </span><span class="s">&quot;Other Diagnosis&quot;</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;3025&quot;</span><span class="p">,</span><span class="s">&quot;3052&quot;</span><span class="p">,</span><span class="s">&quot;3061&quot;</span><span class="p">,</span><span class="s">&quot;3007&quot;</span><span class="p">,</span><span class="s">&quot;3009&quot;</span><span class="p">,</span><span class="s">&quot;3010&quot;</span><span class="p">,</span><span class="s">&quot;3017&quot;</span><span class="p">,</span><span class="s">&quot;3030&quot;</span><span class="p">,</span>
<span class="w">                      </span><span class="s">&quot;3044&quot;</span><span class="p">,</span><span class="s">&quot;3045&quot;</span><span class="p">,</span><span class="s">&quot;3046&quot;</span><span class="p">,</span><span class="s">&quot;3047&quot;</span><span class="p">,</span><span class="s">&quot;3048&quot;</span><span class="p">,</span><span class="s">&quot;3049&quot;</span><span class="p">,</span><span class="s">&quot;3059&quot;</span><span class="p">,</span><span class="s">&quot;3060&quot;</span><span class="p">,</span><span class="s">&quot;3063&quot;</span><span class="p">,</span>
<span class="w">                      </span><span class="s">&quot;3073&quot;</span><span class="p">,</span><span class="s">&quot;3016&quot;</span><span class="p">,</span><span class="s">&quot;3020&quot;</span><span class="p">,</span><span class="s">&quot;3021&quot;</span><span class="p">,</span><span class="s">&quot;3022&quot;</span><span class="p">,</span><span class="s">&quot;3023&quot;</span><span class="p">,</span><span class="s">&quot;3058&quot;</span><span class="p">,</span><span class="s">&quot;3062&quot;</span><span class="p">),</span>
<span class="w">  </span><span class="s">&quot;Unknown&quot;</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;3026&quot;</span><span class="p">,</span><span class="s">&quot;3027&quot;</span><span class="p">,</span><span class="s">&quot;3029&quot;</span><span class="p">,</span><span class="s">&quot;3072&quot;</span><span class="p">,</span><span class="s">&quot;3074&quot;</span><span class="p">,</span><span class="s">&quot;999&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">)</span>

<span class="c1"># egfr formula</span>
<span class="n">d</span><span class="o">$</span><span class="n">female</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ifelse</span><span class="p">(</span><span class="n">d</span><span class="o">$</span><span class="n">don_gender</span><span class="o">==</span><span class="s">&quot;F&quot;</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">0</span><span class="p">)</span>
<span class="n">d</span><span class="o">$</span><span class="n">male</span><span class="w"> </span><span class="o">&lt;-</span><span class="w">  </span><span class="nf">ifelse</span><span class="p">(</span><span class="n">d</span><span class="o">$</span><span class="n">don_gender</span><span class="o">==</span><span class="s">&quot;F&quot;</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">)</span>
<span class="n">d</span><span class="o">$</span><span class="n">black</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ifelse</span><span class="p">(</span><span class="n">d</span><span class="o">$</span><span class="n">don_race</span><span class="o">==</span><span class="m">16</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">0</span><span class="p">)</span>

<span class="c1"># egfr estimate is sensitive to this step</span>
<span class="c1">#d$don_ki_creat_preop &lt;- ifelse(d$don_ki_creat_preop&gt;3,NA,d$don_ki_creat_preop)</span>
<span class="n">d</span><span class="o">$</span><span class="n">k</span><span class="o">=</span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">ifelse</span><span class="p">(</span><span class="n">d</span><span class="o">$</span><span class="n">don_gender</span><span class="o">==</span><span class="s">&quot;F&quot;</span><span class="p">,</span><span class="m">0.7</span><span class="p">,</span><span class="m">0.9</span><span class="p">))</span>
<span class="n">d</span><span class="o">$</span><span class="n">alpha</span><span class="o">=</span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">ifelse</span><span class="p">(</span><span class="n">d</span><span class="o">$</span><span class="n">don_gender</span><span class="o">==</span><span class="s">&quot;F&quot;</span><span class="p">,</span><span class="m">-0.329</span><span class="p">,</span><span class="m">-0.411</span><span class="p">))</span>

<span class="n">d</span><span class="o">$</span><span class="n">egfr</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">141</span><span class="o">*</span><span class="nf">pmin</span><span class="p">(</span><span class="n">d</span><span class="o">$</span><span class="n">don_ki_creat_preop</span><span class="o">/</span><span class="n">d</span><span class="o">$</span><span class="n">k</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="n">na.rm</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="o">^</span><span class="n">d</span><span class="o">$</span><span class="n">alpha</span><span class="o">*</span>
<span class="w">              </span><span class="nf">pmax</span><span class="p">(</span><span class="n">d</span><span class="o">$</span><span class="n">don_ki_creat_preop</span><span class="o">/</span><span class="n">d</span><span class="o">$</span><span class="n">k</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="n">na.rm</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="o">^</span><span class="m">-1.209</span><span class="o">*</span>
<span class="w">                  </span><span class="m">0.993</span><span class="o">^</span><span class="n">d</span><span class="o">$</span><span class="n">don_age</span><span class="o">*</span>
<span class="w">                  </span><span class="m">1.018</span><span class="o">^</span><span class="n">d</span><span class="o">$</span><span class="n">female</span><span class="o">*</span>
<span class="w">                  </span><span class="m">1.159</span><span class="o">^</span><span class="n">d</span><span class="o">$</span><span class="n">black</span>

<span class="c1"># for now use this!</span>
<span class="n">d</span><span class="o">$</span><span class="n">gfr</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">CKDEpi.creat</span><span class="p">(</span><span class="n">d</span><span class="o">$</span><span class="n">don_ki_creat_preop</span><span class="p">,</span><span class="n">d</span><span class="o">$</span><span class="n">male</span><span class="p">,</span><span class="n">d</span><span class="o">$</span><span class="n">don_age</span><span class="p">,</span><span class="n">d</span><span class="o">$</span><span class="n">black</span><span class="p">)</span>

<span class="c1"># implausible = NA</span>
<span class="n">d</span><span class="o">$</span><span class="n">gfr</span><span class="p">[</span><span class="n">d</span><span class="o">$</span><span class="n">gfr</span><span class="o">&gt;</span><span class="m">200</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NA</span>
<span class="n">d</span><span class="o">$</span><span class="n">egfr</span><span class="p">[</span><span class="n">d</span><span class="o">$</span><span class="n">egfr</span><span class="o">&gt;</span><span class="m">200</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NA</span>
<span class="n">d</span><span class="o">$</span><span class="n">don_hgt_cm</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ifelse</span><span class="p">(</span><span class="n">d</span><span class="o">$</span><span class="n">don_hgt_cm</span><span class="o">&gt;</span><span class="m">120</span><span class="p">,</span><span class="n">d</span><span class="o">$</span><span class="n">don_hgt_cm</span><span class="p">,</span><span class="kc">NA</span><span class="p">)</span>
<span class="n">d</span><span class="o">$</span><span class="n">don_wgt_kg</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ifelse</span><span class="p">(</span><span class="n">d</span><span class="o">$</span><span class="n">don_wgt_kg</span><span class="o">&lt;</span><span class="m">200</span><span class="p">,</span><span class="n">d</span><span class="o">$</span><span class="n">don_wgt_kg</span><span class="p">,</span><span class="kc">NA</span><span class="p">)</span>
<span class="n">d</span><span class="o">$</span><span class="n">bmi</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">d</span><span class="o">$</span><span class="n">don_wgt_kg</span><span class="o">/</span><span class="p">(</span><span class="n">d</span><span class="o">$</span><span class="n">don_hgt_cm</span><span class="o">/</span><span class="m">100</span><span class="p">)</span><span class="o">^</span><span class="m">2</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="table1">
<h2>3.4 table1<a class="headerlink" href="#table1" title="Permalink to this heading">#</a></h2>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># prep work</span>
<span class="n">listVars</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;don_age&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s">&quot;don_gender&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s">&quot;cig&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s">&quot;dm&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s">&quot;htn&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s">&quot;bmi&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s">&quot;don_ki_creat_preop&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s">&quot;egfr&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s">&quot;don_bp_preop_syst&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s">&quot;don_bp_preop_diast&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s">&quot;year&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s">&quot;educ&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s">&quot;famRisk&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s">&quot;spouse&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s">&quot;rec_age_at_tx&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s">&quot;rec.dgn&quot;</span>
<span class="w">              </span><span class="p">)</span>

<span class="c1"># subset data</span>
<span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">d</span><span class="p">[,</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;race&quot;</span><span class="p">,</span><span class="n">listVars</span><span class="p">)]</span>

<span class="c1"># continue prep</span>
<span class="n">iqr</span><span class="w"> </span><span class="o">&lt;-</span><span class="w">      </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;don_age&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s">&quot;bmi&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s">&quot;egfr&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s">&quot;don_ki_creat_preop&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s">&quot;don_bp_preop_syst&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s">&quot;don_bp_preop_diast&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s">&quot;year&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s">&quot;rec_age_at_tx&quot;</span>
<span class="w">              </span><span class="p">)</span>
<span class="n">catVars</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;don_gender&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s">&quot;famRisk&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s">&quot;spouse&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s">&quot;educ&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s">&quot;dm&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s">&quot;htn&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s">&quot;cig&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s">&quot;rec.dgn&quot;</span>
<span class="w">              </span><span class="p">)</span>

<span class="c1"># change order of factors</span>
<span class="n">df</span><span class="o">$</span><span class="n">race</span><span class="w"> </span><span class="o">&lt;-</span><span class="w">     </span><span class="nf">ordered</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">race</span><span class="p">,</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Asian&quot;</span><span class="p">,</span><span class="s">&quot;Black&quot;</span><span class="p">,</span><span class="s">&quot;Hispanic&quot;</span><span class="p">,</span><span class="s">&quot;White&quot;</span><span class="p">))</span>
<span class="n">df</span><span class="o">$</span><span class="n">don_gender</span><span class="w"> </span><span class="o">&lt;-</span><span class="nf">ordered</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">don_gender</span><span class="p">,</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;M&quot;</span><span class="p">,</span><span class="s">&quot;F&quot;</span><span class="p">))</span>
<span class="n">df</span><span class="o">$</span><span class="n">famRisk</span><span class="w"> </span><span class="o">&lt;-</span><span class="w">  </span><span class="nf">ordered</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">famRisk</span><span class="p">,</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Unrelated&quot;</span><span class="p">,</span><span class="s">&quot;Other&quot;</span><span class="p">,</span><span class="s">&quot;Parent&quot;</span><span class="p">,</span><span class="s">&quot;Child&quot;</span><span class="p">,</span>
<span class="w">                                   </span><span class="s">&quot;Sibling&quot;</span><span class="p">,</span><span class="s">&quot;Twin&quot;</span><span class="p">))</span>
<span class="n">df</span><span class="o">$</span><span class="n">rec.dgn</span><span class="w"> </span><span class="o">&lt;-</span><span class="w">  </span><span class="nf">ordered</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">rec.dgn</span><span class="p">,</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Diabetes&quot;</span><span class="p">,</span><span class="s">&quot;Hypertension&quot;</span><span class="p">,</span><span class="s">&quot;Glomerulonephritis&quot;</span><span class="p">,</span>
<span class="w">                                   </span><span class="s">&quot;Cystic Kidney Disease&quot;</span><span class="p">,</span><span class="s">&quot;Urologic Disease&quot;</span><span class="p">,</span>
<span class="w">                                   </span><span class="s">&quot;Other Diagnosis&quot;</span><span class="p">,</span><span class="s">&quot;Unknown&quot;</span><span class="p">))</span>

<span class="c1"># label vars</span>
<span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="nf">tibble</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="w">  </span><span class="n">labelled</span><span class="o">::</span><span class="nf">set_variable_labels</span><span class="p">(</span><span class="n">race</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Race&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">don_age</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Age, y&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">    </span><span class="n">don_gender</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Women&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">bmi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Body-Mass Index, Kg/m^2&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">famRisk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Donor-Recipient Relationship&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">spouse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Spouse or life partner of recipient&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">educ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Education&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">dm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Diabetes&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">htn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Hypertension&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">egfr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;eGFR, ml/min/1.73m^2&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">don_ki_creat_preop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Serum Creatinine, mg/dL&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">don_bp_preop_syst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;SBP&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">don_bp_preop_diast</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;DBP&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">year</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Year of donation&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">cig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;History of Smoking&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">rec_age_at_tx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Recipient Age, y&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">rec.dgn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Recipient Cause of ESRD&quot;</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="n">labelled</span><span class="o">::</span><span class="nf">set_value_labels</span><span class="p">(</span>
<span class="w">    </span><span class="n">race</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Asian&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;2&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Black&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;3&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Hispanic&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;4&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;White&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span>

<span class="c1"># create table1</span>
<span class="n">table1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">CreateTableOne</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
<span class="w">                         </span><span class="n">strata</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;race&quot;</span><span class="p">),</span>
<span class="w">                         </span><span class="n">vars</span><span class="o">=</span><span class="n">listVars</span><span class="p">,</span>
<span class="w">                         </span><span class="n">factorVars</span><span class="o">=</span><span class="n">catVars</span><span class="p">,</span>
<span class="w">                         </span><span class="n">test</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
<span class="c1"># export to .csv</span>
<span class="nf">write.csv</span><span class="p">(</span><span class="nf">print</span><span class="p">(</span><span class="n">table1</span><span class="p">,</span>
<span class="w">                </span><span class="n">format</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;p&quot;</span><span class="p">),</span>
<span class="w">                </span><span class="n">missing</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">,</span>
<span class="w">                </span><span class="n">nonnormal</span><span class="o">=</span><span class="n">iqr</span><span class="p">,</span>
<span class="w">                </span><span class="n">varLabels</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span>
<span class="w">                </span><span class="n">dropEqual</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span>
<span class="w">                </span><span class="n">catDigits</span><span class="o">=</span><span class="m">1</span><span class="p">,</span>
<span class="w">                </span><span class="n">contDigits</span><span class="o">=</span><span class="m">1</span><span class="p">,</span>
<span class="w">                </span><span class="p">),</span><span class="s">&quot;./tableone.csv&quot;</span><span class="p">,</span><span class="n">row.names</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
</pre></div>
</div>
<hr class="docutils" />
<p>Asian Americans account for <a class="reference external" href="https://minorityhealth.hhs.gov/omh/browse.aspx?lvl=3&amp;lvlid=63">5.7%</a> of the nation’s population but only <code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">round(as.numeric(table(df$race)[1])*100/sum(table(df$race)),1)</span></code>% of
the live kidney donor population.</p>
<p>The analysis is run three times: overall, younger than 50, and older than 50</p>
</section>
<hr class="docutils" />
<section id="datasets">
<h2>3.5 datasets<a class="headerlink" href="#datasets" title="Permalink to this heading">#</a></h2>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">copy</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df</span>
<span class="n">copy1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">d</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="time-to-event">
<h2>3.6 time-to-event<a class="headerlink" href="#time-to-event" title="Permalink to this heading">#</a></h2>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># dates</span>
<span class="n">df</span><span class="o">$</span><span class="n">censor</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">as.Date</span><span class="p">(</span><span class="s">&quot;12/31/20&quot;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s">&quot;%m/%d/%y&quot;</span><span class="p">))</span>
<span class="n">df</span><span class="o">$</span><span class="n">pers_esrd_first_service_dt</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">d</span><span class="o">$</span><span class="n">pers_esrd_first_service_dt</span><span class="p">)</span>
<span class="n">df</span><span class="o">$</span><span class="n">pers_ssa_death_dt</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">d</span><span class="o">$</span><span class="n">pers_ssa_death_dt</span><span class="p">)</span>
<span class="n">df</span><span class="o">$</span><span class="n">don_recov_dt</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">d</span><span class="o">$</span><span class="n">don_recov_dt</span><span class="p">)</span>

<span class="c1"># events</span>
<span class="n">df</span><span class="o">$</span><span class="n">esrd</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ifelse</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">d</span><span class="o">$</span><span class="n">pers_esrd_first_service_dt</span><span class="p">),</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">)</span>
<span class="n">df</span><span class="o">$</span><span class="n">mort</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ifelse</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">d</span><span class="o">$</span><span class="n">pers_ssa_death_dt</span><span class="p">),</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">)</span>
<span class="nf">table</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">esrd</span><span class="p">)</span>
<span class="nf">table</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">mort</span><span class="p">)</span>

<span class="n">df</span><span class="o">$</span><span class="n">esrd_dt</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ifelse</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">pers_esrd_first_service_dt</span><span class="p">),</span><span class="n">df</span><span class="o">$</span><span class="n">censor</span><span class="p">,</span><span class="n">df</span><span class="o">$</span><span class="n">pers_esrd_first_service_dt</span><span class="p">)</span>
<span class="n">df</span><span class="o">$</span><span class="n">mort_dt</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ifelse</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">pers_ssa_death_dt</span><span class="p">),</span><span class="n">df</span><span class="o">$</span><span class="n">censor</span><span class="p">,</span><span class="n">df</span><span class="o">$</span><span class="n">pers_ssa_death_dt</span><span class="p">)</span>

<span class="c1"># times</span>
<span class="n">df</span><span class="o">$</span><span class="n">fup_esrd</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">esrd_dt</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">df</span><span class="o">$</span><span class="n">don_recov_dt</span><span class="p">)</span><span class="o">/</span><span class="m">365.25</span>
<span class="n">df</span><span class="o">$</span><span class="n">fup_mort</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">mort_dt</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">df</span><span class="o">$</span><span class="n">don_recov_dt</span><span class="p">)</span><span class="o">/</span><span class="m">365.25</span>

<span class="c1"># implausible</span>
<span class="c1"># highly influential</span>
<span class="c1"># no ostriches welcome!</span>
<span class="nf">set.seed</span><span class="p">(</span><span class="m">053021</span><span class="p">)</span>
<span class="nf">sum</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">fup_esrd</span><span class="o">&lt;=</span><span class="m">0</span><span class="p">))</span>

<span class="c1"># adjust p to assess sensitivity</span>
<span class="n">df</span><span class="o">$</span><span class="n">esrd</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ifelse</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">fup_esrd</span><span class="o">&lt;=</span><span class="m">0</span><span class="p">,</span><span class="n">df</span><span class="o">$</span><span class="n">esrd</span><span class="o">*</span><span class="nf">rbinom</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="n">.</span><span class="m">9</span><span class="p">),</span><span class="n">df</span><span class="o">$</span><span class="n">esrd</span><span class="p">)</span><span class="w"> </span>
<span class="n">df</span><span class="o">$</span><span class="n">mort</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ifelse</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">fup_mort</span><span class="o">&lt;=</span><span class="m">0</span><span class="p">,</span><span class="n">df</span><span class="o">$</span><span class="n">mort</span><span class="o">*</span><span class="nf">rbinom</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="n">.</span><span class="m">9</span><span class="p">),</span><span class="n">df</span><span class="o">$</span><span class="n">mort</span><span class="p">)</span>
<span class="nf">table</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">esrd</span><span class="p">)</span>
<span class="nf">table</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">mort</span><span class="p">)</span>

<span class="n">df</span><span class="o">$</span><span class="n">fup_esrd</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ifelse</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">fup_esrd</span><span class="o">&lt;=</span><span class="m">0</span><span class="p">,</span><span class="nf">sample</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">fup_esrd</span><span class="p">,</span><span class="m">1</span><span class="p">),</span><span class="n">df</span><span class="o">$</span><span class="n">fup_esrd</span><span class="p">)</span>
<span class="n">df</span><span class="o">$</span><span class="n">fup_mort</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ifelse</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">fup_mort</span><span class="o">&lt;=</span><span class="m">0</span><span class="p">,</span><span class="nf">sample</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">fup_mort</span><span class="p">,</span><span class="m">1</span><span class="p">),</span><span class="n">df</span><span class="o">$</span><span class="n">fup_mort</span><span class="p">)</span>
<span class="n">df</span><span class="o">$</span><span class="n">end_dt</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">esrd_dt</span><span class="p">,</span><span class="n">df</span><span class="o">$</span><span class="n">mort_dt</span><span class="p">)</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="kaplan-meier">
<h2>3.7 kaplan-meier<a class="headerlink" href="#kaplan-meier" title="Permalink to this heading">#</a></h2>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># white is reference</span>
<span class="n">df</span><span class="o">$</span><span class="n">eth</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">d</span><span class="o">$</span><span class="n">race</span>

<span class="c1"># make unrelated reference</span>
<span class="n">df</span><span class="o">$</span><span class="n">fam</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">relevel</span><span class="p">(</span><span class="n">d</span><span class="o">$</span><span class="n">famRisk</span><span class="p">,</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Unrelated&quot;</span><span class="p">))</span><span class="w"> </span>
<span class="n">km</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">survfit</span><span class="p">(</span><span class="nf">Surv</span><span class="p">(</span><span class="n">fup_esrd</span><span class="p">,</span><span class="n">esrd</span><span class="p">)</span><span class="o">~</span><span class="n">eth</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># black vs. non-black reasonable?</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">km</span><span class="p">,</span><span class="w"> </span><span class="n">conf.int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">fun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;event&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">     </span><span class="n">ylim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="n">.</span><span class="m">03</span><span class="p">),</span>
<span class="w">     </span><span class="n">xlim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">30</span><span class="p">),</span>
<span class="w">     </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Years&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">     </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Incidence&quot;</span><span class="p">,</span>
<span class="w">     </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;green&quot;</span><span class="p">,</span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="s">&quot;violet&quot;</span><span class="p">),</span><span class="w"> </span>
<span class="w">     </span><span class="n">lwd</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">3</span><span class="p">),</span><span class="n">las</span><span class="o">=</span><span class="m">1</span><span class="p">,</span>
<span class="w">     </span><span class="n">lty</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">),</span>
<span class="w">     </span><span class="n">cex.axis</span><span class="o">=</span><span class="m">1.5</span><span class="p">,</span>
<span class="w">     </span><span class="n">cex.lab</span><span class="o">=</span><span class="m">1.5</span><span class="p">)</span>
<span class="nf">legend</span><span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="n">.</span><span class="m">015</span><span class="p">,</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Black&quot;</span><span class="p">,</span>
<span class="w">               </span><span class="s">&quot;White&quot;</span><span class="p">,</span>
<span class="w">               </span><span class="s">&quot;Asian&quot;</span><span class="p">,</span>
<span class="w">               </span><span class="s">&quot;Hispanic&quot;</span><span class="p">),</span>
<span class="w">       </span><span class="n">lty</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">),</span><span class="n">lwd</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">3</span><span class="p">),</span><span class="n">col</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="s">&quot;green&quot;</span><span class="p">,</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="s">&quot;violet&quot;</span><span class="p">),</span><span class="n">cex</span><span class="o">=</span><span class="m">1.5</span><span class="p">,</span><span class="n">bty</span><span class="o">=</span><span class="s">&quot;n&quot;</span><span class="p">)</span>

<span class="c1"># black vs. non-black reasonable?</span>
<span class="n">fit.eth</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">coxph</span><span class="p">(</span><span class="nf">Surv</span><span class="p">(</span><span class="n">fup_esrd</span><span class="p">,</span><span class="n">esrd</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">eth</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span><span class="w"> </span>
<span class="nf">summary</span><span class="p">(</span><span class="n">fit.eth</span><span class="p">)</span><span class="o">$</span><span class="n">coef</span>

<span class="c1"># related vs. unrelated reasonable?</span>
<span class="n">fit.fam</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">coxph</span><span class="p">(</span><span class="nf">Surv</span><span class="p">(</span><span class="n">fup_esrd</span><span class="p">,</span><span class="n">esrd</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">fam</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span><span class="w"> </span>
<span class="nf">summary</span><span class="p">(</span><span class="n">fit.fam</span><span class="p">)</span><span class="o">$</span><span class="n">coef</span>

<span class="c1"># strong a priori reasonable?</span>
<span class="n">fit.full</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">coxph</span><span class="p">(</span><span class="nf">Surv</span><span class="p">(</span><span class="n">fup_esrd</span><span class="p">,</span><span class="n">esrd</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">eth</span><span class="o">*</span><span class="n">fam</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span><span class="w"> </span>
<span class="nf">summary</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">$</span><span class="n">coef</span>

<span class="c1"># strong a priori reasonable?</span>
<span class="n">fit.null</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">coxph</span><span class="p">(</span><span class="nf">Surv</span><span class="p">(</span><span class="n">fup_esrd</span><span class="p">,</span><span class="n">esrd</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">eth</span><span class="o">+</span><span class="n">fam</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span><span class="w"> </span>
<span class="nf">summary</span><span class="p">(</span><span class="n">fit.null</span><span class="p">)</span><span class="o">$</span><span class="n">coef</span>

<span class="c1"># model with interaction is better fit </span>
<span class="n">lrt</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lmtest</span><span class="o">::</span><span class="nf">lrtest</span><span class="p">(</span><span class="n">fit.full</span><span class="p">,</span><span class="n">fit.null</span><span class="p">);</span><span class="w"> </span><span class="n">lrt</span>
<span class="n">chi</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="nf">as.matrix</span><span class="p">(</span><span class="n">lrt</span><span class="p">)[</span><span class="m">2</span><span class="p">,</span><span class="m">4</span><span class="p">],</span><span class="m">3</span><span class="p">);</span><span class="w"> </span><span class="n">chi</span>
<span class="n">pval</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="nf">as.matrix</span><span class="p">(</span><span class="n">lrt</span><span class="p">)[</span><span class="m">2</span><span class="p">,</span><span class="m">5</span><span class="p">],</span><span class="m">3</span><span class="p">);</span><span class="w"> </span><span class="n">pval</span>
</pre></div>
</div>
<hr class="docutils" />
<p>Where <span class="math notranslate nohighlight">\(Y\)</span> is log of the relative hazards and <span class="math notranslate nohighlight">\(\beta_i\)</span> (where <span class="math notranslate nohighlight">\(i=1,2,...,23\)</span> ) are regression coefficients:</p>
<p><span class="math notranslate nohighlight">\(Y=\beta_1ethBlack+\beta_2ethAsian+\beta_3ethHispanic+\beta_4famParent+\beta_5famChild+\beta_6famTwin+\beta_7famSibling+\beta_8famOther+\beta_9ethBlack:famParent+\beta_{10}ethAsian:famParent+\beta_{11}ethHispanic:famParent+\beta_{12}ethBlack:famChild+\beta_{13}ethAsian:famChild+\beta_{14}ethHispanic:famChild+\beta_{15}ethBlack:famTwin+\beta_{16}ethAsian:famTwin+\beta_{17}ethHsipanic:famTwin+\beta_{18}ethBlack:famSibling+\beta_{19}ethAsian:famSibling+\beta_{20}ethHispanic:famSibling+\beta_{21}ethBlack:famOther+\beta_{22}ethAsian:famOther+\beta_{23}ethHispanic:famOther\)</span></p>
</section>
<hr class="docutils" />
<section id="cox-model">
<h2>3.8 cox model<a class="headerlink" href="#cox-model" title="Permalink to this heading">#</a></h2>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># basic output</span>
<span class="n">beta.fit.full</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">coefficients</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span>
<span class="n">vcov.fit.full</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span>
<span class="nf">write.csv</span><span class="p">(</span><span class="nf">print</span><span class="p">(</span><span class="n">beta.fit.full</span>
<span class="w">                </span><span class="p">),</span><span class="s">&quot;./betafamRisk.csv&quot;</span><span class="p">,</span><span class="n">row.names</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
<span class="nf">write.csv</span><span class="p">(</span><span class="nf">print</span><span class="p">(</span><span class="n">vcov.fit.full</span>
<span class="w">                </span><span class="p">),</span><span class="s">&quot;./vcovfamRisk.csv&quot;</span><span class="p">,</span><span class="n">row.names</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>

<span class="c1">## unrelated: white is reference</span>
<span class="c1">## speaks to contextual effects or linkage disequilibrium?</span>
<span class="c1"># black: b1</span>
<span class="n">Abu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">22</span><span class="p">))</span>
<span class="n">bu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Abu</span><span class="p">)</span><span class="o">%*%</span><span class="nf">coefficients</span><span class="p">(</span><span class="n">fit.full</span><span class="p">))</span>
<span class="n">se.bu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Abu</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Abu</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">bu</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">bu</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.bu</span><span class="p">)</span>

<span class="c1"># asian: b2</span>
<span class="n">Aau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">21</span><span class="p">))</span>
<span class="n">au</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Aau</span><span class="p">)</span><span class="o">%*%</span><span class="nf">coefficients</span><span class="p">(</span><span class="n">fit.full</span><span class="p">))</span>
<span class="n">se.au</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Aau</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Aau</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">au</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">au</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.au</span><span class="p">)</span>

<span class="c1"># hispanic: b3</span>
<span class="n">Ahu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">20</span><span class="p">))</span>
<span class="n">hu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Ahu</span><span class="p">)</span><span class="o">%*%</span><span class="nf">coefficients</span><span class="p">(</span><span class="n">fit.full</span><span class="p">))</span>
<span class="n">se.hu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Ahu</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Ahu</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">hu</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">hu</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.hu</span><span class="p">)</span>

<span class="c1">## white</span>
<span class="c1"># white twin: b6</span>
<span class="n">Awt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">5</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">17</span><span class="p">))</span>
<span class="n">wt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Awt</span><span class="p">)</span><span class="o">%*%</span><span class="nf">coefficients</span><span class="p">(</span><span class="n">fit.full</span><span class="p">))</span>
<span class="n">se.wt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Awt</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Awt</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">wt</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">wt</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.wt</span><span class="p">)</span>

<span class="c1"># white sibling: b7</span>
<span class="n">Aws</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">6</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">16</span><span class="p">))</span>
<span class="n">ws</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Aws</span><span class="p">)</span><span class="o">%*%</span><span class="nf">coefficients</span><span class="p">(</span><span class="n">fit.full</span><span class="p">))</span>
<span class="n">se.ws</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Aws</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Aws</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">ws</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">ws</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.ws</span><span class="p">)</span>

<span class="c1"># white child: b5</span>
<span class="n">Awc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">6</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">16</span><span class="p">))</span>
<span class="n">wc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Awc</span><span class="p">)</span><span class="o">%*%</span><span class="nf">coefficients</span><span class="p">(</span><span class="n">fit.full</span><span class="p">))</span>
<span class="n">se.wc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Awc</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Awc</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">wc</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">wc</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.wc</span><span class="p">)</span>

<span class="c1"># white parent: b4</span>
<span class="n">Awp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">3</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">19</span><span class="p">))</span>
<span class="n">wp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Awp</span><span class="p">)</span><span class="o">%*%</span><span class="nf">coefficients</span><span class="p">(</span><span class="n">fit.full</span><span class="p">))</span>
<span class="n">se.wp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Awp</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Awp</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">wp</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">wp</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.wp</span><span class="p">)</span>

<span class="c1"># white other: b8</span>
<span class="n">Awo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">7</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">15</span><span class="p">))</span>
<span class="n">wo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Awo</span><span class="p">)</span><span class="o">%*%</span><span class="nf">coefficients</span><span class="p">(</span><span class="n">fit.full</span><span class="p">))</span>
<span class="n">se.wo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Awo</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Awo</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">wo</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">wp</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.wo</span><span class="p">)</span>

<span class="c1">## black</span>
<span class="c1"># black unrelated: b1</span>
<span class="n">Abu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">22</span><span class="p">))</span>
<span class="n">bu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Abu</span><span class="p">)</span><span class="o">%*%</span><span class="nf">coefficients</span><span class="p">(</span><span class="n">fit.full</span><span class="p">))</span>
<span class="n">se.bu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Abu</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Abu</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">bu</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">bu</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.bu</span><span class="p">)</span>

<span class="c1"># black twin: b1 + b6 + b15</span>
<span class="n">Abt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">5</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">8</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">8</span><span class="p">))</span>
<span class="n">bt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Abt</span><span class="p">)</span><span class="o">%*%</span><span class="nf">coefficients</span><span class="p">(</span><span class="n">fit.full</span><span class="p">))</span>
<span class="n">se.bt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Abt</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Abt</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">bt</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">bt</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.bt</span><span class="p">)</span>

<span class="c1"># black sibling: b1 + b7 + b18</span>
<span class="n">Abs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">6</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">10</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">5</span><span class="p">))</span>
<span class="n">bs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Abs</span><span class="p">)</span><span class="o">%*%</span><span class="nf">coefficients</span><span class="p">(</span><span class="n">fit.full</span><span class="p">))</span>
<span class="n">se.bs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Abs</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Abs</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">bs</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">bs</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.bs</span><span class="p">)</span>

<span class="c1"># black child: b1 + b5 + b12</span>
<span class="n">Abc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">4</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">6</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">11</span><span class="p">))</span>
<span class="n">bc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Abc</span><span class="p">)</span><span class="o">%*%</span><span class="nf">coefficients</span><span class="p">(</span><span class="n">fit.full</span><span class="p">))</span>
<span class="n">se.bc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Abc</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Abc</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">bc</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">bc</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.bc</span><span class="p">)</span>

<span class="c1"># black parent: b1 + b4 + b9</span>
<span class="n">Abp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">3</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">4</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">14</span><span class="p">))</span>
<span class="n">bp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Abp</span><span class="p">)</span><span class="o">%*%</span><span class="nf">coefficients</span><span class="p">(</span><span class="n">fit.full</span><span class="p">))</span>
<span class="n">se.bp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Abp</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Abp</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">bp</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">bp</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.bp</span><span class="p">)</span>

<span class="c1"># black other: b1 + b8 + b21</span>
<span class="n">Abo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">7</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">12</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">2</span><span class="p">))</span>
<span class="n">bo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Abo</span><span class="p">)</span><span class="o">%*%</span><span class="nf">coefficients</span><span class="p">(</span><span class="n">fit.full</span><span class="p">))</span>
<span class="n">se.bo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Abo</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Abo</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">bo</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">bo</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.bo</span><span class="p">)</span>

<span class="c1">## hispanic</span>
<span class="c1"># hispanic unrelated: b3</span>
<span class="n">Ahu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">2</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">20</span><span class="p">))</span>
<span class="n">hu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Ahu</span><span class="p">)</span><span class="o">%*%</span><span class="nf">coefficients</span><span class="p">(</span><span class="n">fit.full</span><span class="p">))</span>
<span class="n">se.hu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Ahu</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Ahu</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">hu</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">hu</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.hu</span><span class="p">)</span>

<span class="c1"># hispanic twin: b3 + b6 + b17</span>
<span class="n">Aht</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">5</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">10</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">6</span><span class="p">))</span>
<span class="n">ht</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Aht</span><span class="p">)</span><span class="o">%*%</span><span class="nf">coefficients</span><span class="p">(</span><span class="n">fit.full</span><span class="p">))</span>
<span class="n">se.ht</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Aht</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Aht</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">ht</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">ht</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.ht</span><span class="p">)</span>

<span class="c1"># hispanic sibling: b3 + b7 + b20</span>
<span class="n">Ahs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">6</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">12</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">3</span><span class="p">))</span>
<span class="n">hs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Ahs</span><span class="p">)</span><span class="o">%*%</span><span class="nf">coefficients</span><span class="p">(</span><span class="n">fit.full</span><span class="p">))</span>
<span class="n">se.hs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Ahs</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Ahs</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">hs</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">hs</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.hs</span><span class="p">)</span>

<span class="c1"># hispanic child: b3 + b5 + b14</span>
<span class="n">Ahc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">4</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">8</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">9</span><span class="p">))</span>
<span class="n">hc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Ahc</span><span class="p">)</span><span class="o">%*%</span><span class="nf">coefficients</span><span class="p">(</span><span class="n">fit.full</span><span class="p">))</span>
<span class="n">se.hc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Ahc</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Ahc</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">hc</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">hc</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.hc</span><span class="p">)</span>

<span class="c1"># hispanic parent: b3 + b4 + b11</span>
<span class="n">Ahp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">3</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">6</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">12</span><span class="p">))</span>
<span class="n">hp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Ahp</span><span class="p">)</span><span class="o">%*%</span><span class="nf">coefficients</span><span class="p">(</span><span class="n">fit.full</span><span class="p">))</span>
<span class="n">se.hp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Ahp</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Ahp</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">hp</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">hp</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.hp</span><span class="p">)</span>

<span class="c1"># hispanic other: b3 + b8 + b23</span>
<span class="n">Aho</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">7</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">14</span><span class="p">),</span><span class="m">1</span><span class="p">)</span>
<span class="n">ho</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Aho</span><span class="p">)</span><span class="o">%*%</span><span class="nf">coefficients</span><span class="p">(</span><span class="n">fit.full</span><span class="p">))</span>
<span class="n">se.ho</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Aho</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Aho</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">ho</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">ho</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.ho</span><span class="p">)</span>

<span class="c1">## asian</span>
<span class="c1"># asian unrelated: b2</span>
<span class="n">Aau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">21</span><span class="p">))</span>
<span class="n">au</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Aau</span><span class="p">)</span><span class="o">%*%</span><span class="nf">coefficients</span><span class="p">(</span><span class="n">fit.full</span><span class="p">))</span>
<span class="n">se.au</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Aau</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Aau</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">au</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">au</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.au</span><span class="p">)</span>

<span class="c1"># asian twin: b2 + b6 + b16</span>
<span class="n">Aat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">5</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">9</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">7</span><span class="p">))</span>
<span class="n">at</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Aat</span><span class="p">)</span><span class="o">%*%</span><span class="nf">coefficients</span><span class="p">(</span><span class="n">fit.full</span><span class="p">))</span>
<span class="n">se.at</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Aat</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Aat</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">at</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">at</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.at</span><span class="p">)</span>

<span class="c1"># asian sibling: b2 + b7 + b19</span>
<span class="n">Aas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">6</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">11</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">4</span><span class="p">))</span>
<span class="n">as</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Aas</span><span class="p">)</span><span class="o">%*%</span><span class="nf">coefficients</span><span class="p">(</span><span class="n">fit.full</span><span class="p">))</span>
<span class="n">se.as</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Aas</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Aas</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">as</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">as</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.as</span><span class="p">)</span>

<span class="c1"># asian child: b2 + b5 + b13</span>
<span class="n">Aac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">4</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">8</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">9</span><span class="p">))</span>
<span class="n">ac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Aac</span><span class="p">)</span><span class="o">%*%</span><span class="nf">coefficients</span><span class="p">(</span><span class="n">fit.full</span><span class="p">))</span>
<span class="n">se.ac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Aac</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Aac</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">ac</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">ac</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.ac</span><span class="p">)</span>

<span class="c1"># asian parent: b2 + b4 + b10</span>
<span class="n">Aap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">3</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">5</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">13</span><span class="p">))</span>
<span class="n">ap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Aap</span><span class="p">)</span><span class="o">%*%</span><span class="nf">coefficients</span><span class="p">(</span><span class="n">fit.full</span><span class="p">))</span>
<span class="n">se.ap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Aap</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Aap</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">ap</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">ap</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.ap</span><span class="p">)</span>

<span class="c1"># asian other: b2 + b8 + b22</span>
<span class="n">Aao</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">7</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">13</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="m">0</span><span class="p">)</span>
<span class="n">ao</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Aao</span><span class="p">)</span><span class="o">%*%</span><span class="nf">coefficients</span><span class="p">(</span><span class="n">fit.full</span><span class="p">))</span>
<span class="n">se.ao</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Aao</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Aao</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">ao</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">ao</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.ao</span><span class="p">)</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="fig1">
<h2>3.9 fig1<a class="headerlink" href="#fig1" title="Permalink to this heading">#</a></h2>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># hr (95% CI)</span>

<span class="n">fig1.df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="m">2</span><span class="o">:</span><span class="m">21</span><span class="p">,</span>
<span class="w">           </span><span class="n">hr</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="nf">exp</span><span class="p">(</span><span class="n">wo</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">wc</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">ws</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">wt</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">bo</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">bp</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">bc</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">bs</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">bt</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">ho</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">hp</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">hc</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">hs</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">ht</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">ao</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">ap</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">ac</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">as</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">at</span><span class="p">)),</span>
<span class="w">           </span><span class="n">lb.hr</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="nf">exp</span><span class="p">(</span><span class="n">wo</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.wo</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">wp</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.wp</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">wc</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.wc</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">ws</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.ws</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">wt</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.wt</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">bo</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.bo</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">bp</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.bp</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">bc</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.bc</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">bs</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.bs</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">bt</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.bt</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">ho</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.ho</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">hp</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.hp</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">hc</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.hc</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">hs</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.hs</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">ht</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.ht</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">ao</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.ao</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">ap</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.ap</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">ac</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.ac</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">as</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.as</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">at</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.at</span><span class="p">)),</span>
<span class="w">           </span><span class="n">ub.hr</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="nf">exp</span><span class="p">(</span><span class="n">wo</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.wo</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">wp</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.wp</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">wc</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.wc</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">ws</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.ws</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">wt</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.wt</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">bo</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.bo</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">bp</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.bp</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">bc</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.bc</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">bs</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.bs</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">bt</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.bt</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">ho</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.ho</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">hp</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.hp</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">hc</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.hc</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">hs</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.hs</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">ht</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.ht</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">ao</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.ao</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">ap</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.ap</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">ac</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.ac</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">as</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.as</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">at</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.at</span><span class="p">))</span>
<span class="w">           </span><span class="p">)</span>

<span class="n">fig1.df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rbind</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="n">fig1.df</span><span class="p">)</span>
<span class="n">fig1.df</span><span class="o">$</span><span class="n">race</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">6</span><span class="p">),</span><span class="nf">rep</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">5</span><span class="p">),</span><span class="nf">rep</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="m">5</span><span class="p">),</span><span class="nf">rep</span><span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="m">5</span><span class="p">))</span>
<span class="n">fig1.df</span><span class="o">$</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ordered</span><span class="p">(</span><span class="n">fig1.df</span><span class="o">$</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">levels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">21</span><span class="p">),</span><span class="w"> </span>
<span class="w">                        </span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Unr&quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Oth&quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Par&quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Off&quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Sib&quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Twi&quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Oth &quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Par &quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Off &quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Sib &quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Twi &quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Oth  &quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Par  &quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Off  &quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Sib  &quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Twi  &quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Oth   &quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Par   &quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Off   &quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Sib   &quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Twi   &quot;</span>
<span class="w">                                 </span><span class="p">)</span>
<span class="w">                     </span><span class="p">)</span>
<span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">fig1.df</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">factor</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">hr</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="nf">as.factor</span><span class="p">(</span><span class="n">race</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme_bw</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_hline</span><span class="p">(</span><span class="n">yintercept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="s">&quot;Hazard Ratios (95% CI)&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">       </span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">scale_color_manual</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Race&quot;</span><span class="p">,</span>
<span class="w">                     </span><span class="n">values</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;2&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;2&quot;</span><span class="o">=</span><span class="s">&quot;3&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;3&quot;</span><span class="o">=</span><span class="s">&quot;4&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;4&quot;</span><span class="o">=</span><span class="s">&quot;5&quot;</span><span class="p">),</span>
<span class="w">                     </span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;White&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Black&quot;</span><span class="p">,</span><span class="s">&quot;Hispanic&quot;</span><span class="p">,</span><span class="s">&quot;Asian&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">geom_errorbar</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="n">.</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">ymin</span><span class="o">=</span><span class="n">lb.hr</span><span class="p">,</span><span class="w"> </span><span class="n">ymax</span><span class="o">=</span><span class="n">ub.hr</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">scale_y_log10</span><span class="p">(</span><span class="n">breaks</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">.</span><span class="m">01</span><span class="p">,</span><span class="n">.</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">10</span><span class="p">,</span><span class="m">100</span><span class="p">,</span><span class="m">1000</span><span class="p">,</span><span class="m">10000</span><span class="p">),</span><span class="n">limits</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">.</span><span class="m">01</span><span class="p">,</span><span class="m">10000</span><span class="p">),</span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;0.01&quot;</span><span class="p">,</span><span class="s">&quot;0.1&quot;</span><span class="p">,</span><span class="s">&quot;1&quot;</span><span class="p">,</span><span class="s">&quot;10&quot;</span><span class="p">,</span><span class="s">&quot;100&quot;</span><span class="p">,</span><span class="s">&quot;1000&quot;</span><span class="p">,</span><span class="s">&quot;10000&quot;</span><span class="p">))</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="fig2">
<h2>3.10 fig2<a class="headerlink" href="#fig2" title="Permalink to this heading">#</a></h2>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">km</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">survfit</span><span class="p">(</span><span class="nf">Surv</span><span class="p">(</span><span class="n">fup_esrd</span><span class="p">,</span><span class="n">esrd</span><span class="p">)</span><span class="o">~</span><span class="n">race</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="nf">ggsurvplot</span><span class="p">(</span>
<span class="w">  </span><span class="n">km</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="n">fun</span><span class="o">=</span><span class="s">&quot;event&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="n">risk.table</span><span class="o">=</span><span class="bp">T</span><span class="p">,</span>
<span class="w">  </span><span class="n">test.for.trend</span><span class="o">=</span><span class="bp">T</span><span class="p">,</span>
<span class="w">  </span><span class="n">conf.int</span><span class="o">=</span><span class="bp">F</span><span class="p">,</span>
<span class="w">  </span><span class="n">xlim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">30</span><span class="p">),</span>
<span class="w">  </span><span class="n">ylim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="n">.</span><span class="m">03</span><span class="p">),</span>
<span class="w">  </span><span class="n">linetype</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">4</span><span class="p">),</span>
<span class="w">  </span><span class="n">break.time.by</span><span class="o">=</span><span class="m">5</span><span class="p">,</span>
<span class="w">  </span><span class="n">ggtheme</span><span class="o">=</span><span class="nf">theme_minimal</span><span class="p">(),</span>
<span class="w">  </span><span class="n">lty</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">),</span>
<span class="w">  </span><span class="n">lwd</span><span class="o">=</span><span class="m">3</span><span class="p">,</span>
<span class="w">  </span><span class="n">risk.table.y.text.col</span><span class="o">=</span><span class="bp">T</span><span class="p">,</span>
<span class="w">  </span><span class="n">risk.table.y.text</span><span class="o">=</span><span class="bp">F</span><span class="p">,</span>
<span class="w">  </span><span class="n">surv.plot.height</span><span class="o">=</span><span class="n">.</span><span class="m">9</span><span class="p">,</span>
<span class="w">  </span><span class="n">risk.table.height</span><span class="o">=</span><span class="n">.</span><span class="m">3</span><span class="p">,</span>
<span class="w">  </span><span class="n">censor</span><span class="o">=</span><span class="bp">F</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="id4">
<h2>3.11 time-to-event<a class="headerlink" href="#id4" title="Permalink to this heading">#</a></h2>
<p>Young Donors Analysis</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># dates</span>
<span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">copy</span><span class="p">[</span><span class="n">copy</span><span class="o">$</span><span class="n">don_age</span><span class="o">&lt;</span><span class="m">50</span><span class="p">,]</span>
<span class="n">d</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">copy1</span><span class="p">[</span><span class="n">copy1</span><span class="o">$</span><span class="n">don_age</span><span class="o">&lt;</span><span class="m">50</span><span class="p">,]</span>
<span class="n">df</span><span class="o">$</span><span class="n">censor</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">as.Date</span><span class="p">(</span><span class="s">&quot;12/31/20&quot;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s">&quot;%m/%d/%y&quot;</span><span class="p">))</span>
<span class="n">df</span><span class="o">$</span><span class="n">pers_esrd_first_service_dt</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">d</span><span class="o">$</span><span class="n">pers_esrd_first_service_dt</span><span class="p">)</span>
<span class="n">df</span><span class="o">$</span><span class="n">pers_ssa_death_dt</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">d</span><span class="o">$</span><span class="n">pers_ssa_death_dt</span><span class="p">)</span>
<span class="n">df</span><span class="o">$</span><span class="n">don_recov_dt</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">d</span><span class="o">$</span><span class="n">don_recov_dt</span><span class="p">)</span>

<span class="c1"># events</span>
<span class="n">df</span><span class="o">$</span><span class="n">esrd</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ifelse</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">d</span><span class="o">$</span><span class="n">pers_esrd_first_service_dt</span><span class="p">),</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">)</span>
<span class="n">df</span><span class="o">$</span><span class="n">mort</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ifelse</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">d</span><span class="o">$</span><span class="n">pers_ssa_death_dt</span><span class="p">),</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">)</span>
<span class="nf">table</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">esrd</span><span class="p">)</span>
<span class="nf">table</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">mort</span><span class="p">)</span>

<span class="n">df</span><span class="o">$</span><span class="n">esrd_dt</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ifelse</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">pers_esrd_first_service_dt</span><span class="p">),</span><span class="n">df</span><span class="o">$</span><span class="n">censor</span><span class="p">,</span><span class="n">df</span><span class="o">$</span><span class="n">pers_esrd_first_service_dt</span><span class="p">)</span>
<span class="n">df</span><span class="o">$</span><span class="n">mort_dt</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ifelse</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">pers_ssa_death_dt</span><span class="p">),</span><span class="n">df</span><span class="o">$</span><span class="n">censor</span><span class="p">,</span><span class="n">df</span><span class="o">$</span><span class="n">pers_ssa_death_dt</span><span class="p">)</span>

<span class="c1"># times</span>
<span class="n">df</span><span class="o">$</span><span class="n">fup_esrd</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">esrd_dt</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">df</span><span class="o">$</span><span class="n">don_recov_dt</span><span class="p">)</span><span class="o">/</span><span class="m">365.25</span>
<span class="n">df</span><span class="o">$</span><span class="n">fup_mort</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">mort_dt</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">df</span><span class="o">$</span><span class="n">don_recov_dt</span><span class="p">)</span><span class="o">/</span><span class="m">365.25</span>

<span class="c1"># implausible</span>
<span class="c1"># highly influential</span>
<span class="c1"># no ostriches welcome!</span>
<span class="nf">set.seed</span><span class="p">(</span><span class="m">053021</span><span class="p">)</span>
<span class="nf">sum</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">fup_esrd</span><span class="o">&lt;=</span><span class="m">0</span><span class="p">))</span>

<span class="c1"># adjust p to assess sensitivity</span>
<span class="n">df</span><span class="o">$</span><span class="n">esrd</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ifelse</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">fup_esrd</span><span class="o">&lt;=</span><span class="m">0</span><span class="p">,</span><span class="n">df</span><span class="o">$</span><span class="n">esrd</span><span class="o">*</span><span class="nf">rbinom</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="n">.</span><span class="m">9</span><span class="p">),</span><span class="n">df</span><span class="o">$</span><span class="n">esrd</span><span class="p">)</span><span class="w"> </span>
<span class="n">df</span><span class="o">$</span><span class="n">mort</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ifelse</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">fup_mort</span><span class="o">&lt;=</span><span class="m">0</span><span class="p">,</span><span class="n">df</span><span class="o">$</span><span class="n">mort</span><span class="o">*</span><span class="nf">rbinom</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="n">.</span><span class="m">9</span><span class="p">),</span><span class="n">df</span><span class="o">$</span><span class="n">mort</span><span class="p">)</span>
<span class="nf">table</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">esrd</span><span class="p">)</span>
<span class="nf">table</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">mort</span><span class="p">)</span>

<span class="n">df</span><span class="o">$</span><span class="n">fup_esrd</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ifelse</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">fup_esrd</span><span class="o">&lt;=</span><span class="m">0</span><span class="p">,</span><span class="nf">sample</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">fup_esrd</span><span class="p">,</span><span class="m">1</span><span class="p">),</span><span class="n">df</span><span class="o">$</span><span class="n">fup_esrd</span><span class="p">)</span>
<span class="n">df</span><span class="o">$</span><span class="n">fup_mort</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ifelse</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">fup_mort</span><span class="o">&lt;=</span><span class="m">0</span><span class="p">,</span><span class="nf">sample</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">fup_mort</span><span class="p">,</span><span class="m">1</span><span class="p">),</span><span class="n">df</span><span class="o">$</span><span class="n">fup_mort</span><span class="p">)</span>
<span class="n">df</span><span class="o">$</span><span class="n">end_dt</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">esrd_dt</span><span class="p">,</span><span class="n">df</span><span class="o">$</span><span class="n">mort_dt</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id5">
<h2>3.12 kaplan-meier<a class="headerlink" href="#id5" title="Permalink to this heading">#</a></h2>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># white is reference</span>
<span class="n">df</span><span class="o">$</span><span class="n">eth</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">d</span><span class="o">$</span><span class="n">race</span>

<span class="c1"># make unrelated reference</span>
<span class="n">df</span><span class="o">$</span><span class="n">fam</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">relevel</span><span class="p">(</span><span class="n">d</span><span class="o">$</span><span class="n">famRisk</span><span class="p">,</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Unrelated&quot;</span><span class="p">))</span><span class="w"> </span>
<span class="n">km</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">survfit</span><span class="p">(</span><span class="nf">Surv</span><span class="p">(</span><span class="n">fup_esrd</span><span class="p">,</span><span class="n">esrd</span><span class="p">)</span><span class="o">~</span><span class="n">eth</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># black vs. non-black reasonable?</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">km</span><span class="p">,</span><span class="w"> </span><span class="n">conf.int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">fun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;event&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">     </span><span class="n">ylim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="n">.</span><span class="m">02</span><span class="p">),</span>
<span class="w">     </span><span class="n">xlim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">30</span><span class="p">),</span>
<span class="w">     </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Years&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">     </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Incidence&quot;</span><span class="p">,</span>
<span class="w">     </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;green&quot;</span><span class="p">,</span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="s">&quot;violet&quot;</span><span class="p">),</span><span class="w"> </span>
<span class="w">     </span><span class="n">lwd</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">3</span><span class="p">),</span><span class="n">las</span><span class="o">=</span><span class="m">1</span><span class="p">,</span>
<span class="w">     </span><span class="n">lty</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">),</span>
<span class="w">     </span><span class="n">cex.axis</span><span class="o">=</span><span class="m">1.5</span><span class="p">,</span>
<span class="w">     </span><span class="n">cex.lab</span><span class="o">=</span><span class="m">1.5</span><span class="p">)</span>
<span class="nf">legend</span><span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="n">.</span><span class="m">015</span><span class="p">,</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Black&quot;</span><span class="p">,</span>
<span class="w">               </span><span class="s">&quot;White&quot;</span><span class="p">,</span>
<span class="w">               </span><span class="s">&quot;Asian&quot;</span><span class="p">,</span>
<span class="w">               </span><span class="s">&quot;Hispanic&quot;</span><span class="p">),</span>
<span class="w">       </span><span class="n">lty</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">),</span><span class="n">lwd</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">3</span><span class="p">),</span><span class="n">col</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="s">&quot;green&quot;</span><span class="p">,</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="s">&quot;violet&quot;</span><span class="p">),</span><span class="n">cex</span><span class="o">=</span><span class="m">1.5</span><span class="p">,</span><span class="n">bty</span><span class="o">=</span><span class="s">&quot;n&quot;</span><span class="p">)</span>

<span class="c1"># black vs. non-black reasonable?</span>
<span class="n">fit.eth</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">coxph</span><span class="p">(</span><span class="nf">Surv</span><span class="p">(</span><span class="n">fup_esrd</span><span class="p">,</span><span class="n">esrd</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">eth</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span><span class="w"> </span>
<span class="nf">summary</span><span class="p">(</span><span class="n">fit.eth</span><span class="p">)</span><span class="o">$</span><span class="n">coef</span>

<span class="c1"># related vs. unrelated reasonable?</span>
<span class="n">fit.fam</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">coxph</span><span class="p">(</span><span class="nf">Surv</span><span class="p">(</span><span class="n">fup_esrd</span><span class="p">,</span><span class="n">esrd</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">fam</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span><span class="w"> </span>
<span class="nf">summary</span><span class="p">(</span><span class="n">fit.fam</span><span class="p">)</span><span class="o">$</span><span class="n">coef</span>


<span class="c1"># strong a priori reasonable?</span>
<span class="n">fit.full</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">coxph</span><span class="p">(</span><span class="nf">Surv</span><span class="p">(</span><span class="n">fup_esrd</span><span class="p">,</span><span class="n">esrd</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">eth</span><span class="o">*</span><span class="n">fam</span><span class="o">+</span><span class="n">don_age</span><span class="o">+</span><span class="n">don_gender</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span><span class="w"> </span>
<span class="nf">summary</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">$</span><span class="n">coef</span>

<span class="c1"># strong a priori reasonable?</span>
<span class="n">fit.null</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">coxph</span><span class="p">(</span><span class="nf">Surv</span><span class="p">(</span><span class="n">fup_esrd</span><span class="p">,</span><span class="n">esrd</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">eth</span><span class="o">+</span><span class="n">fam</span><span class="o">+</span><span class="n">don_age</span><span class="o">+</span><span class="n">don_gender</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span><span class="w"> </span>
<span class="nf">summary</span><span class="p">(</span><span class="n">fit.null</span><span class="p">)</span><span class="o">$</span><span class="n">coef</span>

<span class="c1"># model with interaction is better fit </span>
<span class="n">lrt</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lmtest</span><span class="o">::</span><span class="nf">lrtest</span><span class="p">(</span><span class="n">fit.full</span><span class="p">,</span><span class="n">fit.null</span><span class="p">);</span><span class="w"> </span><span class="n">lrt</span>
<span class="n">chi</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="nf">as.matrix</span><span class="p">(</span><span class="n">lrt</span><span class="p">)[</span><span class="m">2</span><span class="p">,</span><span class="m">4</span><span class="p">],</span><span class="m">3</span><span class="p">);</span><span class="w"> </span><span class="n">chi</span>
<span class="n">pval</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="nf">as.matrix</span><span class="p">(</span><span class="n">lrt</span><span class="p">)[</span><span class="m">2</span><span class="p">,</span><span class="m">5</span><span class="p">],</span><span class="m">3</span><span class="p">);</span><span class="w"> </span><span class="n">pval</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="id6">
<h2>3.13 cox model<a class="headerlink" href="#id6" title="Permalink to this heading">#</a></h2>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># basic output</span>
<span class="n">beta.fit.full</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">coefficients</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span>
<span class="n">vcov.fit.full</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span>
<span class="nf">write.csv</span><span class="p">(</span><span class="nf">print</span><span class="p">(</span><span class="n">beta.fit.full</span>
<span class="w">                </span><span class="p">),</span><span class="s">&quot;./betafamRisk.csv&quot;</span><span class="p">,</span><span class="n">row.names</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
<span class="nf">write.csv</span><span class="p">(</span><span class="nf">print</span><span class="p">(</span><span class="n">vcov.fit.full</span>
<span class="w">                </span><span class="p">),</span><span class="s">&quot;./vcovfamRisk.csv&quot;</span><span class="p">,</span><span class="n">row.names</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
<span class="n">coef</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">coefficients</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span>
<span class="n">coef</span><span class="p">[</span><span class="nf">is.na</span><span class="p">(</span><span class="n">coef</span><span class="p">)]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0</span><span class="w"> </span>
<span class="c1">## unrelated: white is reference</span>
<span class="c1">## speaks to contextual effects or linkage disequilibrium?</span>
<span class="c1">## b9 and b10 are age and sex terms</span>
<span class="c1"># black: b1</span>
<span class="n">Abu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">24</span><span class="p">))</span>
<span class="n">bu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Abu</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.bu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Abu</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Abu</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">bu</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">bu</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.bu</span><span class="p">)</span>

<span class="c1"># asian: b2</span>
<span class="n">Aau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">23</span><span class="p">))</span>
<span class="n">au</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Aau</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.au</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Aau</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Aau</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">au</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">au</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.au</span><span class="p">)</span>

<span class="c1"># hispanic: b3</span>
<span class="n">Ahu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">22</span><span class="p">))</span>
<span class="n">hu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Ahu</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.hu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Ahu</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Ahu</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">hu</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">hu</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.hu</span><span class="p">)</span>

<span class="c1">## white</span>
<span class="c1"># white twin: b6</span>
<span class="n">Awt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">5</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">19</span><span class="p">))</span>
<span class="n">wt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Awt</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.wt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Awt</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Awt</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">wt</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">wt</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.wt</span><span class="p">)</span>

<span class="c1"># white sibling: b7</span>
<span class="n">Aws</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">6</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">18</span><span class="p">))</span>
<span class="n">ws</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Aws</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.ws</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Aws</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Aws</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">ws</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">ws</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.ws</span><span class="p">)</span>

<span class="c1"># white child: b5</span>
<span class="n">Awc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">4</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">20</span><span class="p">))</span>
<span class="n">wc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Awc</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.wc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Awc</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Awc</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">wc</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">wc</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.wc</span><span class="p">)</span>

<span class="c1"># white parent: b4</span>
<span class="n">Awp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">3</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">21</span><span class="p">))</span>
<span class="n">wp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Awp</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.wp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Awp</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Awp</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">wp</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">wp</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.wp</span><span class="p">)</span>

<span class="c1"># white other: b8</span>
<span class="n">Awo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">7</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">17</span><span class="p">))</span>
<span class="n">wo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Awo</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.wo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Awo</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Awo</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">wo</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">wp</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.wo</span><span class="p">)</span>

<span class="c1">## black</span>
<span class="c1"># black unrelated: b1</span>
<span class="n">Abu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">24</span><span class="p">))</span>
<span class="n">bu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Abu</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.bu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Abu</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Abu</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">bu</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">bu</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.bu</span><span class="p">)</span>

<span class="c1"># black twin: b1 + b6 + b17</span>
<span class="n">Abt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">5</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">10</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">8</span><span class="p">))</span>
<span class="n">bt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Abt</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.bt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Abt</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Abt</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">bt</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">bt</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.bt</span><span class="p">)</span>

<span class="c1"># black sibling: b1 + b7 + b20</span>
<span class="n">Abs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">6</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">12</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">5</span><span class="p">))</span>
<span class="n">bs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Abs</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.bs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Abs</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Abs</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">bs</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">bs</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.bs</span><span class="p">)</span>

<span class="c1"># black child: b1 + b5 + b14</span>
<span class="n">Abc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">4</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">8</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">11</span><span class="p">))</span>
<span class="n">bc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Abc</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.bc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Abc</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Abc</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">bc</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">bc</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.bc</span><span class="p">)</span>

<span class="c1"># black parent: b1 + b4 + b11</span>
<span class="n">Abp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">3</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">6</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">14</span><span class="p">))</span>
<span class="n">bp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Abp</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.bp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Abp</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Abp</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">bp</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">bp</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.bp</span><span class="p">)</span>

<span class="c1"># black other: b1 + b8 + b23</span>
<span class="n">Abo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">7</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">14</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">2</span><span class="p">))</span>
<span class="n">bo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Abo</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.bo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Abo</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Abo</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">bo</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">bo</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.bo</span><span class="p">)</span>

<span class="c1">## hispanic</span>
<span class="c1"># hispanic unrelated: b3</span>
<span class="n">Ahu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">2</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">22</span><span class="p">))</span>
<span class="n">hu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Ahu</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.hu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Ahu</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Ahu</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">hu</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">hu</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.hu</span><span class="p">)</span>

<span class="c1"># hispanic twin: b3 + b6 + b19</span>
<span class="n">Aht</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">5</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">12</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">6</span><span class="p">))</span>
<span class="n">ht</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Aht</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.ht</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Aht</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Aht</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">ht</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">ht</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.ht</span><span class="p">)</span>

<span class="c1"># hispanic sibling: b3 + b7 + b22</span>
<span class="n">Ahs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">6</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">14</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">3</span><span class="p">))</span>
<span class="n">hs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Ahs</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.hs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Ahs</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Ahs</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">hs</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">hs</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.hs</span><span class="p">)</span>

<span class="c1"># hispanic child: b3 + b5 + b16</span>
<span class="n">Ahc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">4</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">10</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">9</span><span class="p">))</span>
<span class="n">hc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Ahc</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.hc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Ahc</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Ahc</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">hc</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">hc</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.hc</span><span class="p">)</span>

<span class="c1"># hispanic parent: b3 + b4 + b13</span>
<span class="n">Ahp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">3</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">8</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">12</span><span class="p">))</span>
<span class="n">hp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Ahp</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.hp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Ahp</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Ahp</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">hp</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">hp</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.hp</span><span class="p">)</span>

<span class="c1"># hispanic other: b3 + b8 + b25</span>
<span class="n">Aho</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">7</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">16</span><span class="p">),</span><span class="m">1</span><span class="p">)</span>
<span class="n">ho</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Aho</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.ho</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Aho</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Aho</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">ho</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">ho</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.ho</span><span class="p">)</span>

<span class="c1">## asian</span>
<span class="c1"># asian unrelated: b2</span>
<span class="n">Aau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">23</span><span class="p">))</span>
<span class="n">au</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Aau</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.au</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Aau</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Aau</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">au</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">au</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.au</span><span class="p">)</span>

<span class="c1"># asian twin: b2 + b6 + b18</span>
<span class="n">Aat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">5</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">11</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">7</span><span class="p">))</span>
<span class="n">at</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Aat</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.at</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Aat</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Aat</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">at</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">at</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.at</span><span class="p">)</span>

<span class="c1"># asian sibling: b2 + b7 + b21</span>
<span class="n">Aas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">6</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">13</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">4</span><span class="p">))</span>
<span class="n">as</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Aas</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.as</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Aas</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Aas</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">as</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">as</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.as</span><span class="p">)</span>

<span class="c1"># asian child: b2 + b5 + b15</span>
<span class="n">Aac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">4</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">9</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">10</span><span class="p">))</span>
<span class="n">ac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Aac</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.ac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Aac</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Aac</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">ac</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">ac</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.ac</span><span class="p">)</span>

<span class="c1"># asian parent: b2 + b4 + b12</span>
<span class="n">Aap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">3</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">7</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">13</span><span class="p">))</span>
<span class="n">ap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Aap</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.ap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Aap</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Aap</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">ap</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">ap</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.ap</span><span class="p">)</span>

<span class="c1"># asian other: b2 + b8 + b24</span>
<span class="n">Aao</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">7</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">15</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="m">0</span><span class="p">)</span>
<span class="n">ao</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Aao</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.ao</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Aao</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Aao</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">ao</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">ao</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.ao</span><span class="p">)</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="id7">
<h2>3.14 fig1<a class="headerlink" href="#id7" title="Permalink to this heading">#</a></h2>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># hr (95% CI)</span>

<span class="n">fig1.df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="m">2</span><span class="o">:</span><span class="m">21</span><span class="p">,</span>
<span class="w">           </span><span class="n">hr</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="nf">exp</span><span class="p">(</span><span class="n">wo</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">wc</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">ws</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">wt</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">bo</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">bp</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">bc</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">bs</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">bt</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">ho</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">hp</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">hc</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">hs</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">ht</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">ao</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">ap</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">ac</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">as</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">at</span><span class="p">)),</span>
<span class="w">           </span><span class="n">lb.hr</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="nf">exp</span><span class="p">(</span><span class="n">wo</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.wo</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">wp</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.wp</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">wc</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.wc</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">ws</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.ws</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">wt</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.wt</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">bo</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.bo</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">bp</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.bp</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">bc</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.bc</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">bs</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.bs</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">bt</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.bt</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">ho</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.ho</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">hp</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.hp</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">hc</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.hc</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">hs</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.hs</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">ht</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.ht</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">ao</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.ao</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">ap</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.ap</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">ac</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.ac</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">as</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.as</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">at</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.at</span><span class="p">)),</span>
<span class="w">           </span><span class="n">ub.hr</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="nf">exp</span><span class="p">(</span><span class="n">wo</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.wo</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">wp</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.wp</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">wc</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.wc</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">ws</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.ws</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">wt</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.wt</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">bo</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.bo</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">bp</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.bp</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">bc</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.bc</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">bs</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.bs</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">bt</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.bt</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">ho</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.ho</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">hp</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.hp</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">hc</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.hc</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">hs</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.hs</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">ht</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.ht</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">ao</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.ao</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">ap</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.ap</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">ac</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.ac</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">as</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.as</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">at</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.at</span><span class="p">))</span>
<span class="w">           </span><span class="p">)</span>

<span class="n">fig1.df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rbind</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="n">fig1.df</span><span class="p">)</span>
<span class="n">fig1.df</span><span class="o">$</span><span class="n">race</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">6</span><span class="p">),</span><span class="nf">rep</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">5</span><span class="p">),</span><span class="nf">rep</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="m">5</span><span class="p">),</span><span class="nf">rep</span><span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="m">5</span><span class="p">))</span>
<span class="n">fig1.df</span><span class="o">$</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ordered</span><span class="p">(</span><span class="n">fig1.df</span><span class="o">$</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">levels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">21</span><span class="p">),</span><span class="w"> </span>
<span class="w">                        </span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Unr&quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Oth&quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Par&quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Off&quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Sib&quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Twi&quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Oth &quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Par &quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Off &quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Sib &quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Twi &quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Oth  &quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Par  &quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Off  &quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Sib  &quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Twi  &quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Oth   &quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Par   &quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Off   &quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Sib   &quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Twi   &quot;</span>
<span class="w">                                 </span><span class="p">)</span>
<span class="w">                     </span><span class="p">)</span>
<span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">fig1.df</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">factor</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">hr</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="nf">as.factor</span><span class="p">(</span><span class="n">race</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme_bw</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_hline</span><span class="p">(</span><span class="n">yintercept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="s">&quot;Hazard Ratios (95% CI)&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">       </span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">scale_color_manual</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Race&quot;</span><span class="p">,</span>
<span class="w">                     </span><span class="n">values</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;2&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;2&quot;</span><span class="o">=</span><span class="s">&quot;3&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;3&quot;</span><span class="o">=</span><span class="s">&quot;4&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;4&quot;</span><span class="o">=</span><span class="s">&quot;5&quot;</span><span class="p">),</span>
<span class="w">                     </span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;White&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Black&quot;</span><span class="p">,</span><span class="s">&quot;Hispanic&quot;</span><span class="p">,</span><span class="s">&quot;Asian&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">geom_errorbar</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="n">.</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">ymin</span><span class="o">=</span><span class="n">lb.hr</span><span class="p">,</span><span class="w"> </span><span class="n">ymax</span><span class="o">=</span><span class="n">ub.hr</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">scale_y_log10</span><span class="p">(</span><span class="n">breaks</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">.</span><span class="m">01</span><span class="p">,</span><span class="n">.</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">10</span><span class="p">,</span><span class="m">100</span><span class="p">,</span><span class="m">1000</span><span class="p">,</span><span class="m">10000</span><span class="p">),</span><span class="n">limits</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">.</span><span class="m">01</span><span class="p">,</span><span class="m">10000</span><span class="p">),</span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;0.01&quot;</span><span class="p">,</span><span class="s">&quot;0.1&quot;</span><span class="p">,</span><span class="s">&quot;1&quot;</span><span class="p">,</span><span class="s">&quot;10&quot;</span><span class="p">,</span><span class="s">&quot;100&quot;</span><span class="p">,</span><span class="s">&quot;1000&quot;</span><span class="p">,</span><span class="s">&quot;10000&quot;</span><span class="p">))</span>

<span class="c1"># using previous paper format graphs, separated by race as well </span>
<span class="nf">ggplot</span><span class="p">(</span><span class="n">fig1.df</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">6</span><span class="p">,],</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">hr</span><span class="p">))</span><span class="o">+</span><span class="nf">geom_errorbar</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">ymin</span><span class="o">=</span><span class="n">lb.hr</span><span class="p">,</span><span class="w"> </span><span class="n">ymax</span><span class="o">=</span><span class="n">ub.hr</span><span class="p">),</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="o">=</span><span class="m">0.3</span><span class="p">)</span><span class="o">+</span><span class="nf">geom_point</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">)</span><span class="o">+</span><span class="nf">scale_y_log10</span><span class="p">(</span><span class="n">breaks</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">.</span><span class="m">01</span><span class="p">,</span><span class="n">.</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">10</span><span class="p">,</span><span class="m">100</span><span class="p">,</span><span class="m">1000</span><span class="p">),</span><span class="n">limits</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">.</span><span class="m">01</span><span class="p">,</span><span class="m">1000</span><span class="p">),</span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;0.01&quot;</span><span class="p">,</span><span class="s">&quot;0.1&quot;</span><span class="p">,</span><span class="s">&quot;1&quot;</span><span class="p">,</span><span class="s">&quot;10&quot;</span><span class="p">,</span><span class="s">&quot;100&quot;</span><span class="p">,</span><span class="s">&quot;1000&quot;</span><span class="p">))</span><span class="o">+</span><span class="nf">theme_classic</span><span class="p">()</span><span class="o">+</span><span class="nf">theme</span><span class="p">(</span><span class="n">panel.border</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_rect</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;black&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="kc">NA</span><span class="p">),</span><span class="n">strip.background</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_rect</span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">))</span><span class="o">+</span><span class="nf">geom_hline</span><span class="p">(</span><span class="n">yintercept</span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">linetype</span><span class="o">=</span><span class="s">&quot;dashed&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;darkgreen&quot;</span><span class="p">)</span><span class="o">+</span><span class="nf">labs</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Adjusted 30-Year Risk of ESKD (95% CI)&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Donor-Recipient Relationship&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">title</span><span class="o">=</span><span class="s">&quot;White Donors&quot;</span><span class="p">)</span>

<span class="n">tmp1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rbind</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">),</span><span class="n">fig1.df</span><span class="p">[</span><span class="m">7</span><span class="o">:</span><span class="m">11</span><span class="p">,])</span>
<span class="n">tmp1</span><span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&quot;Unr&quot;</span>

<span class="nf">ggplot</span><span class="p">(</span><span class="n">tmp1</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">hr</span><span class="p">))</span><span class="o">+</span><span class="nf">geom_errorbar</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">ymin</span><span class="o">=</span><span class="n">lb.hr</span><span class="p">,</span><span class="w"> </span><span class="n">ymax</span><span class="o">=</span><span class="n">ub.hr</span><span class="p">),</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="o">=</span><span class="m">0.3</span><span class="p">)</span><span class="o">+</span><span class="nf">geom_point</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">)</span><span class="o">+</span><span class="nf">scale_y_log10</span><span class="p">(</span><span class="n">breaks</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">.</span><span class="m">01</span><span class="p">,</span><span class="n">.</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">10</span><span class="p">,</span><span class="m">100</span><span class="p">,</span><span class="m">1000</span><span class="p">),</span><span class="n">limits</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">.</span><span class="m">01</span><span class="p">,</span><span class="m">1000</span><span class="p">),</span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;0.01&quot;</span><span class="p">,</span><span class="s">&quot;0.1&quot;</span><span class="p">,</span><span class="s">&quot;1&quot;</span><span class="p">,</span><span class="s">&quot;10&quot;</span><span class="p">,</span><span class="s">&quot;100&quot;</span><span class="p">,</span><span class="s">&quot;1000&quot;</span><span class="p">))</span><span class="o">+</span><span class="nf">theme_classic</span><span class="p">()</span><span class="o">+</span><span class="nf">theme</span><span class="p">(</span><span class="n">panel.border</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_rect</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;black&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="kc">NA</span><span class="p">),</span><span class="n">strip.background</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_rect</span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">))</span><span class="o">+</span><span class="nf">geom_hline</span><span class="p">(</span><span class="n">yintercept</span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">linetype</span><span class="o">=</span><span class="s">&quot;dashed&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;darkgreen&quot;</span><span class="p">)</span><span class="o">+</span><span class="nf">labs</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Adjusted 30-Year Risk of ESKD (95% CI)&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Donor-Recipient Relationship&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">title</span><span class="o">=</span><span class="s">&quot;Black Donors&quot;</span><span class="p">)</span>

<span class="n">tmp2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rbind</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">3</span><span class="p">),</span><span class="n">fig1.df</span><span class="p">[</span><span class="m">12</span><span class="o">:</span><span class="m">16</span><span class="p">,])</span>
<span class="n">tmp2</span><span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&quot;Unr&quot;</span>
<span class="nf">ggplot</span><span class="p">(</span><span class="n">tmp2</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">hr</span><span class="p">))</span><span class="o">+</span><span class="nf">geom_errorbar</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">ymin</span><span class="o">=</span><span class="n">lb.hr</span><span class="p">,</span><span class="w"> </span><span class="n">ymax</span><span class="o">=</span><span class="n">ub.hr</span><span class="p">),</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="o">=</span><span class="m">0.3</span><span class="p">)</span><span class="o">+</span><span class="nf">geom_point</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">)</span><span class="o">+</span><span class="nf">scale_y_log10</span><span class="p">(</span><span class="n">breaks</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">.</span><span class="m">01</span><span class="p">,</span><span class="n">.</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">10</span><span class="p">,</span><span class="m">100</span><span class="p">,</span><span class="m">1000</span><span class="p">),</span><span class="n">limits</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">.</span><span class="m">01</span><span class="p">,</span><span class="m">1000</span><span class="p">),</span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;0.01&quot;</span><span class="p">,</span><span class="s">&quot;0.1&quot;</span><span class="p">,</span><span class="s">&quot;1&quot;</span><span class="p">,</span><span class="s">&quot;10&quot;</span><span class="p">,</span><span class="s">&quot;100&quot;</span><span class="p">,</span><span class="s">&quot;1000&quot;</span><span class="p">))</span><span class="o">+</span><span class="nf">theme_classic</span><span class="p">()</span><span class="o">+</span><span class="nf">theme</span><span class="p">(</span><span class="n">panel.border</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_rect</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;black&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="kc">NA</span><span class="p">),</span><span class="n">strip.background</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_rect</span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">))</span><span class="o">+</span><span class="nf">geom_hline</span><span class="p">(</span><span class="n">yintercept</span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">linetype</span><span class="o">=</span><span class="s">&quot;dashed&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;darkgreen&quot;</span><span class="p">)</span><span class="o">+</span><span class="nf">labs</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Adjusted 30-Year Risk of ESKD (95% CI)&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Donor-Recipient Relationship&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">title</span><span class="o">=</span><span class="s">&quot;Hispanic Donors&quot;</span><span class="p">)</span>

<span class="n">tmp3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rbind</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">4</span><span class="p">),</span><span class="n">fig1.df</span><span class="p">[</span><span class="m">17</span><span class="o">:</span><span class="m">21</span><span class="p">,])</span>
<span class="n">tmp3</span><span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&quot;Unr&quot;</span>
<span class="nf">ggplot</span><span class="p">(</span><span class="n">tmp3</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">hr</span><span class="p">))</span><span class="o">+</span><span class="nf">geom_errorbar</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">ymin</span><span class="o">=</span><span class="n">lb.hr</span><span class="p">,</span><span class="w"> </span><span class="n">ymax</span><span class="o">=</span><span class="n">ub.hr</span><span class="p">),</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="o">=</span><span class="m">0.3</span><span class="p">)</span><span class="o">+</span><span class="nf">geom_point</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">)</span><span class="o">+</span><span class="nf">scale_y_log10</span><span class="p">(</span><span class="n">breaks</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">.</span><span class="m">01</span><span class="p">,</span><span class="n">.</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">10</span><span class="p">,</span><span class="m">100</span><span class="p">,</span><span class="m">1000</span><span class="p">),</span><span class="n">limits</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">.</span><span class="m">01</span><span class="p">,</span><span class="m">1000</span><span class="p">),</span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;0.01&quot;</span><span class="p">,</span><span class="s">&quot;0.1&quot;</span><span class="p">,</span><span class="s">&quot;1&quot;</span><span class="p">,</span><span class="s">&quot;10&quot;</span><span class="p">,</span><span class="s">&quot;100&quot;</span><span class="p">,</span><span class="s">&quot;1000&quot;</span><span class="p">))</span><span class="o">+</span><span class="nf">theme_classic</span><span class="p">()</span><span class="o">+</span><span class="nf">theme</span><span class="p">(</span><span class="n">panel.border</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_rect</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;black&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="kc">NA</span><span class="p">),</span><span class="n">strip.background</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_rect</span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">))</span><span class="o">+</span><span class="nf">geom_hline</span><span class="p">(</span><span class="n">yintercept</span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">linetype</span><span class="o">=</span><span class="s">&quot;dashed&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;darkgreen&quot;</span><span class="p">)</span><span class="o">+</span><span class="nf">labs</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Adjusted 30-Year Risk of ESKD (95% CI)&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Donor-Recipient Relationship&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">title</span><span class="o">=</span><span class="s">&quot;Asian Donors&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="fig3">
<h2>3.15 fig3<a class="headerlink" href="#fig3" title="Permalink to this heading">#</a></h2>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">km</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">survfit</span><span class="p">(</span><span class="nf">Surv</span><span class="p">(</span><span class="n">fup_esrd</span><span class="p">,</span><span class="n">esrd</span><span class="p">)</span><span class="o">~</span><span class="n">race</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="nf">ggsurvplot</span><span class="p">(</span>
<span class="w">  </span><span class="n">km</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="n">fun</span><span class="o">=</span><span class="s">&quot;event&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="n">risk.table</span><span class="o">=</span><span class="bp">T</span><span class="p">,</span>
<span class="w">  </span><span class="n">test.for.trend</span><span class="o">=</span><span class="bp">T</span><span class="p">,</span>
<span class="w">  </span><span class="n">conf.int</span><span class="o">=</span><span class="bp">F</span><span class="p">,</span>
<span class="w">  </span><span class="n">xlim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">30</span><span class="p">),</span>
<span class="w">  </span><span class="n">ylim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="n">.</span><span class="m">02</span><span class="p">),</span>
<span class="w">  </span><span class="n">linetype</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">4</span><span class="p">),</span>
<span class="w">  </span><span class="n">break.time.by</span><span class="o">=</span><span class="m">5</span><span class="p">,</span>
<span class="w">  </span><span class="n">ggtheme</span><span class="o">=</span><span class="nf">theme_minimal</span><span class="p">(),</span>
<span class="w">  </span><span class="n">lty</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">),</span>
<span class="w">  </span><span class="n">lwd</span><span class="o">=</span><span class="m">3</span><span class="p">,</span>
<span class="w">  </span><span class="n">risk.table.y.text.col</span><span class="o">=</span><span class="bp">T</span><span class="p">,</span>
<span class="w">  </span><span class="n">risk.table.y.text</span><span class="o">=</span><span class="bp">F</span><span class="p">,</span>
<span class="w">  </span><span class="n">surv.plot.height</span><span class="o">=</span><span class="n">.</span><span class="m">9</span><span class="p">,</span>
<span class="w">  </span><span class="n">risk.table.height</span><span class="o">=</span><span class="n">.</span><span class="m">3</span><span class="p">,</span>
<span class="w">  </span><span class="n">censor</span><span class="o">=</span><span class="bp">F</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="fig4">
<h2>3.16 fig4<a class="headerlink" href="#fig4" title="Permalink to this heading">#</a></h2>
<p>Older Donors</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># dates</span>
<span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">copy</span><span class="p">[</span><span class="n">copy</span><span class="o">$</span><span class="n">don_age</span><span class="o">&gt;=</span><span class="m">50</span><span class="p">,]</span>
<span class="n">d</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">copy1</span><span class="p">[</span><span class="n">copy1</span><span class="o">$</span><span class="n">don_age</span><span class="o">&gt;=</span><span class="m">50</span><span class="p">,]</span>
<span class="n">df</span><span class="o">$</span><span class="n">censor</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">as.Date</span><span class="p">(</span><span class="s">&quot;12/31/20&quot;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s">&quot;%m/%d/%y&quot;</span><span class="p">))</span>
<span class="n">df</span><span class="o">$</span><span class="n">pers_esrd_first_service_dt</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">d</span><span class="o">$</span><span class="n">pers_esrd_first_service_dt</span><span class="p">)</span>
<span class="n">df</span><span class="o">$</span><span class="n">pers_ssa_death_dt</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">d</span><span class="o">$</span><span class="n">pers_ssa_death_dt</span><span class="p">)</span>
<span class="n">df</span><span class="o">$</span><span class="n">don_recov_dt</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">d</span><span class="o">$</span><span class="n">don_recov_dt</span><span class="p">)</span>

<span class="c1"># events</span>
<span class="n">df</span><span class="o">$</span><span class="n">esrd</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ifelse</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">d</span><span class="o">$</span><span class="n">pers_esrd_first_service_dt</span><span class="p">),</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">)</span>
<span class="n">df</span><span class="o">$</span><span class="n">mort</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ifelse</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">d</span><span class="o">$</span><span class="n">pers_ssa_death_dt</span><span class="p">),</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">)</span>
<span class="nf">table</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">esrd</span><span class="p">)</span>
<span class="nf">table</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">mort</span><span class="p">)</span>

<span class="n">df</span><span class="o">$</span><span class="n">esrd_dt</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ifelse</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">pers_esrd_first_service_dt</span><span class="p">),</span><span class="n">df</span><span class="o">$</span><span class="n">censor</span><span class="p">,</span><span class="n">df</span><span class="o">$</span><span class="n">pers_esrd_first_service_dt</span><span class="p">)</span>
<span class="n">df</span><span class="o">$</span><span class="n">mort_dt</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ifelse</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">pers_ssa_death_dt</span><span class="p">),</span><span class="n">df</span><span class="o">$</span><span class="n">censor</span><span class="p">,</span><span class="n">df</span><span class="o">$</span><span class="n">pers_ssa_death_dt</span><span class="p">)</span>

<span class="c1"># times</span>
<span class="n">df</span><span class="o">$</span><span class="n">fup_esrd</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">esrd_dt</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">df</span><span class="o">$</span><span class="n">don_recov_dt</span><span class="p">)</span><span class="o">/</span><span class="m">365.25</span>
<span class="n">df</span><span class="o">$</span><span class="n">fup_mort</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">mort_dt</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">df</span><span class="o">$</span><span class="n">don_recov_dt</span><span class="p">)</span><span class="o">/</span><span class="m">365.25</span>

<span class="c1"># implausible</span>
<span class="c1"># highly influential</span>
<span class="c1"># no ostriches welcome!</span>
<span class="nf">set.seed</span><span class="p">(</span><span class="m">053021</span><span class="p">)</span>
<span class="nf">sum</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">fup_esrd</span><span class="o">&lt;=</span><span class="m">0</span><span class="p">))</span>

<span class="c1"># adjust p to assess sensitivity</span>
<span class="n">df</span><span class="o">$</span><span class="n">esrd</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ifelse</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">fup_esrd</span><span class="o">&lt;=</span><span class="m">0</span><span class="p">,</span><span class="n">df</span><span class="o">$</span><span class="n">esrd</span><span class="o">*</span><span class="nf">rbinom</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="n">.</span><span class="m">9</span><span class="p">),</span><span class="n">df</span><span class="o">$</span><span class="n">esrd</span><span class="p">)</span><span class="w"> </span>
<span class="n">df</span><span class="o">$</span><span class="n">mort</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ifelse</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">fup_mort</span><span class="o">&lt;=</span><span class="m">0</span><span class="p">,</span><span class="n">df</span><span class="o">$</span><span class="n">mort</span><span class="o">*</span><span class="nf">rbinom</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="n">.</span><span class="m">9</span><span class="p">),</span><span class="n">df</span><span class="o">$</span><span class="n">mort</span><span class="p">)</span>
<span class="nf">table</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">esrd</span><span class="p">)</span>
<span class="nf">table</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">mort</span><span class="p">)</span>

<span class="n">df</span><span class="o">$</span><span class="n">fup_esrd</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ifelse</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">fup_esrd</span><span class="o">&lt;=</span><span class="m">0</span><span class="p">,</span><span class="nf">sample</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">fup_esrd</span><span class="p">,</span><span class="m">1</span><span class="p">),</span><span class="n">df</span><span class="o">$</span><span class="n">fup_esrd</span><span class="p">)</span>
<span class="n">df</span><span class="o">$</span><span class="n">fup_mort</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ifelse</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">fup_mort</span><span class="o">&lt;=</span><span class="m">0</span><span class="p">,</span><span class="nf">sample</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">fup_mort</span><span class="p">,</span><span class="m">1</span><span class="p">),</span><span class="n">df</span><span class="o">$</span><span class="n">fup_mort</span><span class="p">)</span>
<span class="n">df</span><span class="o">$</span><span class="n">end_dt</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">esrd_dt</span><span class="p">,</span><span class="n">df</span><span class="o">$</span><span class="n">mort_dt</span><span class="p">)</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="fig4-kaplan-meier">
<h2>3.17 fig4 kaplan-meier<a class="headerlink" href="#fig4-kaplan-meier" title="Permalink to this heading">#</a></h2>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># white is reference</span>
<span class="n">df</span><span class="o">$</span><span class="n">eth</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">d</span><span class="o">$</span><span class="n">race</span>

<span class="c1"># make unrelated reference</span>
<span class="n">df</span><span class="o">$</span><span class="n">fam</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">relevel</span><span class="p">(</span><span class="n">d</span><span class="o">$</span><span class="n">famRisk</span><span class="p">,</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Unrelated&quot;</span><span class="p">))</span><span class="w"> </span>
<span class="n">km</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">survfit</span><span class="p">(</span><span class="nf">Surv</span><span class="p">(</span><span class="n">fup_esrd</span><span class="p">,</span><span class="n">esrd</span><span class="p">)</span><span class="o">~</span><span class="n">eth</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># black vs. non-black reasonable?</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">km</span><span class="p">,</span><span class="w"> </span><span class="n">conf.int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">fun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;event&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">     </span><span class="n">ylim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="n">.</span><span class="m">02</span><span class="p">),</span>
<span class="w">     </span><span class="n">xlim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">30</span><span class="p">),</span>
<span class="w">     </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Years&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">     </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Incidence&quot;</span><span class="p">,</span>
<span class="w">     </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;green&quot;</span><span class="p">,</span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="s">&quot;violet&quot;</span><span class="p">),</span><span class="w"> </span>
<span class="w">     </span><span class="n">lwd</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">3</span><span class="p">),</span><span class="n">las</span><span class="o">=</span><span class="m">1</span><span class="p">,</span>
<span class="w">     </span><span class="n">lty</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">),</span>
<span class="w">     </span><span class="n">cex.axis</span><span class="o">=</span><span class="m">1.5</span><span class="p">,</span>
<span class="w">     </span><span class="n">cex.lab</span><span class="o">=</span><span class="m">1.5</span><span class="p">)</span>
<span class="nf">legend</span><span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="n">.</span><span class="m">015</span><span class="p">,</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Black&quot;</span><span class="p">,</span>
<span class="w">               </span><span class="s">&quot;White&quot;</span><span class="p">,</span>
<span class="w">               </span><span class="s">&quot;Asian&quot;</span><span class="p">,</span>
<span class="w">               </span><span class="s">&quot;Hispanic&quot;</span><span class="p">),</span>
<span class="w">       </span><span class="n">lty</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">),</span><span class="n">lwd</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">3</span><span class="p">),</span><span class="n">col</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="s">&quot;green&quot;</span><span class="p">,</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="s">&quot;violet&quot;</span><span class="p">),</span><span class="n">cex</span><span class="o">=</span><span class="m">1.5</span><span class="p">,</span><span class="n">bty</span><span class="o">=</span><span class="s">&quot;n&quot;</span><span class="p">)</span>

<span class="c1"># black vs. non-black reasonable?</span>
<span class="n">fit.eth</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">coxph</span><span class="p">(</span><span class="nf">Surv</span><span class="p">(</span><span class="n">fup_esrd</span><span class="p">,</span><span class="n">esrd</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">eth</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span><span class="w"> </span>
<span class="nf">summary</span><span class="p">(</span><span class="n">fit.eth</span><span class="p">)</span><span class="o">$</span><span class="n">coef</span>

<span class="c1"># related vs. unrelated reasonable?</span>
<span class="n">fit.fam</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">coxph</span><span class="p">(</span><span class="nf">Surv</span><span class="p">(</span><span class="n">fup_esrd</span><span class="p">,</span><span class="n">esrd</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">fam</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span><span class="w"> </span>
<span class="nf">summary</span><span class="p">(</span><span class="n">fit.fam</span><span class="p">)</span><span class="o">$</span><span class="n">coef</span>

<span class="c1"># over versus under 50 reasonable?</span>
<span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">mutate</span><span class="p">(</span><span class="n">age50</span><span class="o">=</span><span class="p">(</span><span class="n">don_age</span><span class="o">&gt;=</span><span class="m">50</span><span class="p">))</span>
<span class="n">fit.age</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">coxph</span><span class="p">(</span><span class="nf">Surv</span><span class="p">(</span><span class="n">fup_esrd</span><span class="p">,</span><span class="w"> </span><span class="n">esrd</span><span class="p">)</span><span class="o">~</span><span class="n">age50</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">fit.age</span><span class="p">)</span><span class="o">$</span><span class="n">coef</span>

<span class="c1"># strong a priori reasonable?</span>
<span class="n">fit.full</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">coxph</span><span class="p">(</span><span class="nf">Surv</span><span class="p">(</span><span class="n">fup_esrd</span><span class="p">,</span><span class="n">esrd</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">eth</span><span class="o">*</span><span class="n">fam</span><span class="o">+</span><span class="n">don_age</span><span class="o">+</span><span class="n">don_gender</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span><span class="w"> </span>
<span class="nf">summary</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">$</span><span class="n">coef</span>

<span class="c1"># strong a priori reasonable?</span>
<span class="n">fit.null</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">coxph</span><span class="p">(</span><span class="nf">Surv</span><span class="p">(</span><span class="n">fup_esrd</span><span class="p">,</span><span class="n">esrd</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">eth</span><span class="o">+</span><span class="n">fam</span><span class="o">+</span><span class="n">don_age</span><span class="o">+</span><span class="n">don_gender</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span><span class="w"> </span>
<span class="nf">summary</span><span class="p">(</span><span class="n">fit.null</span><span class="p">)</span><span class="o">$</span><span class="n">coef</span>

<span class="c1"># model with interaction is better fit </span>
<span class="n">lrt</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lmtest</span><span class="o">::</span><span class="nf">lrtest</span><span class="p">(</span><span class="n">fit.full</span><span class="p">,</span><span class="n">fit.null</span><span class="p">);</span><span class="w"> </span><span class="n">lrt</span>
<span class="n">chi</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="nf">as.matrix</span><span class="p">(</span><span class="n">lrt</span><span class="p">)[</span><span class="m">2</span><span class="p">,</span><span class="m">4</span><span class="p">],</span><span class="m">3</span><span class="p">);</span><span class="w"> </span><span class="n">chi</span>
<span class="n">pval</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="nf">as.matrix</span><span class="p">(</span><span class="n">lrt</span><span class="p">)[</span><span class="m">2</span><span class="p">,</span><span class="m">5</span><span class="p">],</span><span class="m">3</span><span class="p">);</span><span class="w"> </span><span class="n">pval</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="lincom">
<h2>3.18 lincom<a class="headerlink" href="#lincom" title="Permalink to this heading">#</a></h2>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># basic output</span>
<span class="n">beta.fit.full</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">coefficients</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span>
<span class="n">vcov.fit.full</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span>
<span class="nf">write.csv</span><span class="p">(</span><span class="nf">print</span><span class="p">(</span><span class="n">beta.fit.full</span>
<span class="w">                </span><span class="p">),</span><span class="s">&quot;./betafamRisk.csv&quot;</span><span class="p">,</span><span class="n">row.names</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
<span class="nf">write.csv</span><span class="p">(</span><span class="nf">print</span><span class="p">(</span><span class="n">vcov.fit.full</span>
<span class="w">                </span><span class="p">),</span><span class="s">&quot;./vcovfamRisk.csv&quot;</span><span class="p">,</span><span class="n">row.names</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
<span class="n">coef</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">coefficients</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span>
<span class="n">coef</span><span class="p">[</span><span class="nf">is.na</span><span class="p">(</span><span class="n">coef</span><span class="p">)]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0</span><span class="w"> </span>
<span class="c1">## unrelated: white is reference</span>
<span class="c1">## speaks to contextual effects or linkage disequilibrium?</span>
<span class="c1">## b9 and b10 are age and sex terms</span>
<span class="c1"># black: b1</span>
<span class="n">Abu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">24</span><span class="p">))</span>
<span class="n">bu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Abu</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.bu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Abu</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Abu</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">bu</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">bu</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.bu</span><span class="p">)</span>

<span class="c1"># asian: b2</span>
<span class="n">Aau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">23</span><span class="p">))</span>
<span class="n">au</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Aau</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.au</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Aau</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Aau</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">au</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">au</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.au</span><span class="p">)</span>

<span class="c1"># hispanic: b3</span>
<span class="n">Ahu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">22</span><span class="p">))</span>
<span class="n">hu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Ahu</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.hu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Ahu</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Ahu</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">hu</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">hu</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.hu</span><span class="p">)</span>

<span class="c1">## white</span>
<span class="c1"># white twin: b6</span>
<span class="n">Awt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">5</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">19</span><span class="p">))</span>
<span class="n">wt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Awt</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.wt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Awt</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Awt</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">wt</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">wt</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.wt</span><span class="p">)</span>

<span class="c1"># white sibling: b7</span>
<span class="n">Aws</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">6</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">18</span><span class="p">))</span>
<span class="n">ws</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Aws</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.ws</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Aws</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Aws</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">ws</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">ws</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.ws</span><span class="p">)</span>

<span class="c1"># white child: b5</span>
<span class="n">Awc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">4</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">20</span><span class="p">))</span>
<span class="n">wc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Awc</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.wc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Awc</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Awc</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">wc</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">wc</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.wc</span><span class="p">)</span>

<span class="c1"># white parent: b4</span>
<span class="n">Awp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">3</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">21</span><span class="p">))</span>
<span class="n">wp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Awp</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.wp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Awp</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Awp</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">wp</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">wp</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.wp</span><span class="p">)</span>

<span class="c1"># white other: b8</span>
<span class="n">Awo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">7</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">17</span><span class="p">))</span>
<span class="n">wo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Awo</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.wo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Awo</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Awo</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">wo</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">wp</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.wo</span><span class="p">)</span>

<span class="c1">## black</span>
<span class="c1"># black unrelated: b1</span>
<span class="n">Abu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">24</span><span class="p">))</span>
<span class="n">bu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Abu</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.bu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Abu</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Abu</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">bu</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">bu</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.bu</span><span class="p">)</span>

<span class="c1"># black twin: b1 + b6 + b17</span>
<span class="n">Abt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">5</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">10</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">8</span><span class="p">))</span>
<span class="n">bt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Abt</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.bt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Abt</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Abt</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">bt</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">bt</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.bt</span><span class="p">)</span>

<span class="c1"># black sibling: b1 + b7 + b20</span>
<span class="n">Abs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">6</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">12</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">5</span><span class="p">))</span>
<span class="n">bs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Abs</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.bs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Abs</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Abs</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">bs</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">bs</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.bs</span><span class="p">)</span>

<span class="c1"># black child: b1 + b5 + b14</span>
<span class="n">Abc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">4</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">8</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">11</span><span class="p">))</span>
<span class="n">bc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Abc</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.bc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Abc</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Abc</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">bc</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">bc</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.bc</span><span class="p">)</span>

<span class="c1"># black parent: b1 + b4 + b11</span>
<span class="n">Abp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">3</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">6</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">14</span><span class="p">))</span>
<span class="n">bp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Abp</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.bp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Abp</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Abp</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">bp</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">bp</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.bp</span><span class="p">)</span>

<span class="c1"># black other: b1 + b8 + b23</span>
<span class="n">Abo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">7</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">14</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">2</span><span class="p">))</span>
<span class="n">bo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Abo</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.bo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Abo</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Abo</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">bo</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">bo</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.bo</span><span class="p">)</span>

<span class="c1">## hispanic</span>
<span class="c1"># hispanic unrelated: b3</span>
<span class="n">Ahu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">2</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">22</span><span class="p">))</span>
<span class="n">hu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Ahu</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.hu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Ahu</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Ahu</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">hu</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">hu</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.hu</span><span class="p">)</span>

<span class="c1"># hispanic twin: b3 + b6 + b19</span>
<span class="n">Aht</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">5</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">12</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">6</span><span class="p">))</span>
<span class="n">ht</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Aht</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.ht</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Aht</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Aht</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">ht</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">ht</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.ht</span><span class="p">)</span>

<span class="c1"># hispanic sibling: b3 + b7 + b22</span>
<span class="n">Ahs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">6</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">14</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">3</span><span class="p">))</span>
<span class="n">hs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Ahs</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.hs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Ahs</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Ahs</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">hs</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">hs</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.hs</span><span class="p">)</span>

<span class="c1"># hispanic child: b3 + b5 + b16</span>
<span class="n">Ahc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">4</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">10</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">9</span><span class="p">))</span>
<span class="n">hc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Ahc</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.hc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Ahc</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Ahc</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">hc</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">hc</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.hc</span><span class="p">)</span>

<span class="c1"># hispanic parent: b3 + b4 + b13</span>
<span class="n">Ahp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">3</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">8</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">12</span><span class="p">))</span>
<span class="n">hp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Ahp</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.hp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Ahp</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Ahp</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">hp</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">hp</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.hp</span><span class="p">)</span>

<span class="c1"># hispanic other: b3 + b8 + b25</span>
<span class="n">Aho</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">7</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">16</span><span class="p">),</span><span class="m">1</span><span class="p">)</span>
<span class="n">ho</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Aho</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.ho</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Aho</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Aho</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">ho</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">ho</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.ho</span><span class="p">)</span>

<span class="c1">## asian</span>
<span class="c1"># asian unrelated: b2</span>
<span class="n">Aau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">23</span><span class="p">))</span>
<span class="n">au</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Aau</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.au</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Aau</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Aau</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">au</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">au</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.au</span><span class="p">)</span>

<span class="c1"># asian twin: b2 + b6 + b18</span>
<span class="n">Aat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">5</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">11</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">7</span><span class="p">))</span>
<span class="n">at</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Aat</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.at</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Aat</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Aat</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">at</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">at</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.at</span><span class="p">)</span>

<span class="c1"># asian sibling: b2 + b7 + b21</span>
<span class="n">Aas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">6</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">13</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">4</span><span class="p">))</span>
<span class="n">as</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Aas</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.as</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Aas</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Aas</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">as</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">as</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.as</span><span class="p">)</span>

<span class="c1"># asian child: b2 + b5 + b15</span>
<span class="n">Aac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">4</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">9</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">10</span><span class="p">))</span>
<span class="n">ac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Aac</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.ac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Aac</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Aac</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">ac</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">ac</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.ac</span><span class="p">)</span>

<span class="c1"># asian parent: b2 + b4 + b12</span>
<span class="n">Aap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">3</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">7</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">13</span><span class="p">))</span>
<span class="n">ap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Aap</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.ap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Aap</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Aap</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">ap</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">ap</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.ap</span><span class="p">)</span>

<span class="c1"># asian other: b2 + b8 + b24</span>
<span class="n">Aao</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">7</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">15</span><span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="m">0</span><span class="p">)</span>
<span class="n">ao</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">Aao</span><span class="p">)</span><span class="o">%*%</span><span class="n">coef</span><span class="p">)</span>
<span class="n">se.ao</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">Aao</span><span class="p">)</span><span class="o">%*%</span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit.full</span><span class="p">)</span><span class="o">%*%</span><span class="n">Aao</span><span class="p">)</span>
<span class="nf">exp</span><span class="p">(</span><span class="n">ao</span><span class="p">);</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">ao</span><span class="o">+</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">1.96</span><span class="o">*</span><span class="n">se.ao</span><span class="p">)</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="hr-95-ci">
<h2>3.19 hr, 95%ci<a class="headerlink" href="#hr-95-ci" title="Permalink to this heading">#</a></h2>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">fig1.df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="m">2</span><span class="o">:</span><span class="m">21</span><span class="p">,</span>
<span class="w">           </span><span class="n">hr</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="nf">exp</span><span class="p">(</span><span class="n">wo</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">wc</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">ws</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">wt</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">bo</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">bp</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">bc</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">bs</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">bt</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">ho</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">hp</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">hc</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">hs</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">ht</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">ao</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">ap</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">ac</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">as</span><span class="p">),</span>
<span class="w">                </span><span class="nf">exp</span><span class="p">(</span><span class="n">at</span><span class="p">)),</span>
<span class="w">           </span><span class="n">lb.hr</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="nf">exp</span><span class="p">(</span><span class="n">wo</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.wo</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">wp</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.wp</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">wc</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.wc</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">ws</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.ws</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">wt</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.wt</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">bo</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.bo</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">bp</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.bp</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">bc</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.bc</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">bs</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.bs</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">bt</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.bt</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">ho</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.ho</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">hp</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.hp</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">hc</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.hc</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">hs</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.hs</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">ht</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.ht</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">ao</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.ao</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">ap</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.ap</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">ac</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.ac</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">as</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.as</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">at</span><span class="m">-1.96</span><span class="o">*</span><span class="n">se.at</span><span class="p">)),</span>
<span class="w">           </span><span class="n">ub.hr</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="nf">exp</span><span class="p">(</span><span class="n">wo</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.wo</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">wp</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.wp</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">wc</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.wc</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">ws</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.ws</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">wt</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.wt</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">bo</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.bo</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">bp</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.bp</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">bc</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.bc</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">bs</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.bs</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">bt</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.bt</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">ho</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.ho</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">hp</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.hp</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">hc</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.hc</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">hs</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.hs</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">ht</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.ht</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">ao</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.ao</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">ap</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.ap</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">ac</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.ac</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">as</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.as</span><span class="p">),</span>
<span class="w">                   </span><span class="nf">exp</span><span class="p">(</span><span class="n">at</span><span class="m">+1.96</span><span class="o">*</span><span class="n">se.at</span><span class="p">))</span>
<span class="w">           </span><span class="p">)</span>

<span class="n">fig1.df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rbind</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="n">fig1.df</span><span class="p">)</span>
<span class="n">fig1.df</span><span class="o">$</span><span class="n">race</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">6</span><span class="p">),</span><span class="nf">rep</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">5</span><span class="p">),</span><span class="nf">rep</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="m">5</span><span class="p">),</span><span class="nf">rep</span><span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="m">5</span><span class="p">))</span>
<span class="n">fig1.df</span><span class="o">$</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ordered</span><span class="p">(</span><span class="n">fig1.df</span><span class="o">$</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">levels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">21</span><span class="p">),</span><span class="w"> </span>
<span class="w">                        </span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Unr&quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Oth&quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Par&quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Off&quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Sib&quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Twi&quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Oth &quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Par &quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Off &quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Sib &quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Twi &quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Oth  &quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Par  &quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Off  &quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Sib  &quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Twi  &quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Oth   &quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Par   &quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Off   &quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Sib   &quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;Twi   &quot;</span>
<span class="w">                                 </span><span class="p">)</span>
<span class="w">                     </span><span class="p">)</span>
<span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">fig1.df</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">factor</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">hr</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="nf">as.factor</span><span class="p">(</span><span class="n">race</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme_bw</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_hline</span><span class="p">(</span><span class="n">yintercept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="s">&quot;Hazard Ratios (95% CI)&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">       </span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">scale_color_manual</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Race&quot;</span><span class="p">,</span>
<span class="w">                     </span><span class="n">values</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;2&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;2&quot;</span><span class="o">=</span><span class="s">&quot;3&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;3&quot;</span><span class="o">=</span><span class="s">&quot;4&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;4&quot;</span><span class="o">=</span><span class="s">&quot;5&quot;</span><span class="p">),</span>
<span class="w">                     </span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;White&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Black&quot;</span><span class="p">,</span><span class="s">&quot;Hispanic&quot;</span><span class="p">,</span><span class="s">&quot;Asian&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">geom_errorbar</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="n">.</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">ymin</span><span class="o">=</span><span class="n">lb.hr</span><span class="p">,</span><span class="w"> </span><span class="n">ymax</span><span class="o">=</span><span class="n">ub.hr</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">scale_y_log10</span><span class="p">(</span><span class="n">breaks</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">.</span><span class="m">01</span><span class="p">,</span><span class="n">.</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">10</span><span class="p">,</span><span class="m">100</span><span class="p">,</span><span class="m">1000</span><span class="p">,</span><span class="m">10000</span><span class="p">),</span><span class="n">limits</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">.</span><span class="m">01</span><span class="p">,</span><span class="m">10000</span><span class="p">),</span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;0.01&quot;</span><span class="p">,</span><span class="s">&quot;0.1&quot;</span><span class="p">,</span><span class="s">&quot;1&quot;</span><span class="p">,</span><span class="s">&quot;10&quot;</span><span class="p">,</span><span class="s">&quot;100&quot;</span><span class="p">,</span><span class="s">&quot;1000&quot;</span><span class="p">,</span><span class="s">&quot;10000&quot;</span><span class="p">))</span>

<span class="c1"># using previous paper format graphs, separated by race as well </span>
<span class="nf">ggplot</span><span class="p">(</span><span class="n">fig1.df</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">6</span><span class="p">,],</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">hr</span><span class="p">))</span><span class="o">+</span><span class="nf">geom_errorbar</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">ymin</span><span class="o">=</span><span class="n">lb.hr</span><span class="p">,</span><span class="w"> </span><span class="n">ymax</span><span class="o">=</span><span class="n">ub.hr</span><span class="p">),</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="o">=</span><span class="m">0.3</span><span class="p">)</span><span class="o">+</span><span class="nf">geom_point</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">)</span><span class="o">+</span><span class="nf">scale_y_log10</span><span class="p">(</span><span class="n">breaks</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">.</span><span class="m">01</span><span class="p">,</span><span class="n">.</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">10</span><span class="p">,</span><span class="m">100</span><span class="p">,</span><span class="m">1000</span><span class="p">),</span><span class="n">limits</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">.</span><span class="m">01</span><span class="p">,</span><span class="m">1000</span><span class="p">),</span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;0.01&quot;</span><span class="p">,</span><span class="s">&quot;0.1&quot;</span><span class="p">,</span><span class="s">&quot;1&quot;</span><span class="p">,</span><span class="s">&quot;10&quot;</span><span class="p">,</span><span class="s">&quot;100&quot;</span><span class="p">,</span><span class="s">&quot;1000&quot;</span><span class="p">))</span><span class="o">+</span><span class="nf">theme_classic</span><span class="p">()</span><span class="o">+</span><span class="nf">theme</span><span class="p">(</span><span class="n">panel.border</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_rect</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;black&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="kc">NA</span><span class="p">),</span><span class="n">strip.background</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_rect</span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">))</span><span class="o">+</span><span class="nf">geom_hline</span><span class="p">(</span><span class="n">yintercept</span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">linetype</span><span class="o">=</span><span class="s">&quot;dashed&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;darkgreen&quot;</span><span class="p">)</span><span class="o">+</span><span class="nf">labs</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Adjusted 30-Year Risk of ESKD (95% CI)&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Donor-Recipient Relationship&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">title</span><span class="o">=</span><span class="s">&quot;White Donors&quot;</span><span class="p">)</span>

<span class="n">tmp1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rbind</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">),</span><span class="n">fig1.df</span><span class="p">[</span><span class="m">7</span><span class="o">:</span><span class="m">11</span><span class="p">,])</span>
<span class="n">tmp1</span><span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&quot;Unr&quot;</span>

<span class="nf">ggplot</span><span class="p">(</span><span class="n">tmp1</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">hr</span><span class="p">))</span><span class="o">+</span><span class="nf">geom_errorbar</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">ymin</span><span class="o">=</span><span class="n">lb.hr</span><span class="p">,</span><span class="w"> </span><span class="n">ymax</span><span class="o">=</span><span class="n">ub.hr</span><span class="p">),</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="o">=</span><span class="m">0.3</span><span class="p">)</span><span class="o">+</span><span class="nf">geom_point</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">)</span><span class="o">+</span><span class="nf">scale_y_log10</span><span class="p">(</span><span class="n">breaks</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">.</span><span class="m">01</span><span class="p">,</span><span class="n">.</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">10</span><span class="p">,</span><span class="m">100</span><span class="p">,</span><span class="m">1000</span><span class="p">),</span><span class="n">limits</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">.</span><span class="m">01</span><span class="p">,</span><span class="m">1000</span><span class="p">),</span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;0.01&quot;</span><span class="p">,</span><span class="s">&quot;0.1&quot;</span><span class="p">,</span><span class="s">&quot;1&quot;</span><span class="p">,</span><span class="s">&quot;10&quot;</span><span class="p">,</span><span class="s">&quot;100&quot;</span><span class="p">,</span><span class="s">&quot;1000&quot;</span><span class="p">))</span><span class="o">+</span><span class="nf">theme_classic</span><span class="p">()</span><span class="o">+</span><span class="nf">theme</span><span class="p">(</span><span class="n">panel.border</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_rect</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;black&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="kc">NA</span><span class="p">),</span><span class="n">strip.background</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_rect</span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">))</span><span class="o">+</span><span class="nf">geom_hline</span><span class="p">(</span><span class="n">yintercept</span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">linetype</span><span class="o">=</span><span class="s">&quot;dashed&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;darkgreen&quot;</span><span class="p">)</span><span class="o">+</span><span class="nf">labs</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Adjusted 30-Year Risk of ESKD (95% CI)&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Donor-Recipient Relationship&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">title</span><span class="o">=</span><span class="s">&quot;Black Donors&quot;</span><span class="p">)</span>

<span class="n">tmp2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rbind</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">3</span><span class="p">),</span><span class="n">fig1.df</span><span class="p">[</span><span class="m">12</span><span class="o">:</span><span class="m">16</span><span class="p">,])</span>
<span class="n">tmp2</span><span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&quot;Unr&quot;</span>
<span class="nf">ggplot</span><span class="p">(</span><span class="n">tmp2</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">hr</span><span class="p">))</span><span class="o">+</span><span class="nf">geom_errorbar</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">ymin</span><span class="o">=</span><span class="n">lb.hr</span><span class="p">,</span><span class="w"> </span><span class="n">ymax</span><span class="o">=</span><span class="n">ub.hr</span><span class="p">),</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="o">=</span><span class="m">0.3</span><span class="p">)</span><span class="o">+</span><span class="nf">geom_point</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">)</span><span class="o">+</span><span class="nf">scale_y_log10</span><span class="p">(</span><span class="n">breaks</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">.</span><span class="m">01</span><span class="p">,</span><span class="n">.</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">10</span><span class="p">,</span><span class="m">100</span><span class="p">,</span><span class="m">1000</span><span class="p">),</span><span class="n">limits</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">.</span><span class="m">01</span><span class="p">,</span><span class="m">1000</span><span class="p">),</span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;0.01&quot;</span><span class="p">,</span><span class="s">&quot;0.1&quot;</span><span class="p">,</span><span class="s">&quot;1&quot;</span><span class="p">,</span><span class="s">&quot;10&quot;</span><span class="p">,</span><span class="s">&quot;100&quot;</span><span class="p">,</span><span class="s">&quot;1000&quot;</span><span class="p">))</span><span class="o">+</span><span class="nf">theme_classic</span><span class="p">()</span><span class="o">+</span><span class="nf">theme</span><span class="p">(</span><span class="n">panel.border</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_rect</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;black&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="kc">NA</span><span class="p">),</span><span class="n">strip.background</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_rect</span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">))</span><span class="o">+</span><span class="nf">geom_hline</span><span class="p">(</span><span class="n">yintercept</span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">linetype</span><span class="o">=</span><span class="s">&quot;dashed&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;darkgreen&quot;</span><span class="p">)</span><span class="o">+</span><span class="nf">labs</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Adjusted 30-Year Risk of ESKD (95% CI)&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Donor-Recipient Relationship&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">title</span><span class="o">=</span><span class="s">&quot;Hispanic Donors&quot;</span><span class="p">)</span>

<span class="n">tmp3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rbind</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">4</span><span class="p">),</span><span class="n">fig1.df</span><span class="p">[</span><span class="m">17</span><span class="o">:</span><span class="m">21</span><span class="p">,])</span>
<span class="n">tmp3</span><span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&quot;Unr&quot;</span>
<span class="nf">ggplot</span><span class="p">(</span><span class="n">tmp3</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">hr</span><span class="p">))</span><span class="o">+</span><span class="nf">geom_errorbar</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">ymin</span><span class="o">=</span><span class="n">lb.hr</span><span class="p">,</span><span class="w"> </span><span class="n">ymax</span><span class="o">=</span><span class="n">ub.hr</span><span class="p">),</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="o">=</span><span class="m">0.3</span><span class="p">)</span><span class="o">+</span><span class="nf">geom_point</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">)</span><span class="o">+</span><span class="nf">scale_y_log10</span><span class="p">(</span><span class="n">breaks</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">.</span><span class="m">01</span><span class="p">,</span><span class="n">.</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">10</span><span class="p">,</span><span class="m">100</span><span class="p">,</span><span class="m">1000</span><span class="p">),</span><span class="n">limits</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">.</span><span class="m">01</span><span class="p">,</span><span class="m">1000</span><span class="p">),</span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;0.01&quot;</span><span class="p">,</span><span class="s">&quot;0.1&quot;</span><span class="p">,</span><span class="s">&quot;1&quot;</span><span class="p">,</span><span class="s">&quot;10&quot;</span><span class="p">,</span><span class="s">&quot;100&quot;</span><span class="p">,</span><span class="s">&quot;1000&quot;</span><span class="p">))</span><span class="o">+</span><span class="nf">theme_classic</span><span class="p">()</span><span class="o">+</span><span class="nf">theme</span><span class="p">(</span><span class="n">panel.border</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_rect</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;black&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="kc">NA</span><span class="p">),</span><span class="n">strip.background</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_rect</span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">))</span><span class="o">+</span><span class="nf">geom_hline</span><span class="p">(</span><span class="n">yintercept</span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">linetype</span><span class="o">=</span><span class="s">&quot;dashed&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;darkgreen&quot;</span><span class="p">)</span><span class="o">+</span><span class="nf">labs</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Adjusted 30-Year Risk of ESKD (95% CI)&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Donor-Recipient Relationship&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">title</span><span class="o">=</span><span class="s">&quot;Asian Donors&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="id8">
<h2>3.20 kaplan-meier<a class="headerlink" href="#id8" title="Permalink to this heading">#</a></h2>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">km</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">survfit</span><span class="p">(</span><span class="nf">Surv</span><span class="p">(</span><span class="n">fup_esrd</span><span class="p">,</span><span class="n">esrd</span><span class="p">)</span><span class="o">~</span><span class="n">race</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="nf">ggsurvplot</span><span class="p">(</span>
<span class="w">  </span><span class="n">km</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="n">fun</span><span class="o">=</span><span class="s">&quot;event&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="n">risk.table</span><span class="o">=</span><span class="bp">T</span><span class="p">,</span>
<span class="w">  </span><span class="n">test.for.trend</span><span class="o">=</span><span class="bp">T</span><span class="p">,</span>
<span class="w">  </span><span class="n">conf.int</span><span class="o">=</span><span class="bp">F</span><span class="p">,</span>
<span class="w">  </span><span class="n">xlim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">30</span><span class="p">),</span>
<span class="w">  </span><span class="n">ylim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="n">.</span><span class="m">02</span><span class="p">),</span>
<span class="w">  </span><span class="n">linetype</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">4</span><span class="p">),</span>
<span class="w">  </span><span class="n">break.time.by</span><span class="o">=</span><span class="m">5</span><span class="p">,</span>
<span class="w">  </span><span class="n">ggtheme</span><span class="o">=</span><span class="nf">theme_minimal</span><span class="p">(),</span>
<span class="w">  </span><span class="n">lty</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">),</span>
<span class="w">  </span><span class="n">lwd</span><span class="o">=</span><span class="m">3</span><span class="p">,</span>
<span class="w">  </span><span class="n">risk.table.y.text.col</span><span class="o">=</span><span class="bp">T</span><span class="p">,</span>
<span class="w">  </span><span class="n">risk.table.y.text</span><span class="o">=</span><span class="bp">F</span><span class="p">,</span>
<span class="w">  </span><span class="n">surv.plot.height</span><span class="o">=</span><span class="n">.</span><span class="m">9</span><span class="p">,</span>
<span class="w">  </span><span class="n">risk.table.height</span><span class="o">=</span><span class="n">.</span><span class="m">3</span><span class="p">,</span>
<span class="w">  </span><span class="n">censor</span><span class="o">=</span><span class="bp">F</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="coef-matrix">
<h2>3.21 coef matrix<a class="headerlink" href="#coef-matrix" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Variable&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s1">&#39;ethBlack&#39;</span><span class="p">,</span> <span class="s1">&#39;ethAsian&#39;</span><span class="p">,</span> <span class="s1">&#39;ethHispanic&#39;</span><span class="p">,</span> <span class="s1">&#39;famParent&#39;</span><span class="p">,</span> <span class="s1">&#39;famChild&#39;</span><span class="p">,</span> <span class="s1">&#39;famTwin&#39;</span><span class="p">,</span> <span class="s1">&#39;famSibling&#39;</span><span class="p">,</span> <span class="s1">&#39;famOther&#39;</span><span class="p">,</span>
        <span class="s1">&#39;don_age&#39;</span><span class="p">,</span> <span class="s1">&#39;don_gender.L&#39;</span><span class="p">,</span> <span class="s1">&#39;ethBlack:famParent&#39;</span><span class="p">,</span> <span class="s1">&#39;ethAsian:famParent&#39;</span><span class="p">,</span> <span class="s1">&#39;ethHispanic:famParent&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ethBlack:famChild&#39;</span><span class="p">,</span> <span class="s1">&#39;ethAsian:famChild&#39;</span><span class="p">,</span> <span class="s1">&#39;ethHispanic:famChild&#39;</span><span class="p">,</span> <span class="s1">&#39;ethBlack:famTwin&#39;</span><span class="p">,</span> <span class="s1">&#39;ethAsian:famTwin&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ethHispanic:famTwin&#39;</span><span class="p">,</span> <span class="s1">&#39;ethBlack:famSibling&#39;</span><span class="p">,</span> <span class="s1">&#39;ethAsian:famSibling&#39;</span><span class="p">,</span> <span class="s1">&#39;ethHispanic:famSibling&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ethBlack:famOther&#39;</span><span class="p">,</span> <span class="s1">&#39;ethAsian:famOther&#39;</span><span class="p">,</span> <span class="s1">&#39;ethHispanic:famOther&#39;</span>
    <span class="p">],</span>
    <span class="s1">&#39;Value&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="mf">1.0151953246669</span><span class="p">,</span> <span class="o">-</span><span class="mf">14.927497085093</span><span class="p">,</span> <span class="mf">0.678461896702298</span><span class="p">,</span> <span class="mf">0.230265573210636</span><span class="p">,</span> <span class="mf">0.013544913171065</span><span class="p">,</span> <span class="mf">1.42910461013563</span><span class="p">,</span>
        <span class="mf">0.236455951477178</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.787491191503819</span><span class="p">,</span> <span class="mf">0.0119317639310039</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.572389580257542</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.86969428217781</span><span class="p">,</span>
        <span class="mf">14.3877734454682</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.993232170840791</span><span class="p">,</span> <span class="o">-</span><span class="mf">16.038225913901</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.123974478022701</span><span class="p">,</span> <span class="o">-</span><span class="mf">15.6236161172565</span><span class="p">,</span> <span class="o">-</span><span class="mf">17.3373645602685</span><span class="p">,</span>
        <span class="s2">&quot;NA&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mf">17.2130352804811</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.08195857557585</span><span class="p">,</span> <span class="mf">15.880675396788</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.445355654043098</span><span class="p">,</span> <span class="o">-</span><span class="mf">15.1325387892128</span><span class="p">,</span>
        <span class="mf">0.712239764066844</span><span class="p">,</span> <span class="mf">0.734976112544702</span>
    <span class="p">]</span>
<span class="p">}</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  Variable      Value
0                 ethBlack   1.015195
1                 ethAsian -14.927497
2              ethHispanic   0.678462
3                famParent   0.230266
4                 famChild   0.013545
5                  famTwin   1.429105
6               famSibling   0.236456
7                 famOther  -0.787491
8                  don_age   0.011932
9             don_gender.L   -0.57239
10      ethBlack:famParent  -0.869694
11      ethAsian:famParent  14.387773
12   ethHispanic:famParent  -0.993232
13       ethBlack:famChild -16.038226
14       ethAsian:famChild  -0.123974
15    ethHispanic:famChild -15.623616
16        ethBlack:famTwin -17.337365
17        ethAsian:famTwin         NA
18     ethHispanic:famTwin -17.213035
19     ethBlack:famSibling  -1.081959
20     ethAsian:famSibling  15.880675
21  ethHispanic:famSibling  -0.445356
22       ethBlack:famOther -15.132539
23       ethAsian:famOther    0.71224
24    ethHispanic:famOther   0.734976
</pre></div>
</div>
</div>
</div>
</section>
<section id="var-cov-matrix">
<h2>3.22 var-cov matrix<a class="headerlink" href="#var-cov-matrix" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">StringIO</span>

<span class="n">data_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">	ethBlack	ethAsian	ethHispanic	famParent	famChild	famTwin	famSibling	famOther	don_age	don_gender.L	ethBlack:famParent	ethAsian:famParent	ethHispanic:famParent	ethBlack:famChild	don_age	ethHispanic:famChild	ethBlack:famTwin	ethAsian:famTwin	ethHispanic:famTwin	ethBlack:famSibling	ethAsian:famSibling	ethHispanic:famSibling	ethBlack:famOther	ethAsian:famOther	ethHispanic:famOther</span>
<span class="s2">ethBlack	0.190894678788476	0.0235558442160578	0.0239652420030226	0.0239074469413327	0.0250593904018294	0.0233161243880576	0.0243570674309782	0.02406557675074	0.000291018909049624	0.00075699762938253	-0.190533006549935	-0.0237027802326494	-0.023861631979757	-0.190720406678491	0.000291018909049624	-0.0238165315451206	-0.190130381503623	0	-0.0232010584696114	-0.190747726705487	-0.0237227293836337	-0.0238509353218037	-0.190543539419183	-0.0235982539171211	-0.023603936601252</span>
<span class="s2">ethAsian	0.0235558442160578	2776034.58680885	0.0237356706031963	0.0234854690671213	0.0231070683959841	0.0238888385802423	0.0233354802479866	0.0235445958797368	-0.00016356422103387	-0.000812957663761613	-0.0237003819249422	-2776034.586553	-0.0237383547297809	-0.0237071458502807	-0.00016356422103387	-0.0237715473888845	-0.0234052052999598	0	-0.0240387707656515	-0.0236110008310505	-2776034.5866118	-0.0237364359515111	-0.0236701519763141	-2776034.58679018	-0.0239230334423816</span>
<span class="s2">ethHispanic	0.0239652420030226	0.0237356706031963	0.22388527128733	0.0238408190283083	0.0243077120769637	0.023547048506404	0.0240139930927071	0.0238886758141502	0.000117122753680552	0.000131034364789064	-0.0238300060610353	-0.0238089559773688	-0.22384370428551	-0.0239179904234862	0.000117122753680552	-0.223777638581397	-0.0233999424957336	0	-0.223601144766981	-0.0239250194373203	-0.023801014687455	-0.223813013498558	-0.0238263306272248	-0.023789277122574	-0.223726741307308</span>
<span class="s2">famParent	0.0239074469413327	0.0234854690671213	0.0238408190283083	0.0473145436335008	0.0229531992196133	0.0262866443094213	0.0259868633880186	0.0252961945643431	-7.54195985158145E-05	0.000657761593986339	-0.0445237889252271	-0.04511521465306	-0.0443046060551221	-0.023667970863374	-7.54195985158145E-05	-0.0230511871237024	-0.0290640218005166	0	-0.0265801278647533	-0.0245339728562016	-0.0247176644360182	-0.0242234510144319	-0.0253119509898178	-0.0232965565986291	-0.024071231298798</span>
<span class="s2">famChild	0.0250593904018294	0.0231070683959841	0.0243077120769637	0.0229531992196133	1.02831451320895	0.0208464039762603	0.024963700147173	0.0241349367091637	0.00101216030782392	0.000765896440579043	-0.0235725950836856	-0.0231342294716064	-0.0237076209578611	-1.02474653853163	0.00101216030782392	-1.02413235518908	-0.019824787967461	0	-0.0207864581296927	-0.0244398779038476	-0.0233200894472744	-0.0236168646444364	-0.0233180123120797	-0.0235839907800947	-0.0228839936455257</span>
<span class="s2">famTwin	0.0233161243880576	0.0238888385802423	0.023547048506404	0.0262866443094213	0.0208464039762603	1.02765522379058	0.0243231825450455	0.024526536951529	-0.000623282544920257	0.00251077402793043	-0.0245861027101174	-0.0247170475190836	-0.0243157299671054	-0.023042680871504	-0.000623282544920257	-0.023191391522418	-1.03065789841987	0	-1.02729018632717	-0.0238941784465175	-0.0243571582473462	-0.0244530227229242	-0.0252047524365899	-0.023290926232266	-0.0246502916961579</span>
<span class="s2">famSibling	0.0243570674309782	0.0233354802479866	0.0240139930927071	0.0259868633880186	0.024963700147173	0.0243231825450455	0.0506724574453309	0.0249179845266547	0.000341694088942578	0.000549775954737047	-0.0244065128866379	-0.0245662718716258	-0.0243299724457504	-0.0240873704094057	0.000341694088942578	-0.023433388655679	-0.0258671400374308	0	-0.0244515600249059	-0.0495008143165027	-0.0491843526099389	-0.0489881758273534	-0.0245653620210343	-0.0233673440735018	-0.0236162617067214</span>
<span class="s2">famOther	0.02406557675074	0.0235445958797368	0.0238886758141502	0.0252961945643431	0.0241349367091637	0.024526536951529	0.0249179845266547	0.357855860962318	0.000125416706482289	0.000532437226052883	-0.0242187760911225	-0.0242973279239917	-0.0241471643798098	-0.0238901592233782	0.000125416706482289	-0.0235507325572539	-0.0258196381038334	0	-0.0245280303417383	-0.0241941326313094	-0.0240633404940337	-0.0239708466462066	-0.357703907374572	-0.356812464911102	-0.357118256510536</span>
<span class="s2">don_age	0.000291018909049624	-0.00016356422103387	0.000117122753680552	-7.54195985158145E-05	0.00101216030782392	-0.000623282544920257	0.000341694088942578	0.000125416706482289	0.000234428401327097	5.61503624781432E-05	2.87001202691717E-05	0.00011165199169082	-3.69716615405781E-06	-0.000222428903854332	0.000234428401327097	-4.03088988333006E-05	0.000777672635218292	0	0.000616274373564922	-0.000164805987751014	8.14979501336502E-05	4.56138907343494E-05	8.1919139857354E-05	5.99870523943372E-05	0.000213025091058376</span>
<span class="s2">don_gender.L	0.00075699762938253	-0.000812957663761613	0.000131034364789064	0.000657761593986339	0.000765896440579043	0.00251077402793043	0.000549775954737047	0.000532437226052883	5.61503624781432E-05	0.0121380387964427	-0.000818108948751681	5.9093048021296E-05	-0.000210126093038624	0.000708597768668398	5.61503624781432E-05	-0.000122702251291008	-0.00534909868135995	0	-0.000296504219099567	-0.000650651023982381	0.000314268952068898	-0.00141223691620152	-0.00173540146186277	0.00158139474718642	-0.00068275005754803</span>
<span class="s2">ethBlack:famParent	-0.190533006549935	-0.0237003819249422	-0.0238300060610353	-0.0445237889252271	-0.0235725950836856	-0.0245861027101174	-0.0244065128866379	-0.0242187760911225	2.87001202691717E-05	-0.000818108948751681	0.41046175900419	0.0439398391063759	0.043682278787996	0.190408873947731	2.87001202691717E-05	0.0235975600548969	0.192051357036436	0	0.0245953362800284	0.190719242042659	0.0240756536327409	0.0239985854006052	0.191001954079834	0.0235903636163333	0.0239408946123176</span>
<span class="s2">ethAsian:famParent	-0.0237027802326494	-2776034.586553	-0.0238089559773688	-0.04511521465306	-0.0231342294716064	-0.0247170475190836	-0.0245662718716258	-0.0242973279239917	0.00011165199169082	5.9093048021296E-05	0.0439398391063759	2776035.60724489	0.0438340149246634	0.0236869717108996	0.00011165199169082	0.0234589470915579	0.0252237394017576	0	0.0250557367097241	0.024094026959306	2776034.58712189	0.0239570786920573	0.0244546720071311	2776034.58655996	0.023972746891028</span>
<span class="s2">ethHispanic:famParent	-0.023861631979757	-0.0237383547297809	-0.22384370428551	-0.0443046060551221	-0.0237076209578611	-0.0243157299671054	-0.0243299724457504	-0.0241471643798098	-3.69716615405781E-06	-0.000210126093038624	0.043682278787996	0.0438340149246634	0.493641902513275	0.0238025974429005	-3.69716615405781E-06	0.223600325177085	0.024785467926547	0	0.224453588118488	0.0240096334900731	0.024031499303689	0.22391408434107	0.0241756199051724	0.0237168621460648	0.22386607780078</span>
<span class="s2">ethBlack:famChild	-0.190720406678491	-0.0237071458502807	-0.0239179904234862	-0.023667970863374	-1.02474653853163	-0.023042680871504	-0.0240873704094057	-0.0238901592233782	-0.000222428903854332	0.000708597768668398	0.190408873947731	0.0236869717108996	0.0238025974429005	21840922.1470653	-0.000222428903854332	1.02384293304659	0.189351128638998	0	0.0232592877699353	0.190601161706669	0.023740903059757	0.0236703449794517	0.190300753822968	0.0238345023166807	0.0235737583740995</span>
<span class="s2">ethAsian:famChild	-0.0240203554988254	-2776034.58634793	-0.023813756118959	-0.0249343329510328	-1.02433508772954	-0.0238808597020131	-0.0249045043977197	-0.0245260268243064	-0.000205268051003536	0.002231458269685	0.0238776489054873	2776034.58660941	0.0239585304078598	1.02411469142812	-0.000205268051003536	1.02379764625343	0.0254464022021758	0	0.0237529252505827	0.0239493905862214	2776034.58667024	0.0235871481454047	0.0237783864124189	2776034.5862778	0.0234877112071948</span>
<span class="s2">ethHispanic:famChild	-0.0238165315451206	-0.0237715473888845	-0.223777638581397	-0.0230511871237024	-1.02413235518908	-0.023191391522418	-0.023433388655679	-0.0235507325572539	-4.03088988333006E-05	-0.000122702251291008	0.0235975600548969	0.0234589470915579	0.223600325177085	1.02384293304659	-4.03088988333006E-05	27656301.0454824	0.0231315449787933	0	0.222935669886477	0.0236509061131209	0.0235794814349779	0.223717871325324	0.0234689248147195	0.023755230973295	0.223702771103353</span>
<span class="s2">ethBlack:famTwin	-0.190130381503623	-0.0234052052999598	-0.0233999424957336	-0.0290640218005166	-0.019824787967461	-1.03065789841987	-0.0258671400374308	-0.0258196381038334	0.000777672635218292	-0.00534909868135995	0.192051357036436	0.0252237394017576	0.024785467926547	0.189351128638998	0.000777672635218292	0.0231315449787933	536484287.621405	0	1.02944605686477	0.190925174595078	0.0246300627025719	0.0250051392080098	0.193140902078007	0.0219798201275961	0.0249889025324745</span>
<span class="s2">ethAsian:famTwin	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0</span>
<span class="s2">ethHispanic:famTwin	-0.0232010584696114	-0.0240387707656515	-0.223601144766981	-0.0265801278647533	-0.0207864581296927	-1.02729018632717	-0.0244515600249059	-0.0245280303417383	0.000616274373564922	-0.000296504219099567	0.0245953362800284	0.0250557367097241	0.224453588118488	0.0232592877699353	0.000616274373564922	0.222935669886477	1.02944605686477	0	234021934.993277	0.0239582224335466	0.0245103801053452	0.224230755715213	0.0251119480568196	0.0239014403925007	0.224548400147941</span>
<span class="s2">ethBlack:famSibling	-0.190747726705487	-0.0236110008310505	-0.0239250194373203	-0.0245339728562016	-0.0244398779038476	-0.0238941784465175	-0.0495008143165027	-0.0241941326313094	-0.000164805987751014	-0.000650651023982381	0.190719242042659	0.024094026959306	0.0240096334900731	0.190601161706669	-0.000164805987751014	0.0236509061131209	0.190925174595078	0	0.0239582224335466	0.549126529263364	0.0489352283821505	0.0489172223887007	0.190797390868365	0.0236464109656927	0.0237411300930305</span>
<span class="s2">ethAsian:famSibling	-0.0237227293836337	-2776034.5866118	-0.023801014687455	-0.0247176644360182	-0.0233200894472744	-0.0243571582473462	-0.0491843526099389	-0.0240633404940337	8.14979501336502E-05	0.000314268952068898	0.0240756536327409	2776034.58712189	0.024031499303689	0.023740903059757	8.14979501336502E-05	0.0235794814349779	0.0246300627025719	0	0.0245103801053452	0.0489352283821505	2776034.94522617	0.0488719122910716	0.024143425271103	2776034.58656909	0.0239176713584075</span>
<span class="s2">ethHispanic:famSibling	-0.0238509353218037	-0.0237364359515111	-0.223813013498558	-0.0242234510144319	-0.0236168646444364	-0.0244530227229242	-0.0489881758273534	-0.0239708466462066	4.56138907343494E-05	-0.00141223691620152	0.0239985854006052	0.0239570786920573	0.22391408434107	0.0236703449794517	4.56138907343494E-05	0.223717871325324	0.0250051392080098	0	0.224230755715213	0.0489172223887007	0.0488719122910716	0.499023648963336	0.0241602283796845	0.0236061177537507	0.223962169254673</span>
<span class="s2">ethBlack:famOther	-0.190543539419183	-0.0236701519763141	-0.0238263306272248	-0.0253119509898178	-0.0233180123120797	-0.0252047524365899	-0.0245653620210343	-0.357703907374572	8.1919139857354E-05	-0.00173540146186277	0.191001954079834	0.0244546720071311	0.0241756199051724	0.190300753822968	8.1919139857354E-05	0.0234689248147195	0.193140902078007	0	0.0251119480568196	0.190797390868365	0.024143425271103	0.0241602283796845	4997024.13708618	0.356790641386149	0.357408557575104</span>
<span class="s2">ethAsian:famOther	-0.0235982539171211	-2776034.58679018	-0.023789277122574	-0.0232965565986291	-0.0235839907800947	-0.023290926232266	-0.0233673440735018	-0.356812464911102	5.99870523943372E-05	0.00158139474718642	0.0235903636163333	2776034.58655996	0.0237168621460648	0.0238345023166807	5.99870523943372E-05	0.023755230973295	0.0219798201275961	0	0.0239014403925007	0.0236464109656927	2776034.58656909	0.0236061177537507	0.356790641386149	20255750.0721761	0.35708518311905</span>
<span class="s2">ethHispanic:famOther	-0.023603936601252	-0.0239230334423816	-0.223726741307308	-0.024071231298798	-0.0228839936455257	-0.0246502916961579	-0.0236162617067214	-0.357118256510536	0.000213025091058376	-0.00068275005754803	0.0239408946123176	0.023972746891028	0.22386607780078	0.0235737583740995	0.000213025091058376	0.223702771103353	0.0249889025324745	0	0.224548400147941	0.0237411300930305	0.0239176713584075	0.223962169254673	0.357408557575104	0.35708518311905	1.55741965700759</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="c1"># Convert the data string into a pandas DataFrame</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">(</span><span class="n">data_str</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">delim_whitespace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Print the DataFrame</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>


<span class="c1"># Save the DataFrame as a CSV file</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;/users/d/desktop/output.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                        ethBlack      ethAsian  ethHispanic  famParent  \
ethBlack                0.190895  2.355584e-02     0.023965   0.023907   
ethAsian                0.023556  2.776035e+06     0.023736   0.023485   
ethHispanic             0.023965  2.373567e-02     0.223885   0.023841   
famParent               0.023907  2.348547e-02     0.023841   0.047315   
famChild                0.025059  2.310707e-02     0.024308   0.022953   
famTwin                 0.023316  2.388884e-02     0.023547   0.026287   
famSibling              0.024357  2.333548e-02     0.024014   0.025987   
famOther                0.024066  2.354460e-02     0.023889   0.025296   
don_age                 0.000291 -1.635642e-04     0.000117  -0.000075   
don_gender.L            0.000757 -8.129577e-04     0.000131   0.000658   
ethBlack:famParent     -0.190533 -2.370038e-02    -0.023830  -0.044524   
ethAsian:famParent     -0.023703 -2.776035e+06    -0.023809  -0.045115   
ethHispanic:famParent  -0.023862 -2.373835e-02    -0.223844  -0.044305   
ethBlack:famChild      -0.190720 -2.370715e-02    -0.023918  -0.023668   
ethAsian:famChild      -0.024020 -2.776035e+06    -0.023814  -0.024934   
ethHispanic:famChild   -0.023817 -2.377155e-02    -0.223778  -0.023051   
ethBlack:famTwin       -0.190130 -2.340521e-02    -0.023400  -0.029064   
ethAsian:famTwin        0.000000  0.000000e+00     0.000000   0.000000   
ethHispanic:famTwin    -0.023201 -2.403877e-02    -0.223601  -0.026580   
ethBlack:famSibling    -0.190748 -2.361100e-02    -0.023925  -0.024534   
ethAsian:famSibling    -0.023723 -2.776035e+06    -0.023801  -0.024718   
ethHispanic:famSibling -0.023851 -2.373644e-02    -0.223813  -0.024223   
ethBlack:famOther      -0.190544 -2.367015e-02    -0.023826  -0.025312   
ethAsian:famOther      -0.023598 -2.776035e+06    -0.023789  -0.023297   
ethHispanic:famOther   -0.023604 -2.392303e-02    -0.223727  -0.024071   

                        famChild   famTwin  famSibling  famOther   don_age  \
ethBlack                0.025059  0.023316    0.024357  0.024066  0.000291   
ethAsian                0.023107  0.023889    0.023335  0.023545 -0.000164   
ethHispanic             0.024308  0.023547    0.024014  0.023889  0.000117   
famParent               0.022953  0.026287    0.025987  0.025296 -0.000075   
famChild                1.028315  0.020846    0.024964  0.024135  0.001012   
famTwin                 0.020846  1.027655    0.024323  0.024527 -0.000623   
famSibling              0.024964  0.024323    0.050672  0.024918  0.000342   
famOther                0.024135  0.024527    0.024918  0.357856  0.000125   
don_age                 0.001012 -0.000623    0.000342  0.000125  0.000234   
don_gender.L            0.000766  0.002511    0.000550  0.000532  0.000056   
ethBlack:famParent     -0.023573 -0.024586   -0.024407 -0.024219  0.000029   
ethAsian:famParent     -0.023134 -0.024717   -0.024566 -0.024297  0.000112   
ethHispanic:famParent  -0.023708 -0.024316   -0.024330 -0.024147 -0.000004   
ethBlack:famChild      -1.024747 -0.023043   -0.024087 -0.023890 -0.000222   
ethAsian:famChild      -1.024335 -0.023881   -0.024905 -0.024526 -0.000205   
ethHispanic:famChild   -1.024132 -0.023191   -0.023433 -0.023551 -0.000040   
ethBlack:famTwin       -0.019825 -1.030658   -0.025867 -0.025820  0.000778   
ethAsian:famTwin        0.000000  0.000000    0.000000  0.000000  0.000000   
ethHispanic:famTwin    -0.020786 -1.027290   -0.024452 -0.024528  0.000616   
ethBlack:famSibling    -0.024440 -0.023894   -0.049501 -0.024194 -0.000165   
ethAsian:famSibling    -0.023320 -0.024357   -0.049184 -0.024063  0.000081   
ethHispanic:famSibling -0.023617 -0.024453   -0.048988 -0.023971  0.000046   
ethBlack:famOther      -0.023318 -0.025205   -0.024565 -0.357704  0.000082   
ethAsian:famOther      -0.023584 -0.023291   -0.023367 -0.356812  0.000060   
ethHispanic:famOther   -0.022884 -0.024650   -0.023616 -0.357118  0.000213   

                        don_gender.L  ...  ethHispanic:famChild  \
ethBlack                    0.000757  ...         -2.381653e-02   
ethAsian                   -0.000813  ...         -2.377155e-02   
ethHispanic                 0.000131  ...         -2.237776e-01   
famParent                   0.000658  ...         -2.305119e-02   
famChild                    0.000766  ...         -1.024132e+00   
famTwin                     0.002511  ...         -2.319139e-02   
famSibling                  0.000550  ...         -2.343339e-02   
famOther                    0.000532  ...         -2.355073e-02   
don_age                     0.000056  ...         -4.030890e-05   
don_gender.L                0.012138  ...         -1.227023e-04   
ethBlack:famParent         -0.000818  ...          2.359756e-02   
ethAsian:famParent          0.000059  ...          2.345895e-02   
ethHispanic:famParent      -0.000210  ...          2.236003e-01   
ethBlack:famChild           0.000709  ...          1.023843e+00   
ethAsian:famChild           0.002231  ...          1.023798e+00   
ethHispanic:famChild       -0.000123  ...          2.765630e+07   
ethBlack:famTwin           -0.005349  ...          2.313154e-02   
ethAsian:famTwin            0.000000  ...          0.000000e+00   
ethHispanic:famTwin        -0.000297  ...          2.229357e-01   
ethBlack:famSibling        -0.000651  ...          2.365091e-02   
ethAsian:famSibling         0.000314  ...          2.357948e-02   
ethHispanic:famSibling     -0.001412  ...          2.237179e-01   
ethBlack:famOther          -0.001735  ...          2.346892e-02   
ethAsian:famOther           0.001581  ...          2.375523e-02   
ethHispanic:famOther       -0.000683  ...          2.237028e-01   

                        ethBlack:famTwin  ethAsian:famTwin  \
ethBlack                   -1.901304e-01                 0   
ethAsian                   -2.340521e-02                 0   
ethHispanic                -2.339994e-02                 0   
famParent                  -2.906402e-02                 0   
famChild                   -1.982479e-02                 0   
famTwin                    -1.030658e+00                 0   
famSibling                 -2.586714e-02                 0   
famOther                   -2.581964e-02                 0   
don_age                     7.776726e-04                 0   
don_gender.L               -5.349099e-03                 0   
ethBlack:famParent          1.920514e-01                 0   
ethAsian:famParent          2.522374e-02                 0   
ethHispanic:famParent       2.478547e-02                 0   
ethBlack:famChild           1.893511e-01                 0   
ethAsian:famChild           2.544640e-02                 0   
ethHispanic:famChild        2.313154e-02                 0   
ethBlack:famTwin            5.364843e+08                 0   
ethAsian:famTwin            0.000000e+00                 0   
ethHispanic:famTwin         1.029446e+00                 0   
ethBlack:famSibling         1.909252e-01                 0   
ethAsian:famSibling         2.463006e-02                 0   
ethHispanic:famSibling      2.500514e-02                 0   
ethBlack:famOther           1.931409e-01                 0   
ethAsian:famOther           2.197982e-02                 0   
ethHispanic:famOther        2.498890e-02                 0   

                        ethHispanic:famTwin  ethBlack:famSibling  \
ethBlack                      -2.320106e-02            -0.190748   
ethAsian                      -2.403877e-02            -0.023611   
ethHispanic                   -2.236011e-01            -0.023925   
famParent                     -2.658013e-02            -0.024534   
famChild                      -2.078646e-02            -0.024440   
famTwin                       -1.027290e+00            -0.023894   
famSibling                    -2.445156e-02            -0.049501   
famOther                      -2.452803e-02            -0.024194   
don_age                        6.162744e-04            -0.000165   
don_gender.L                  -2.965042e-04            -0.000651   
ethBlack:famParent             2.459534e-02             0.190719   
ethAsian:famParent             2.505574e-02             0.024094   
ethHispanic:famParent          2.244536e-01             0.024010   
ethBlack:famChild              2.325929e-02             0.190601   
ethAsian:famChild              2.375293e-02             0.023949   
ethHispanic:famChild           2.229357e-01             0.023651   
ethBlack:famTwin               1.029446e+00             0.190925   
ethAsian:famTwin               0.000000e+00             0.000000   
ethHispanic:famTwin            2.340219e+08             0.023958   
ethBlack:famSibling            2.395822e-02             0.549127   
ethAsian:famSibling            2.451038e-02             0.048935   
ethHispanic:famSibling         2.242308e-01             0.048917   
ethBlack:famOther              2.511195e-02             0.190797   
ethAsian:famOther              2.390144e-02             0.023646   
ethHispanic:famOther           2.245484e-01             0.023741   

                        ethAsian:famSibling  ethHispanic:famSibling  \
ethBlack                      -2.372273e-02               -0.023851   
ethAsian                      -2.776035e+06               -0.023736   
ethHispanic                   -2.380101e-02               -0.223813   
famParent                     -2.471766e-02               -0.024223   
famChild                      -2.332009e-02               -0.023617   
famTwin                       -2.435716e-02               -0.024453   
famSibling                    -4.918435e-02               -0.048988   
famOther                      -2.406334e-02               -0.023971   
don_age                        8.149795e-05                0.000046   
don_gender.L                   3.142690e-04               -0.001412   
ethBlack:famParent             2.407565e-02                0.023999   
ethAsian:famParent             2.776035e+06                0.023957   
ethHispanic:famParent          2.403150e-02                0.223914   
ethBlack:famChild              2.374090e-02                0.023670   
ethAsian:famChild              2.776035e+06                0.023587   
ethHispanic:famChild           2.357948e-02                0.223718   
ethBlack:famTwin               2.463006e-02                0.025005   
ethAsian:famTwin               0.000000e+00                0.000000   
ethHispanic:famTwin            2.451038e-02                0.224231   
ethBlack:famSibling            4.893523e-02                0.048917   
ethAsian:famSibling            2.776035e+06                0.048872   
ethHispanic:famSibling         4.887191e-02                0.499024   
ethBlack:famOther              2.414343e-02                0.024160   
ethAsian:famOther              2.776035e+06                0.023606   
ethHispanic:famOther           2.391767e-02                0.223962   

                        ethBlack:famOther  ethAsian:famOther  \
ethBlack                    -1.905435e-01      -2.359825e-02   
ethAsian                    -2.367015e-02      -2.776035e+06   
ethHispanic                 -2.382633e-02      -2.378928e-02   
famParent                   -2.531195e-02      -2.329656e-02   
famChild                    -2.331801e-02      -2.358399e-02   
famTwin                     -2.520475e-02      -2.329093e-02   
famSibling                  -2.456536e-02      -2.336734e-02   
famOther                    -3.577039e-01      -3.568125e-01   
don_age                      8.191914e-05       5.998705e-05   
don_gender.L                -1.735401e-03       1.581395e-03   
ethBlack:famParent           1.910020e-01       2.359036e-02   
ethAsian:famParent           2.445467e-02       2.776035e+06   
ethHispanic:famParent        2.417562e-02       2.371686e-02   
ethBlack:famChild            1.903008e-01       2.383450e-02   
ethAsian:famChild            2.377839e-02       2.776035e+06   
ethHispanic:famChild         2.346892e-02       2.375523e-02   
ethBlack:famTwin             1.931409e-01       2.197982e-02   
ethAsian:famTwin             0.000000e+00       0.000000e+00   
ethHispanic:famTwin          2.511195e-02       2.390144e-02   
ethBlack:famSibling          1.907974e-01       2.364641e-02   
ethAsian:famSibling          2.414343e-02       2.776035e+06   
ethHispanic:famSibling       2.416023e-02       2.360612e-02   
ethBlack:famOther            4.997024e+06       3.567906e-01   
ethAsian:famOther            3.567906e-01       2.025575e+07   
ethHispanic:famOther         3.574086e-01       3.570852e-01   

                        ethHispanic:famOther  
ethBlack                           -0.023604  
ethAsian                           -0.023923  
ethHispanic                        -0.223727  
famParent                          -0.024071  
famChild                           -0.022884  
famTwin                            -0.024650  
famSibling                         -0.023616  
famOther                           -0.357118  
don_age                             0.000213  
don_gender.L                       -0.000683  
ethBlack:famParent                  0.023941  
ethAsian:famParent                  0.023973  
ethHispanic:famParent               0.223866  
ethBlack:famChild                   0.023574  
ethAsian:famChild                   0.023488  
ethHispanic:famChild                0.223703  
ethBlack:famTwin                    0.024989  
ethAsian:famTwin                    0.000000  
ethHispanic:famTwin                 0.224548  
ethBlack:famSibling                 0.023741  
ethAsian:famSibling                 0.023918  
ethHispanic:famSibling              0.223962  
ethBlack:famOther                   0.357409  
ethAsian:famOther                   0.357085  
ethHispanic:famOther                1.557420  

[25 rows x 25 columns]
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ethBlack</th>
      <th>ethAsian</th>
      <th>ethHispanic</th>
      <th>famParent</th>
      <th>famChild</th>
      <th>famTwin</th>
      <th>famSibling</th>
      <th>famOther</th>
      <th>don_age</th>
      <th>don_gender.L</th>
      <th>...</th>
      <th>ethHispanic:famChild</th>
      <th>ethBlack:famTwin</th>
      <th>ethAsian:famTwin</th>
      <th>ethHispanic:famTwin</th>
      <th>ethBlack:famSibling</th>
      <th>ethAsian:famSibling</th>
      <th>ethHispanic:famSibling</th>
      <th>ethBlack:famOther</th>
      <th>ethAsian:famOther</th>
      <th>ethHispanic:famOther</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ethBlack</th>
      <td>0.190895</td>
      <td>2.355584e-02</td>
      <td>0.023965</td>
      <td>0.023907</td>
      <td>0.025059</td>
      <td>0.023316</td>
      <td>0.024357</td>
      <td>0.024066</td>
      <td>0.000291</td>
      <td>0.000757</td>
      <td>...</td>
      <td>-0.023817</td>
      <td>-0.190130</td>
      <td>0</td>
      <td>-0.023201</td>
      <td>-0.190748</td>
      <td>-2.372273e-02</td>
      <td>-0.023851</td>
      <td>-0.190544</td>
      <td>-2.359825e-02</td>
      <td>-0.023604</td>
    </tr>
    <tr>
      <th>ethAsian</th>
      <td>0.023556</td>
      <td>2.776035e+06</td>
      <td>0.023736</td>
      <td>0.023485</td>
      <td>0.023107</td>
      <td>0.023889</td>
      <td>0.023335</td>
      <td>0.023545</td>
      <td>-0.000164</td>
      <td>-0.000813</td>
      <td>...</td>
      <td>-0.023772</td>
      <td>-0.023405</td>
      <td>0</td>
      <td>-0.024039</td>
      <td>-0.023611</td>
      <td>-2.776035e+06</td>
      <td>-0.023736</td>
      <td>-0.023670</td>
      <td>-2.776035e+06</td>
      <td>-0.023923</td>
    </tr>
    <tr>
      <th>ethHispanic</th>
      <td>0.023965</td>
      <td>2.373567e-02</td>
      <td>0.223885</td>
      <td>0.023841</td>
      <td>0.024308</td>
      <td>0.023547</td>
      <td>0.024014</td>
      <td>0.023889</td>
      <td>0.000117</td>
      <td>0.000131</td>
      <td>...</td>
      <td>-0.223778</td>
      <td>-0.023400</td>
      <td>0</td>
      <td>-0.223601</td>
      <td>-0.023925</td>
      <td>-2.380101e-02</td>
      <td>-0.223813</td>
      <td>-0.023826</td>
      <td>-2.378928e-02</td>
      <td>-0.223727</td>
    </tr>
    <tr>
      <th>famParent</th>
      <td>0.023907</td>
      <td>2.348547e-02</td>
      <td>0.023841</td>
      <td>0.047315</td>
      <td>0.022953</td>
      <td>0.026287</td>
      <td>0.025987</td>
      <td>0.025296</td>
      <td>-0.000075</td>
      <td>0.000658</td>
      <td>...</td>
      <td>-0.023051</td>
      <td>-0.029064</td>
      <td>0</td>
      <td>-0.026580</td>
      <td>-0.024534</td>
      <td>-2.471766e-02</td>
      <td>-0.024223</td>
      <td>-0.025312</td>
      <td>-2.329656e-02</td>
      <td>-0.024071</td>
    </tr>
    <tr>
      <th>famChild</th>
      <td>0.025059</td>
      <td>2.310707e-02</td>
      <td>0.024308</td>
      <td>0.022953</td>
      <td>1.028315</td>
      <td>0.020846</td>
      <td>0.024964</td>
      <td>0.024135</td>
      <td>0.001012</td>
      <td>0.000766</td>
      <td>...</td>
      <td>-1.024132</td>
      <td>-0.019825</td>
      <td>0</td>
      <td>-0.020786</td>
      <td>-0.024440</td>
      <td>-2.332009e-02</td>
      <td>-0.023617</td>
      <td>-0.023318</td>
      <td>-2.358399e-02</td>
      <td>-0.022884</td>
    </tr>
    <tr>
      <th>famTwin</th>
      <td>0.023316</td>
      <td>2.388884e-02</td>
      <td>0.023547</td>
      <td>0.026287</td>
      <td>0.020846</td>
      <td>1.027655</td>
      <td>0.024323</td>
      <td>0.024527</td>
      <td>-0.000623</td>
      <td>0.002511</td>
      <td>...</td>
      <td>-0.023191</td>
      <td>-1.030658</td>
      <td>0</td>
      <td>-1.027290</td>
      <td>-0.023894</td>
      <td>-2.435716e-02</td>
      <td>-0.024453</td>
      <td>-0.025205</td>
      <td>-2.329093e-02</td>
      <td>-0.024650</td>
    </tr>
    <tr>
      <th>famSibling</th>
      <td>0.024357</td>
      <td>2.333548e-02</td>
      <td>0.024014</td>
      <td>0.025987</td>
      <td>0.024964</td>
      <td>0.024323</td>
      <td>0.050672</td>
      <td>0.024918</td>
      <td>0.000342</td>
      <td>0.000550</td>
      <td>...</td>
      <td>-0.023433</td>
      <td>-0.025867</td>
      <td>0</td>
      <td>-0.024452</td>
      <td>-0.049501</td>
      <td>-4.918435e-02</td>
      <td>-0.048988</td>
      <td>-0.024565</td>
      <td>-2.336734e-02</td>
      <td>-0.023616</td>
    </tr>
    <tr>
      <th>famOther</th>
      <td>0.024066</td>
      <td>2.354460e-02</td>
      <td>0.023889</td>
      <td>0.025296</td>
      <td>0.024135</td>
      <td>0.024527</td>
      <td>0.024918</td>
      <td>0.357856</td>
      <td>0.000125</td>
      <td>0.000532</td>
      <td>...</td>
      <td>-0.023551</td>
      <td>-0.025820</td>
      <td>0</td>
      <td>-0.024528</td>
      <td>-0.024194</td>
      <td>-2.406334e-02</td>
      <td>-0.023971</td>
      <td>-0.357704</td>
      <td>-3.568125e-01</td>
      <td>-0.357118</td>
    </tr>
    <tr>
      <th>don_age</th>
      <td>0.000291</td>
      <td>-1.635642e-04</td>
      <td>0.000117</td>
      <td>-0.000075</td>
      <td>0.001012</td>
      <td>-0.000623</td>
      <td>0.000342</td>
      <td>0.000125</td>
      <td>0.000234</td>
      <td>0.000056</td>
      <td>...</td>
      <td>-0.000040</td>
      <td>0.000778</td>
      <td>0</td>
      <td>0.000616</td>
      <td>-0.000165</td>
      <td>8.149795e-05</td>
      <td>0.000046</td>
      <td>0.000082</td>
      <td>5.998705e-05</td>
      <td>0.000213</td>
    </tr>
    <tr>
      <th>don_gender.L</th>
      <td>0.000757</td>
      <td>-8.129577e-04</td>
      <td>0.000131</td>
      <td>0.000658</td>
      <td>0.000766</td>
      <td>0.002511</td>
      <td>0.000550</td>
      <td>0.000532</td>
      <td>0.000056</td>
      <td>0.012138</td>
      <td>...</td>
      <td>-0.000123</td>
      <td>-0.005349</td>
      <td>0</td>
      <td>-0.000297</td>
      <td>-0.000651</td>
      <td>3.142690e-04</td>
      <td>-0.001412</td>
      <td>-0.001735</td>
      <td>1.581395e-03</td>
      <td>-0.000683</td>
    </tr>
  </tbody>
</table>
<p>10 rows × 25 columns</p>
</div></div></div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./act_0/act_0_0/act_0_0_7"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">1</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">2</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">3</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sources">3.1 sources</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#packages">3.2 packages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#variables">3.3 variables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table1">3.4 table1</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#datasets">3.5 datasets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#time-to-event">3.6 time-to-event</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#kaplan-meier">3.7 kaplan-meier</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cox-model">3.8 cox model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fig1">3.9 fig1</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fig2">3.10 fig2</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">3.11 time-to-event</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">3.12 kaplan-meier</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">3.13 cox model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">3.14 fig1</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fig3">3.15 fig3</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fig4">3.16 fig4</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fig4-kaplan-meier">3.17 fig4 kaplan-meier</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lincom">3.18 lincom</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hr-95-ci">3.19 hr, 95%ci</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">3.20 kaplan-meier</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#coef-matrix">3.21 coef matrix</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#var-cov-matrix">3.22 var-cov matrix</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Abimereki Muzaale, Vincent Jin, and JHU TRC
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>