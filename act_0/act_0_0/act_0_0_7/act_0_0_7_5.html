

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>&lt;no title&gt; &#8212; Challenges, Skills, and Opportunities</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'act_0/act_0_0/act_0_0_7/act_0_0_7_5';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="https://raw.githubusercontent.com/jhutrc/jhutrc.github.io/main/png/hub_and_spoke.jpg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="https://raw.githubusercontent.com/jhutrc/jhutrc.github.io/main/png/hub_and_spoke.jpg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../intro.html">
                    Welcome to Fena
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Challenges</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../act_1/act_1_0/act_1_0_0/act_1_0_0_1.html">1. Rigor</a></li>




<li class="toctree-l1"><a class="reference internal" href="../../../act_1/act_1_0/act_1_0_0/act_1_0_0_2.html">2. Error</a></li>




<li class="toctree-l1"><a class="reference internal" href="../../../act_1/act_1_0/act_1_0_0/act_1_0_0_3.html">3. Sloppiness</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Project</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../act_1/act_1_0/act_1_0_1/act_1_0_1_1.html">4. Manuscripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_1/act_1_0/act_1_0_1/act_1_0_1_2.html">5. Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_1/act_1_0/act_1_0_1/act_1_0_1_3.html">6. Git</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Numeracy</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../act_2/act_2_2/act_2_2_0/act_2_2_0_1.html">7. Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_2/act_2_2/act_2_2_0/act_2_2_0_2.html">8. R</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_2/act_2_2/act_2_2_0/act_2_2_0_3.html">9. Stata</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Literacy</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../act_3/act_3_0/act_3_0_0/act_3_0_0_1.html">10. Open Science</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_3/act_3_0/act_3_0_0/act_3_0_0_2.html">11. Self-Publishing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_3/act_3_0/act_3_0_0/act_3_0_0_3.html">12. Grants</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Workflow</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../act_3/act_3_1/act_3_1_0/act_3_1_0_1.html">13. Automate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_3/act_3_1/act_3_1_0/act_3_1_0_2.html">14. Bash</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../act_3/act_3_1/act_3_1_0/act_3_1_0_3.html">15. Unix</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../act_3/act_3_1/act_3_1_1/act_3_1_1_1.html"></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../act_3/act_3_1/act_3_1_1/act_3_1_1_2.html"></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../act_3/act_3_1/act_3_1_1/act_3_1_1_3.html"></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../act_3/act_3_2/act_3_2_0/act_3_2_0_1.html"></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../act_3/act_3_2/act_3_2_0/act_3_2_0_2.html"></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../act_3/act_3_2/act_3_2_0/act_3_2_0_3.html"></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../act_3/act_3_2/act_3_2_1/act_3_2_1_1.html"></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../act_3/act_3_2/act_3_2_1/act_3_2_1_2.html"></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../act_3/act_3_2/act_3_2_1/act_3_2_1_3.html"></a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/act_0/act_0_0/act_0_0_7/act_0_0_7_5.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1><no title></h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="simple visible nav section-nav flex-column">
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Header</span>

<span class="n">header</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Description&quot;</span><span class="p">,</span> <span class="s2">&quot;N=35256&quot;</span><span class="p">,</span> <span class="s2">&quot;N=38282&quot;</span><span class="p">)</span>
<span class="n">rows</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1"># ... as above ...</span>
    <span class="p">(</span><span class="s2">&quot;Age, y, median [IQR]&quot;</span><span class="p">,</span> <span class="s2">&quot;46 [31,64]&quot;</span><span class="p">,</span> <span class="s2">&quot;45 [30,63]&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;SBP, mmHg, median [IQR]&quot;</span><span class="p">,</span> <span class="s2">&quot;124 [114,135]&quot;</span><span class="p">,</span> <span class="s2">&quot;118 [108,134]&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;DBP, mmHg, median [IQR]&quot;</span><span class="p">,</span> <span class="s2">&quot;73 [65,80]&quot;</span><span class="p">,</span> <span class="s2">&quot;70 [62,76]&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Serum Creatinine, mg/dL, median [IAR]&quot;</span><span class="p">,</span> <span class="s2">&quot;1 [1,1]&quot;</span><span class="p">,</span> <span class="s2">&quot;1 [1,1]&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;eGFR, ml/min/1.73m2, median [IAR]&quot;</span><span class="p">,</span> <span class="s2">&quot;96 [79,112]&quot;</span><span class="p">,</span> <span class="s2">&quot;118 [99,135]&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;BMI, kg/m2, median [IQR]&quot;</span><span class="p">,</span> <span class="s2">&quot;27 [24,31]&quot;</span><span class="p">,</span> <span class="s2">&quot;28 [23,33]&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;HBA1c, %, median [IQR]&quot;</span><span class="p">,</span> <span class="s2">&quot;6 [5,6]&quot;</span><span class="p">,</span> <span class="s2">&quot;5 [5,6]&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;uACR, mg/g, median [IQR]&quot;</span><span class="p">,</span> <span class="s2">&quot;6 [4,12]&quot;</span><span class="p">,</span> <span class="s2">&quot;8 [5,15]&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Log uACR, log(mg/g), median [IQR]&quot;</span><span class="p">,</span> <span class="s2">&quot;2 [1,2]&quot;</span><span class="p">,</span> <span class="s2">&quot;2 [2,3]&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Glucose, mg/L, median [IQR]&quot;</span><span class="p">,</span> <span class="s2">&quot;9 [9,10]&quot;</span><span class="p">,</span> <span class="s2">&quot;9 [8,10]&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Income, $, median [IQR]&quot;</span><span class="p">,</span> <span class="s2">&quot;23771 [8479,45024]&quot;</span><span class="p">,</span> <span class="s2">&quot;22076 [8001,43148]&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Diabetes, %&quot;</span><span class="p">,</span> <span class="s2">&quot;12&quot;</span><span class="p">,</span> <span class="s2">&quot;12&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Hypertension, %&quot;</span><span class="p">,</span> <span class="s2">&quot;31&quot;</span><span class="p">,</span> <span class="s2">&quot;32&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Smoke, %&quot;</span><span class="p">,</span> <span class="s2">&quot;57&quot;</span><span class="p">,</span> <span class="s2">&quot;36&quot;</span><span class="p">),</span>
    <span class="c1"># Adding additional characteristics as requested</span>
    <span class="p">(</span><span class="s2">&quot;Race, White&quot;</span><span class="p">,</span> <span class="s2">&quot;43&quot;</span><span class="p">,</span> <span class="s2">&quot;42&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Race, Black&quot;</span><span class="p">,</span> <span class="s2">&quot;23&quot;</span><span class="p">,</span> <span class="s2">&quot;24&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Race, Hispanic&quot;</span><span class="p">,</span> <span class="s2">&quot;26&quot;</span><span class="p">,</span> <span class="s2">&quot;27&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Race, Other&quot;</span><span class="p">,</span> <span class="s2">&quot;8&quot;</span><span class="p">,</span> <span class="s2">&quot;8&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Race2, White&quot;</span><span class="p">,</span> <span class="s2">&quot;37&quot;</span><span class="p">,</span> <span class="s2">&quot;35&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Race2, Black&quot;</span><span class="p">,</span> <span class="s2">&quot;23&quot;</span><span class="p">,</span> <span class="s2">&quot;23&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Race2, Hispanic&quot;</span><span class="p">,</span> <span class="s2">&quot;23&quot;</span><span class="p">,</span> <span class="s2">&quot;25&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Race2, Asian&quot;</span><span class="p">,</span> <span class="s2">&quot;13&quot;</span><span class="p">,</span> <span class="s2">&quot;13&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Race2, Other&quot;</span><span class="p">,</span> <span class="s2">&quot;4&quot;</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Educ, K-8&quot;</span><span class="p">,</span> <span class="s2">&quot;16&quot;</span><span class="p">,</span> <span class="s2">&quot;14&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Educ, High school, Diploma/equivalent&quot;</span><span class="p">,</span> <span class="s2">&quot;42&quot;</span><span class="p">,</span> <span class="s2">&quot;42&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Educ, Some college/associate&quot;</span><span class="p">,</span> <span class="s2">&quot;22&quot;</span><span class="p">,</span> <span class="s2">&quot;25&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Educ, College graduate/above&quot;</span><span class="p">,</span> <span class="s2">&quot;20&quot;</span><span class="p">,</span> <span class="s2">&quot;18&quot;</span><span class="p">),</span>
    <span class="c1"># Adding Years</span>
    <span class="p">(</span><span class="s2">&quot;Year, 1988-1998&quot;</span><span class="p">,</span> <span class="s2">&quot;23&quot;</span><span class="p">,</span> <span class="s2">&quot;24&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Year, 1999-2000&quot;</span><span class="p">,</span> <span class="s2">&quot;7&quot;</span><span class="p">,</span> <span class="s2">&quot;7&quot;</span><span class="p">),</span>
    <span class="c1"># Add more years as needed...</span>
<span class="p">]</span>


<span class="c1"># Customize the width of each column (in percentage or pixels, e.g., &quot;20%&quot;, &quot;100px&quot;)</span>
<span class="n">col1_width</span> <span class="o">=</span> <span class="s2">&quot;40%&quot;</span>
<span class="n">col2_width</span> <span class="o">=</span> <span class="s2">&quot;30%&quot;</span>
<span class="n">col3_width</span> <span class="o">=</span> <span class="s2">&quot;30%&quot;</span>

<span class="n">html_output</span> <span class="o">=</span> <span class="s1">&#39;&lt;table style=&quot;width: 100%;&quot;&gt;&#39;</span>
<span class="n">html_output</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;th style=&quot;text-align: left; width: </span><span class="si">{}</span><span class="s1">; padding: 5px;&quot;&gt;</span><span class="si">{}</span><span class="s1">&lt;/th&gt;&lt;th style=&quot;text-align: center; width: </span><span class="si">{}</span><span class="s1">; padding: 5px;&quot;&gt;</span><span class="si">{}</span><span class="s1">&lt;/th&gt;&lt;th style=&quot;text-align: center; width: </span><span class="si">{}</span><span class="s1">; padding: 5px;&quot;&gt;</span><span class="si">{}</span><span class="s1">&lt;/th&gt;&lt;/tr&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">col1_width</span><span class="p">,</span> <span class="n">header</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">col2_width</span><span class="p">,</span> <span class="n">header</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">col3_width</span><span class="p">,</span> <span class="n">header</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

<span class="n">current_category</span> <span class="o">=</span> <span class="kc">None</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
    <span class="n">description</span><span class="p">,</span> <span class="n">value1</span><span class="p">,</span> <span class="n">value2</span> <span class="o">=</span> <span class="n">row</span>
    <span class="n">style_col1</span> <span class="o">=</span> <span class="s1">&#39;style=&quot;text-align: left; width: </span><span class="si">{}</span><span class="s1">; padding: 5px;&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">col1_width</span><span class="p">)</span>
    <span class="n">style_col2</span> <span class="o">=</span> <span class="s1">&#39;style=&quot;text-align: center; width: </span><span class="si">{}</span><span class="s1">; padding: 5px;&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">col2_width</span><span class="p">)</span>
    <span class="n">style_col3</span> <span class="o">=</span> <span class="s1">&#39;style=&quot;text-align: center; width: </span><span class="si">{}</span><span class="s1">; padding: 5px;&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">col3_width</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">description</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Race&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">description</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Educ&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">description</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Year&quot;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">description</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">current_category</span><span class="p">:</span>
            <span class="n">current_category</span> <span class="o">=</span> <span class="n">description</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">html_output</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;td </span><span class="si">{}</span><span class="s1">&gt;&lt;b&gt;</span><span class="si">{}</span><span class="s1">&lt;/b&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">style_col1</span><span class="p">,</span> <span class="n">current_category</span><span class="p">)</span>
        <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;&amp;nbsp;&amp;nbsp;&amp;nbsp;&quot;</span> <span class="o">+</span> <span class="n">description</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="n">html_output</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;td </span><span class="si">{}</span><span class="s1">&gt;</span><span class="si">{}</span><span class="s1">&lt;/td&gt;&lt;td </span><span class="si">{}</span><span class="s1">&gt;</span><span class="si">{}</span><span class="s1">&lt;/td&gt;&lt;td </span><span class="si">{}</span><span class="s1">&gt;</span><span class="si">{}</span><span class="s1">&lt;/td&gt;&lt;/tr&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">style_col1</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">style_col2</span><span class="p">,</span> <span class="n">value1</span><span class="p">,</span> <span class="n">style_col3</span><span class="p">,</span> <span class="n">value2</span><span class="p">)</span>

<span class="n">html_output</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/table&gt;&#39;</span>

<span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">HTML</span>
<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="n">html_output</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><table style="width: 100%;"><tr><th style="text-align: left; width: 40%; padding: 5px;">Description</th><th style="text-align: center; width: 30%; padding: 5px;">N=35256</th><th style="text-align: center; width: 30%; padding: 5px;">N=38282</th></tr><tr><td style="text-align: left; width: 40%; padding: 5px;">Age, y, median [IQR]</td><td style="text-align: center; width: 30%; padding: 5px;">46 [31,64]</td><td style="text-align: center; width: 30%; padding: 5px;">45 [30,63]</td></tr><tr><td style="text-align: left; width: 40%; padding: 5px;">SBP, mmHg, median [IQR]</td><td style="text-align: center; width: 30%; padding: 5px;">124 [114,135]</td><td style="text-align: center; width: 30%; padding: 5px;">118 [108,134]</td></tr><tr><td style="text-align: left; width: 40%; padding: 5px;">DBP, mmHg, median [IQR]</td><td style="text-align: center; width: 30%; padding: 5px;">73 [65,80]</td><td style="text-align: center; width: 30%; padding: 5px;">70 [62,76]</td></tr><tr><td style="text-align: left; width: 40%; padding: 5px;">Serum Creatinine, mg/dL, median [IAR]</td><td style="text-align: center; width: 30%; padding: 5px;">1 [1,1]</td><td style="text-align: center; width: 30%; padding: 5px;">1 [1,1]</td></tr><tr><td style="text-align: left; width: 40%; padding: 5px;">eGFR, ml/min/1.73m2, median [IAR]</td><td style="text-align: center; width: 30%; padding: 5px;">96 [79,112]</td><td style="text-align: center; width: 30%; padding: 5px;">118 [99,135]</td></tr><tr><td style="text-align: left; width: 40%; padding: 5px;">BMI, kg/m2, median [IQR]</td><td style="text-align: center; width: 30%; padding: 5px;">27 [24,31]</td><td style="text-align: center; width: 30%; padding: 5px;">28 [23,33]</td></tr><tr><td style="text-align: left; width: 40%; padding: 5px;">HBA1c, %, median [IQR]</td><td style="text-align: center; width: 30%; padding: 5px;">6 [5,6]</td><td style="text-align: center; width: 30%; padding: 5px;">5 [5,6]</td></tr><tr><td style="text-align: left; width: 40%; padding: 5px;">uACR, mg/g, median [IQR]</td><td style="text-align: center; width: 30%; padding: 5px;">6 [4,12]</td><td style="text-align: center; width: 30%; padding: 5px;">8 [5,15]</td></tr><tr><td style="text-align: left; width: 40%; padding: 5px;">Log uACR, log(mg/g), median [IQR]</td><td style="text-align: center; width: 30%; padding: 5px;">2 [1,2]</td><td style="text-align: center; width: 30%; padding: 5px;">2 [2,3]</td></tr><tr><td style="text-align: left; width: 40%; padding: 5px;">Glucose, mg/L, median [IQR]</td><td style="text-align: center; width: 30%; padding: 5px;">9 [9,10]</td><td style="text-align: center; width: 30%; padding: 5px;">9 [8,10]</td></tr><tr><td style="text-align: left; width: 40%; padding: 5px;">Income, $, median [IQR]</td><td style="text-align: center; width: 30%; padding: 5px;">23771 [8479,45024]</td><td style="text-align: center; width: 30%; padding: 5px;">22076 [8001,43148]</td></tr><tr><td style="text-align: left; width: 40%; padding: 5px;">Diabetes, %</td><td style="text-align: center; width: 30%; padding: 5px;">12</td><td style="text-align: center; width: 30%; padding: 5px;">12</td></tr><tr><td style="text-align: left; width: 40%; padding: 5px;">Hypertension, %</td><td style="text-align: center; width: 30%; padding: 5px;">31</td><td style="text-align: center; width: 30%; padding: 5px;">32</td></tr><tr><td style="text-align: left; width: 40%; padding: 5px;">Smoke, %</td><td style="text-align: center; width: 30%; padding: 5px;">57</td><td style="text-align: center; width: 30%; padding: 5px;">36</td></tr><tr><td style="text-align: left; width: 40%; padding: 5px;"><b>Race</b></td><td></td><td></td></tr><tr><td style="text-align: left; width: 40%; padding: 5px;">&nbsp;&nbsp;&nbsp; White</td><td style="text-align: center; width: 30%; padding: 5px;">43</td><td style="text-align: center; width: 30%; padding: 5px;">42</td></tr><tr><td style="text-align: left; width: 40%; padding: 5px;">&nbsp;&nbsp;&nbsp; Black</td><td style="text-align: center; width: 30%; padding: 5px;">23</td><td style="text-align: center; width: 30%; padding: 5px;">24</td></tr><tr><td style="text-align: left; width: 40%; padding: 5px;">&nbsp;&nbsp;&nbsp; Hispanic</td><td style="text-align: center; width: 30%; padding: 5px;">26</td><td style="text-align: center; width: 30%; padding: 5px;">27</td></tr><tr><td style="text-align: left; width: 40%; padding: 5px;">&nbsp;&nbsp;&nbsp; Other</td><td style="text-align: center; width: 30%; padding: 5px;">8</td><td style="text-align: center; width: 30%; padding: 5px;">8</td></tr><tr><td style="text-align: left; width: 40%; padding: 5px;"><b>Race2</b></td><td></td><td></td></tr><tr><td style="text-align: left; width: 40%; padding: 5px;">&nbsp;&nbsp;&nbsp; White</td><td style="text-align: center; width: 30%; padding: 5px;">37</td><td style="text-align: center; width: 30%; padding: 5px;">35</td></tr><tr><td style="text-align: left; width: 40%; padding: 5px;">&nbsp;&nbsp;&nbsp; Black</td><td style="text-align: center; width: 30%; padding: 5px;">23</td><td style="text-align: center; width: 30%; padding: 5px;">23</td></tr><tr><td style="text-align: left; width: 40%; padding: 5px;">&nbsp;&nbsp;&nbsp; Hispanic</td><td style="text-align: center; width: 30%; padding: 5px;">23</td><td style="text-align: center; width: 30%; padding: 5px;">25</td></tr><tr><td style="text-align: left; width: 40%; padding: 5px;">&nbsp;&nbsp;&nbsp; Asian</td><td style="text-align: center; width: 30%; padding: 5px;">13</td><td style="text-align: center; width: 30%; padding: 5px;">13</td></tr><tr><td style="text-align: left; width: 40%; padding: 5px;">&nbsp;&nbsp;&nbsp; Other</td><td style="text-align: center; width: 30%; padding: 5px;">4</td><td style="text-align: center; width: 30%; padding: 5px;">3</td></tr><tr><td style="text-align: left; width: 40%; padding: 5px;"><b>Educ</b></td><td></td><td></td></tr><tr><td style="text-align: left; width: 40%; padding: 5px;">&nbsp;&nbsp;&nbsp; K-8</td><td style="text-align: center; width: 30%; padding: 5px;">16</td><td style="text-align: center; width: 30%; padding: 5px;">14</td></tr><tr><td style="text-align: left; width: 40%; padding: 5px;">&nbsp;&nbsp;&nbsp; High school</td><td style="text-align: center; width: 30%; padding: 5px;">42</td><td style="text-align: center; width: 30%; padding: 5px;">42</td></tr><tr><td style="text-align: left; width: 40%; padding: 5px;">&nbsp;&nbsp;&nbsp; Some college/associate</td><td style="text-align: center; width: 30%; padding: 5px;">22</td><td style="text-align: center; width: 30%; padding: 5px;">25</td></tr><tr><td style="text-align: left; width: 40%; padding: 5px;">&nbsp;&nbsp;&nbsp; College graduate/above</td><td style="text-align: center; width: 30%; padding: 5px;">20</td><td style="text-align: center; width: 30%; padding: 5px;">18</td></tr><tr><td style="text-align: left; width: 40%; padding: 5px;"><b>Year</b></td><td></td><td></td></tr><tr><td style="text-align: left; width: 40%; padding: 5px;">&nbsp;&nbsp;&nbsp; 1988-1998</td><td style="text-align: center; width: 30%; padding: 5px;">23</td><td style="text-align: center; width: 30%; padding: 5px;">24</td></tr><tr><td style="text-align: left; width: 40%; padding: 5px;">&nbsp;&nbsp;&nbsp; 1999-2000</td><td style="text-align: center; width: 30%; padding: 5px;">7</td><td style="text-align: center; width: 30%; padding: 5px;">7</td></tr></table></div></div>
</div>
<p>NHANES</p>
<ol class="arabic simple">
<li><p>01_nhdemo_final.do</p></li>
</ol>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span>cls

<span class="c1">*! demographics</span>
<span class="c1">*! essence: #41  </span>

<span class="k">quietly</span> {

<span class="k">     capture log close</span>
<span class="k">     global</span> date:<span class="k"> di</span> <span class="nx">%td</span> <span class="nf">date</span>(<span class="nf">c</span>(current_date),<span class="s">&quot;DMY&quot;</span>)
<span class="k">     quietly log</span> using <span class="s">&quot;03_nhdemo</span><span class="vg">$date</span><span class="s">.log&quot;</span>,<span class="k"> replace</span>
<span class="k">     version</span> <span class="m">12</span>

<span class="k">     global</span> nh3 https:<span class="o">//</span>wwwn<span class="m">.</span>cdc<span class="m">.</span>gov<span class="o">/</span>nchs<span class="o">/</span>data<span class="o">/</span>nhanes3<span class="o">/</span>1a<span class="o">/</span>
<span class="k">     global</span> start = <span class="nf">clock</span>(<span class="nf">c</span>(current_time),<span class="s">&quot;hms&quot;</span>)<span class="o">/</span><span class="m">10</span><span class="o">^</span><span class="m">3</span>

	
	 <span class="c1">//1988-1994</span>
<span class="k">	     noi di</span> <span class="s">&quot;loading... 1988-1994 from </span><span class="vg">$nh3</span><span class="s">&quot;</span>
<span class="k">     infix</span> seqn <span class="m">1-5</span> dmpstat <span class="m">11</span> dmarethn <span class="m">12</span> dmaethnr <span class="m">14</span> hssex <span class="m">15</span> hsageir	<span class="m">18-19</span> <span class="cs">///</span>
	     hfa8r <span class="m">1256-1257</span> hff19r <span class="m">1409-1410</span> sdpphase <span class="m">42</span> using <span class="vg">${nh3}</span>adult<span class="m">.</span>DAT,<span class="k"> clear</span>
<span class="k">	 tempfile</span> surv1
<span class="k">	 gen</span> surv=<span class="m">1</span>
<span class="k">     save</span> <span class="nv">`surv1&#39;</span> 

     <span class="c1">//1999-2017</span>
<span class="k">     global</span> nhanes <span class="s">&quot;https://wwwn.cdc.gov/Nchs/Nhanes&quot;</span>  
<span class="k">     tokenize</span> <span class="s">&quot;</span><span class="nv">`c(ALPHA)&#39;</span><span class="s">&quot;</span> <span class="c1">//i.e., &quot;`2&#39;&quot; -&gt; B, &quot;`3&#39;&quot; -&gt; C, etc.</span>
<span class="k">	 local</span> Letter=<span class="m">1</span> <span class="c1">//tokens: B-J</span>
<span class="k">     local</span> N=<span class="m">2</span> <span class="c1">//surveys: 1999-2017   </span>
<span class="k">	 </span>
<span class="k">	 foreach</span> y of<span class="k"> numlist</span> <span class="m">1999</span> <span class="m">2001</span> <span class="m">2003</span> <span class="m">2005</span> <span class="m">2007</span> <span class="m">2009</span> <span class="m">2011</span> <span class="m">2013</span> <span class="m">2015</span> <span class="m">2017</span> {  
<span class="k">	 	</span>
<span class="k">         local</span> yplus1=<span class="nv">`y&#39;</span> <span class="o">+</span> <span class="m">1</span>  
<span class="k">		 if</span> <span class="nv">`y&#39;</span><span class="o">==</span><span class="m">1999</span> {
<span class="k">		 	 local</span> letter:<span class="k"> di</span> <span class="s">&quot;&quot;</span>
		 }
<span class="k">		 if</span> <span class="nv">`y&#39;</span> <span class="o">&gt;</span><span class="m">2000</span> {
<span class="k">		     local</span> letter:<span class="k"> di</span> <span class="s">&quot;_</span><span class="nv">``Letter&#39;&#39;</span><span class="s">&quot;</span>  
		 }
		 
         import sasxport5 <span class="s">&quot;</span><span class="vg">$nhanes</span><span class="s">/</span><span class="nv">`y&#39;</span><span class="s">-</span><span class="nv">`yplus1&#39;</span><span class="s">/DEMO</span><span class="nv">`letter&#39;</span><span class="s">.XPT&quot;</span>,<span class="k"> clear</span>   
<span class="k">	     noi di</span> <span class="s">&quot;loading... </span><span class="nv">`y&#39;</span><span class="s">-</span><span class="nv">`yplus1&#39;</span><span class="s"> from </span><span class="vg">$nhanes</span><span class="s">&quot;</span>
<span class="k">	     tempfile</span> surv<span class="nv">`N&#39;</span>
<span class="k">		 gen</span> surv=<span class="nv">`N&#39;</span>
<span class="k">         save</span> <span class="nv">`surv`N&#39;&#39;</span> 
<span class="k">	     local</span> N=<span class="nv">`N&#39;</span> <span class="o">+</span> <span class="m">1</span>
<span class="k">	     local</span> Letter=<span class="nv">`Letter&#39;</span> <span class="o">+</span> <span class="m">1</span>

     }
<span class="k">	 </span>
<span class="k">	 clear</span>
<span class="k">	 noi di</span> <span class="s">&quot;...&quot;</span>
<span class="k">	 noi di</span> <span class="s">&quot;LOADED!&quot;</span>
<span class="k">     forvalues</span> i=<span class="m">1</span><span class="o">/</span><span class="m">11</span> {
<span class="k">	 	 append</span> using <span class="nv">`surv`i&#39;&#39;</span>
     }

<span class="k">	 compress</span>
<span class="k">	 local sample</span>=<span class="m">100</span>
<span class="k">	 sample</span> <span class="nv">`sample&#39;</span>
<span class="k">     lab</span> dat <span class="s">&quot;</span><span class="nv">`sample&#39;</span><span class="s">% of NHANES 1988-2018, Demographics&quot;</span>
<span class="k">     save</span> <span class="s">&quot;02_nhdemo</span><span class="vg">$date</span><span class="s">&quot;</span>,<span class="k"> replace</span> 
<span class="k">	 noi di</span> <span class="s">&quot;&quot;</span>
<span class="k">	 noi di</span> <span class="s">&quot;&quot;</span>
<span class="k">	 noi di</span> <span class="s">&quot;02_nhdemo</span><span class="vg">$date</span><span class="s">.dta saved to &quot;</span> <span class="nf">word</span>(<span class="s">&quot;</span><span class="nv">`c(pwd)&#39;</span><span class="s">&quot;</span>,<span class="m">1</span>)
     
	 <span class="c1">//big data!</span>
<span class="k">	 noi di</span> <span class="s">&quot;&quot;</span>
<span class="k">	 noi di</span> <span class="s">&quot;rows x columns:&quot;</span>
<span class="k">	 noi count</span>
<span class="k">	 ds</span> 
<span class="k">	 noi di</span> <span class="nf">wordcount</span>(<span class="nf">r</span>(varlist))
<span class="k">	 </span>
<span class="k">     global</span> finish  = <span class="nf">clock</span>(<span class="nf">c</span>(current_time),<span class="s">&quot;hms&quot;</span>)<span class="o">/</span><span class="m">10</span><span class="o">^</span><span class="m">3</span>
<span class="k">     global</span> duration = <span class="nf">round</span>((<span class="vg">$finish</span> <span class="o">-</span> <span class="vg">$start</span>)<span class="o">/</span><span class="m">60</span>,<span class="m">1</span>)

<span class="k">     noi di</span> <span class="s">&quot;runtime = </span><span class="vg">$duration</span><span class="s"> minute(s)&quot;</span>
<span class="k">     log close</span>

}
</pre></div>
</div>
<hr class="docutils" />
<ol class="arabic simple" start="2">
<li><p>04_nhexam_final.do</p></li>
</ol>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span>cls

<span class="c1">*! assemble datasets</span>
<span class="c1">*! exam, lab, q&amp;a </span>
<span class="c1">*! do so for all nh surveys</span>

<span class="k">quietly</span> {
<span class="k">	</span>
<span class="k">     capture log close</span>
<span class="k">     global</span> date:<span class="k"> di</span> <span class="nx">%td</span> <span class="nf">date</span>(<span class="nf">c</span>(current_date),<span class="s">&quot;DMY&quot;</span>)
<span class="k">     log</span> using <span class="s">&quot;06_nhexam</span><span class="vg">$date</span><span class="s">.log&quot;</span>,<span class="k"> replace</span>
<span class="k">     version</span> <span class="m">12</span> 

<span class="k">     global</span> nh3 https:<span class="o">//</span>wwwn<span class="m">.</span>cdc<span class="m">.</span>gov<span class="o">/</span>nchs<span class="o">/</span>data<span class="o">/</span>nhanes3<span class="o">/</span>1a<span class="o">/</span>
<span class="k">     global</span> nhanes <span class="s">&quot;https://wwwn.cdc.gov/Nchs/Nhanes&quot;</span> 
<span class="k">     global</span> start = <span class="nf">clock</span>(<span class="nf">c</span>(current_time),<span class="s">&quot;hms&quot;</span>)<span class="o">/</span><span class="m">10</span><span class="o">^</span><span class="m">3</span>
	
	 
     <span class="c1">//1988-1994</span>
<span class="k">	 noi di</span> <span class="s">&quot;processing... 1988-1994/EXAM.DAT&quot;</span> 
<span class="k">     infix</span> seqn <span class="m">1-5</span> pepmnk1r <span class="m">1423-1425</span> pepmnk5r <span class="m">1428-1430</span> bmpbmi <span class="m">1524-1527</span> <span class="cs">/// </span>
	     using <span class="vg">${nh3}</span>exam<span class="m">.</span>dat,<span class="k"> clear</span>
<span class="k">     tempfile</span> exam
<span class="k">     save</span> <span class="nv">`exam&#39;</span>

<span class="k">	 noi di</span> <span class="s">&quot;processing... 1988-1994/LAB.DAT&quot;</span> 
<span class="k">	 infix</span> seqn <span class="m">1-5</span> ghp <span class="m">1861-1864</span> ubp <span class="m">1965-1970</span> urp <span class="m">1956-1960</span> sgpsi <span class="m">1761-1765</span> <span class="cs">/// </span>
		 cep <span class="m">1784-1787</span> using <span class="vg">${nh3}</span>lab<span class="m">.</span>dat,<span class="k"> clear</span>
<span class="k">     tempfile lab</span>
<span class="k">     save</span> <span class="nv">`lab&#39;</span>
<span class="k">	 </span>
<span class="k">	 noi di</span> <span class="s">&quot;processing... 1988-1994/ADULT.DAT&quot;</span> 
<span class="k">     infix</span> seqn <span class="m">1-5</span> hae4d2 <span class="m">1605</span> had1 <span class="m">1561</span> had6 <span class="m">1568</span> had10 <span class="m">1578</span> hak1 <span class="m">1855</span> <span class="cs">/// </span>
	     hae2 <span class="m">1598</span> hae5a <span class="m">1610</span> hat1met <span class="m">2393-2395</span> har1 <span class="m">2281</span> <span class="cs">///</span>
		 using <span class="vg">${nh3}</span>adult<span class="m">.</span>DAT,<span class="k"> clear</span>
<span class="k">		 </span>
<span class="k">     tempfile</span> qa 
<span class="k">     save</span> <span class="nv">`qa&#39;</span>  
<span class="k">	 </span>
<span class="k">     use</span> <span class="nv">`exam&#39;</span>,<span class="k"> clear</span> 
<span class="k">     merge</span> <span class="m">1</span>:<span class="m">1</span> seqn using <span class="nv">`lab&#39;</span>, nogen
<span class="k">     merge</span> <span class="m">1</span>:<span class="m">1</span> seqn using <span class="nv">`qa&#39;</span>, nogen 
<span class="k">	 	 </span>
<span class="k">     gen</span> surv=<span class="m">1</span>
<span class="k">	 tempfile</span> exam_0
<span class="k">     save</span> <span class="nv">`exam_0&#39;</span> 
	 
	 <span class="c1">//1999-2018</span>
<span class="k">	 tokenize</span> <span class="s">&quot;</span><span class="nv">`c(ALPHA)&#39;</span><span class="s">&quot;</span> <span class="c1">//i.e., &quot;`2&#39;&quot; -&gt; B, &quot;`3&#39;&quot; -&gt; C, etc.</span>
<span class="k">     local</span> surv=<span class="m">2</span>
<span class="k">	 </span>
<span class="k">	 local</span> y=<span class="m">1999</span>
<span class="k">	 </span>
<span class="k">	 forvalues</span> i=<span class="m">1</span><span class="o">/</span><span class="m">10</span>  { <span class="c1">//nhanes survey</span>
<span class="k">	 	</span>
<span class="k">		 local</span> yp1=<span class="nv">`y&#39;</span><span class="o">+</span><span class="m">1</span>
<span class="k">		 </span>
<span class="k">  		 forvalues</span> j=<span class="m">1</span><span class="o">/</span><span class="m">11</span> { <span class="c1">//specific datafile</span>
<span class="k">	     </span>
<span class="k">		 local</span> DATA1 BPX BMX LAB10 LAB16  LAB18  ALQ DIQ KIQ   BPQ PAQ SMQ  	
<span class="k">         local</span> DATA2 BPX BMX L10   L16    L40    ALQ DIQ KIQ_U BPQ PAQ SMQ 
<span class="k">         local</span> DATA3 BPX BMX GHB   ALB_CR BIOPRO ALQ DIQ KIQ_U BPQ PAQ SMQ 
<span class="k">		 </span>
<span class="k">		 if</span> <span class="nv">`i&#39;</span><span class="o">==</span><span class="m">1</span> {
<span class="k">		 	 local</span> letter:<span class="k"> di</span> <span class="s">&quot;&quot;</span> 
<span class="k">			 local</span> DATA <span class="nv">`DATA1&#39;</span>
		 }
<span class="k">		 if</span> <span class="nf">inlist</span>(<span class="nv">`i&#39;</span>, <span class="m">2</span>, <span class="m">3</span>) {
<span class="k">		 	 local</span> letter:<span class="k"> di</span> <span class="s">&quot;_</span><span class="nv">``i&#39;&#39;</span><span class="s">&quot;</span>  
<span class="k">			 local</span> DATA <span class="nv">`DATA2&#39;</span>
		 }
<span class="k">		 if</span> <span class="nf">inrange</span>(<span class="nv">`i&#39;</span>, <span class="m">4</span>,<span class="m">11</span>) {
<span class="k">		 	 local</span> letter:<span class="k"> di</span> <span class="s">&quot;_</span><span class="nv">``i&#39;&#39;</span><span class="s">&quot;</span>
<span class="k">			 local</span> DATA <span class="nv">`DATA3&#39;</span>
		 }
<span class="k">		 </span>
<span class="k">		 local</span> DATA:<span class="k"> di</span> <span class="nf">word</span>(<span class="s">&quot;</span><span class="nv">`DATA&#39;</span><span class="s">&quot;</span>,<span class="nv">`j&#39;</span>) 	<span class="c1">//jth datafile </span>
	     import sasxport5 <span class="s">&quot;</span><span class="vg">$nhanes</span><span class="s">/</span><span class="nv">`y&#39;</span><span class="s">-</span><span class="nv">`yp1&#39;</span><span class="s">/</span><span class="nv">`DATA&#39;`letter&#39;</span><span class="s">.XPT&quot;</span>,<span class="k"> clear</span>  
<span class="k">		 noi di</span> <span class="s">&quot;processing... </span><span class="nv">`y&#39;</span><span class="s">-</span><span class="nv">`yp1&#39;</span><span class="s">/</span><span class="nv">`DATA&#39;`letter&#39;</span><span class="s">.XPT&quot;</span>
<span class="k">         tempfile</span> dat<span class="nv">`j&#39;</span>
<span class="k">         save</span> <span class="nv">`dat`j&#39;&#39;</span> 
	
	     }
<span class="k">   </span>
<span class="k">         use</span> <span class="nv">`dat1&#39;</span>,<span class="k"> clear</span>
<span class="k">         forvalues</span> k=<span class="m">2</span><span class="o">/</span><span class="m">11</span> { <span class="c1">//merge k datafiles from 1 year</span>
<span class="k">             merge</span> <span class="m">1</span>:<span class="m">1</span> seqn using <span class="nv">`dat`k&#39;&#39;</span>,<span class="k"> gen</span>(merge<span class="nv">`k&#39;</span>)
         }

<span class="k">	     gen</span> surv=<span class="nv">`surv&#39;</span>
<span class="k">	     local</span> surv=<span class="nv">`surv&#39;</span><span class="o">+</span><span class="m">1</span>
<span class="k">	 </span>
<span class="k">	     tempfile</span> exam_<span class="nv">`i&#39;</span>
<span class="k">	     save</span> <span class="nv">`exam_`i&#39;&#39;</span> <span class="c1">//one datafile from ith survey </span>
<span class="k">		 local</span> y=<span class="nv">`y&#39;</span><span class="o">+</span><span class="m">2</span> 
		 
     }
<span class="k">	 </span>
<span class="k">	 clear</span>
<span class="k">	 use</span> <span class="nv">`exam_0&#39;</span> <span class="c1">//1988-1994: nhanes 3</span>
<span class="k">     forvalues</span> i=<span class="m">1</span><span class="o">/</span><span class="m">10</span> {
<span class="k">	 append</span> using <span class="nv">`exam_`i&#39;&#39;</span> <span class="c1">//1999-2018: continuous nhanes</span>

     }
<span class="k">	 </span>
<span class="k">     lab</span> dat <span class="s">&quot;NHANES 1988-2018, Q&amp;A/Exam/Labs&quot;</span>
<span class="k">	 lookfor</span> smq
<span class="k">     save</span> <span class="s">&quot;05_nhexam</span><span class="vg">$date</span><span class="s">&quot;</span>,<span class="k"> replace</span>
<span class="k">	 noi di</span> <span class="s">&quot;&quot;</span>
<span class="k">	 noi di</span> <span class="s">&quot;&quot;</span>
<span class="k">	 noi di</span> <span class="s">&quot;05_nhexam</span><span class="vg">$date</span><span class="s">.dta saved to &quot;</span> <span class="nf">word</span>(<span class="s">&quot;</span><span class="nv">`c(pwd)&#39;</span><span class="s">&quot;</span>,<span class="m">1</span>)
	 
	 <span class="c1">//big data!</span>
<span class="k">	 noi di</span> <span class="s">&quot;&quot;</span>
<span class="k">	 noi di</span> <span class="s">&quot;rows x columns:&quot;</span>
<span class="k">	 noi count</span>
<span class="k">	 ds</span> 
<span class="k">	 noi di</span> <span class="nf">wordcount</span>(<span class="nf">r</span>(varlist))
<span class="k">	 </span>
<span class="k">global</span> finish  = <span class="nf">clock</span>(<span class="nf">c</span>(current_time),<span class="s">&quot;hms&quot;</span>)<span class="o">/</span><span class="m">10</span><span class="o">^</span><span class="m">3</span>
<span class="k">global</span> duration = <span class="nf">round</span>((<span class="vg">$finish</span> <span class="o">-</span> <span class="vg">$start</span>)<span class="o">/</span><span class="m">60</span>,<span class="m">1</span>)

<span class="k">noi di</span> <span class="s">&quot;runtime = </span><span class="vg">$duration</span><span class="s"> minute(s)&quot;</span>

<span class="k">log close</span>
	 
}



<span class="c1">*! quietly, loops, indent</span>
<span class="c1">*! collapsing, debugging</span>
<span class="c1">*! this is a pro-tip :)</span>
</pre></div>
</div>
<hr class="docutils" />
<ol class="arabic simple" start="3">
<li><p>07_nhmerge_final.do</p></li>
</ol>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span>cls
<span class="k">macro drop</span> _all

<span class="c1">*! merge nhdemo &amp; nhexam </span>
<span class="c1">*! do not rename variables</span>
<span class="c1">*! and do not apply selection criteria</span>
<span class="c1">*! rename 07_nhtable1.do -&gt; 07_nhmerge.do</span>
<span class="c1">*! move blocks of code that rename &amp; select </span>
<span class="c1">*! to new .do file -&gt; 17_nhtable1.do </span>



<span class="k">quietly</span> {
<span class="k">	</span>
<span class="k">	 capture log close</span>
<span class="k">     global</span> date:<span class="k"> di</span> <span class="nx">%td</span> <span class="nf">date</span>(<span class="nf">c</span>(current_date),<span class="s">&quot;DMY&quot;</span>)
<span class="k">     log</span> using <span class="s">&quot;09_nhmerge</span><span class="vg">$date</span><span class="s">.log&quot;</span>,<span class="k"> replace</span>
<span class="k">     version</span> <span class="m">12</span>
<span class="k">     global</span> start = <span class="nf">clock</span>(<span class="nf">c</span>(current_time),<span class="s">&quot;hms&quot;</span>)<span class="o">/</span><span class="m">10</span><span class="o">^</span><span class="m">3</span> 
	
     <span class="c1">//1.data</span>
<span class="k">	 </span>
<span class="k">     use</span> 05_nhexam<span class="vg">$date</span>,<span class="k"> clear</span>  
<span class="k">	 replace</span> seqn=<span class="o">-</span><span class="m">1</span><span class="o">*</span>seqn<span class="k"> if</span> surv<span class="o">==</span><span class="m">1</span>  <span class="c1">//restore unique seqn across surveys </span>
<span class="k">	 tempfile</span> 05_nhexam  
<span class="k">	 save</span> <span class="nv">`05_nhexam&#39;</span>
<span class="k">	</span>
<span class="k">     use</span> 02_nhdemo<span class="vg">$date</span>,<span class="k"> clear</span>
<span class="k">	 replace</span> seqn=<span class="o">-</span><span class="m">1</span><span class="o">*</span>seqn<span class="k"> if</span> surv<span class="o">==</span><span class="m">1</span>
<span class="k">	 noi merge</span> <span class="m">1</span>:<span class="m">1</span> seqn using <span class="nv">`05_nhexam&#39;</span> <span class="c1">//enforce a strictly 1:1 merge </span>
<span class="k">	 </span>
<span class="k">	 keep if</span> _merge<span class="o">==</span><span class="m">3</span>
	 
	 	 <span class="c1">//survey</span>
<span class="k">	 rename</span> surv survey <span class="c1">//exception to the &quot;no-rename&quot; policy</span>
<span class="k">	 lab var</span> survey <span class="s">&quot;Survey&quot;</span>
<span class="k">	 label</span> define Survey <span class="cs">///</span>
	     <span class="m">1</span> <span class="s">&quot;1988-1994&quot;</span> <span class="cs">///</span>
		 <span class="m">2</span> <span class="s">&quot;1999-2000&quot;</span> <span class="cs">///</span>
		 <span class="m">3</span> <span class="s">&quot;2001-2002&quot;</span> <span class="cs">///</span>
		 <span class="m">4</span> <span class="s">&quot;2003-2004&quot;</span> <span class="cs">///</span>
		 <span class="m">5</span> <span class="s">&quot;2005-2006&quot;</span> <span class="cs">///</span>
		 <span class="m">6</span> <span class="s">&quot;2007-2008&quot;</span> <span class="cs">///</span>
		 <span class="m">7</span> <span class="s">&quot;2009-2010&quot;</span> <span class="cs">///</span>
		 <span class="m">8</span> <span class="s">&quot;2011-2012&quot;</span> <span class="cs">///</span>
		 <span class="m">9</span> <span class="s">&quot;2013-2014&quot;</span> <span class="cs">///</span>
		 <span class="m">10</span> <span class="s">&quot;2015-2016&quot;</span> <span class="cs">///</span>
		 <span class="m">11</span> <span class="s">&quot;2017-2018&quot;</span> 
<span class="k">	 label</span> values survey Survey

}

<span class="k">quietly</span> {
	
	 <span class="c1">//3.keep variables </span>
<span class="k">	     keep</span> seqn dmpstat ridstatr surv <span class="cs">/// id, adult, survey </span>
		      hsageir ridageyr hssex riagendr <span class="cs">/// age, sex </span>
		      dmarethn ridreth1 ridreth3 <span class="cs">/// race-ethnicity </span>
		      hfa8r dmdeduc2 hff19r indhhinc indhhin2 <span class="cs">/// education, income </span>
			  had1 diq010 hae2 bpq020 har1 smq020 kiq020 kiq022 <span class="cs">/// q&amp;a </span>
			  pepmnk1r bpxsar bpxsy1 pepmnk5r bpxdar bpxdi1 bmpbmi bmxbmi <span class="cs">/// exam </span>
			  ghp lbxgh sgpsi lbxsgl ubp urp urxuma urxucr cep lbdscrsi <span class="c1">// lab</span>
<span class="k">     lab</span> dat <span class="s">&quot;NHANES 1988-2018, Demographic &amp; Health Characteristics&quot;</span>
<span class="k">     save</span> <span class="s">&quot;08_nhmerge</span><span class="vg">$date</span><span class="s">&quot;</span>,<span class="k"> replace</span>
	 
}
<span class="k"> 	</span>
<span class="k">	</span>
<span class="k">quietly</span> {
	
		 <span class="c1">//big data!</span>
<span class="k">	 noi di</span> <span class="s">&quot;&quot;</span>
<span class="k">	 noi di</span> <span class="s">&quot;rows x columns:&quot;</span>
<span class="k">	 noi count</span>
<span class="k">	 ds</span> 
<span class="k">	 noi di</span> <span class="nf">wordcount</span>(<span class="nf">r</span>(varlist))
<span class="k">	 </span>
<span class="k">     global</span> finish  = <span class="nf">clock</span>(<span class="nf">c</span>(current_time),<span class="s">&quot;hms&quot;</span>)<span class="o">/</span><span class="m">10</span><span class="o">^</span><span class="m">3</span>
<span class="k">     global</span> duration = <span class="nf">round</span>((<span class="vg">$finish</span> <span class="o">-</span> <span class="vg">$start</span>)<span class="o">/</span><span class="m">60</span>,<span class="m">1</span>)

<span class="k">     noi di</span> <span class="s">&quot;runtime = </span><span class="vg">$duration</span><span class="s"> minute(s)&quot;</span>	

<span class="k">     log close</span>
	
}
</pre></div>
</div>
<hr class="docutils" />
<ol class="arabic simple" start="4">
<li><p>10_nhmort_final.do</p></li>
</ol>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span>cls
<span class="k">clear</span>

<span class="c1">*! mortality linkage</span>
<span class="c1">*! cruxes at lines 35 &amp; 47</span>



<span class="k">quietly</span> {
<span class="k">	</span>
<span class="k">     capture log close</span>
<span class="k">     global</span> date:<span class="k"> di</span> <span class="nx">%td</span> <span class="nf">date</span>(<span class="nf">c</span>(current_date),<span class="s">&quot;DMY&quot;</span>)
<span class="k">     log</span> using <span class="s">&quot;12_nhmort</span><span class="vg">$date</span><span class="s">.log&quot;</span>,<span class="k"> replace</span>
<span class="k">     version</span> <span class="m">12</span>

<span class="k">     global</span> start = <span class="nf">clock</span>(<span class="nf">c</span>(current_time),<span class="s">&quot;hms&quot;</span>)<span class="o">/</span><span class="m">10</span><span class="o">^</span><span class="m">3</span>	

     <span class="c1">//1.data</span>
<span class="k">     global</span> nchs https:<span class="o">//</span>ftp<span class="m">.</span>cdc<span class="m">.</span>gov<span class="o">/</span>pub<span class="o">/</span>Health_Statistics<span class="o">/</span>NCHS<span class="o">/</span>
<span class="k">     global</span> linkage datalinkage<span class="o">/</span>linked_mortality<span class="o">/</span>
<span class="k">	 global</span> nh3 NHANES_III
<span class="k">     global</span> mort _MORT_2019_PUBLIC<span class="m">.</span>dat
<span class="k">     global varlist</span> <span class="cs">///</span>
         seqn <span class="m">1-6</span> <span class="cs">///</span>
         eligstat <span class="m">15</span> <span class="cs">///</span>
	     mortstat <span class="m">16</span> <span class="cs">///</span>
	     ucod_leading <span class="m">17-19</span> <span class="cs">///</span>
         diabetes <span class="m">20</span> <span class="cs">///</span>
	     hyperten <span class="m">21</span> <span class="cs">///</span>
	     permth_int <span class="m">43-45</span> <span class="cs">///</span>
	     permth_exm <span class="m">46-48</span> 
	 
	 <span class="c1">//1988-1994</span>
<span class="k">	 infix</span> <span class="vg">$varlist</span> using <span class="vg">$nchs$linkage$nh3$mort</span>,<span class="k"> clear</span>
<span class="k">	 replace</span> seqn=<span class="o">-</span><span class="m">1</span><span class="o">*</span>seqn
<span class="k">	 tempfile</span> dat0
<span class="k">	 save</span> <span class="nv">`dat0&#39;</span>
     
	 <span class="c1">//1999-2018</span>
<span class="k">     local</span> N=<span class="m">1</span>

<span class="k">     foreach</span> y of<span class="k"> numlist</span> <span class="m">1999</span> <span class="m">2001</span> <span class="m">2003</span> <span class="m">2005</span> <span class="m">2007</span> <span class="m">2009</span> <span class="m">2011</span> <span class="m">2013</span> <span class="m">2015</span> <span class="m">2017</span> {
<span class="k">         local</span> yplus1=<span class="nv">`y&#39;</span> <span class="o">+</span> <span class="m">1</span>  
<span class="k">         	</span>
<span class="k">	     local</span> nhanes NHANES_<span class="nv">`y&#39;</span>_<span class="nv">`yplus1&#39;</span>
<span class="k">         infix</span> <span class="vg">$varlist</span> using <span class="vg">$nchs$linkage</span><span class="nv">`nhanes&#39;</span><span class="vg">$mort</span>,<span class="k"> clear</span>
<span class="k">	     tempfile</span> dat<span class="nv">`N&#39;</span>
<span class="k">	     save</span> <span class="nv">`dat`N&#39;&#39;</span>
<span class="k">	     local</span> N=<span class="nv">`N&#39;</span><span class="o">+</span><span class="m">1</span>
     }
<span class="k">	 </span>
<span class="k">	 use</span> <span class="nv">`dat0&#39;</span>,<span class="k"> clear</span>
<span class="k">     forvalues</span> i=<span class="m">1</span><span class="o">/</span><span class="m">10</span> {
<span class="k">	</span>
<span class="k">	     append</span> using <span class="nv">`dat`i&#39;&#39;</span>
		 
     }
	
	
}


<span class="k">quietly</span> {
	
	 <span class="c1">//2.values</span>
<span class="k">     lab</span> def premiss .z <span class="s">&quot;Missing&quot;</span>
<span class="k">     lab</span> def eligfmt <span class="m">1</span> <span class="s">&quot;Eligible&quot;</span> <span class="m">2</span> <span class="s">&quot;Under age 18, not available for public release&quot;</span> <span class="m">3</span> <span class="s">&quot;Ineligible&quot;</span> 
<span class="k">     lab</span> def mortfmt <span class="m">0</span> <span class="s">&quot;Assumed alive&quot;</span> <span class="m">1</span> <span class="s">&quot;Assumed deceased&quot;</span> .z <span class="s">&quot;Ineligible or under age 18&quot;</span>
<span class="k">     lab</span> def flagfmt <span class="m">0</span> <span class="s">&quot;No - Condition not listed as a multiple cause of death&quot;</span> <span class="cs">///</span>
	                      <span class="m">1</span> <span class="s">&quot;Yes - Condition listed as a multiple cause of death&quot;</span>	<span class="cs">///</span>
						  .z <span class="s">&quot;Assumed alive, under age 18, ineligible for mortality follow-up, or MCOD not available&quot;</span>
<span class="k">     lab</span> def qtrfmt <span class="m">1</span> <span class="s">&quot;January-March&quot;</span> <span class="cs">///</span>
	                     <span class="m">2</span> <span class="s">&quot;April-June&quot;</span> <span class="cs">///</span>
						 <span class="m">3</span> <span class="s">&quot;July-September&quot;</span> <span class="cs">///</span>
						 <span class="m">4</span> <span class="s">&quot;October-December&quot;</span> <span class="cs">///</span>
						 .z <span class="s">&quot;Ineligible, under age 18, or assumed alive&quot;</span>
<span class="k">     lab</span> def dodyfmt .z <span class="s">&quot;Ineligible, under age 18, or assumed alive&quot;</span>
<span class="k">     lab</span> def ucodfmt <span class="m">1</span> <span class="s">&quot;Diseases of heart (I00-I09, I11, I13, I20-I51)&quot;</span>                           
<span class="k">     lab</span> def ucodfmt <span class="m">2</span> <span class="s">&quot;Malignant neoplasms (C00-C97)&quot;</span>                                            , add
<span class="k">     lab</span> def ucodfmt <span class="m">3</span> <span class="s">&quot;Chronic lower respiratory diseases (J40-J47)&quot;</span>                             , add
<span class="k">     lab</span> def ucodfmt <span class="m">4</span> <span class="s">&quot;Accidents (unintentional injuries) (V01-X59, Y85-Y86)&quot;</span>                    , add
<span class="k">     lab</span> def ucodfmt <span class="m">5</span> <span class="s">&quot;Cerebrovascular diseases (I60-I69)&quot;</span>                                       , add
<span class="k">     lab</span> def ucodfmt <span class="m">6</span> <span class="s">&quot;Alzheimer&#39;s disease (G30)&quot;</span>                                                , add
<span class="k">     lab</span> def ucodfmt <span class="m">7</span> <span class="s">&quot;Diabetes mellitus (E10-E14)&quot;</span>                                              , add
<span class="k">     lab</span> def ucodfmt <span class="m">8</span> <span class="s">&quot;Influenza and pneumonia (J09-J18)&quot;</span>                                        , add
<span class="k">     lab</span> def ucodfmt <span class="m">9</span> <span class="s">&quot;Nephritis, nephrotic syndrome and nephrosis (N00-N07, N17-N19, N25-N27)&quot;</span>  , add
<span class="k">     lab</span> def ucodfmt <span class="m">10</span> <span class="s">&quot;All other causes (residual)&quot;</span>                                             , add
<span class="k">     lab</span> def ucodfmt .z <span class="s">&quot;Ineligible, under age 18, assumed alive, or no cause of death data&quot;</span>      , add
<span class="k">	 </span>
<span class="k">	 </span>
<span class="k">	 replace</span> mortstat = .z<span class="k"> if</span> mortstat <span class="o">&gt;=</span>.
<span class="k">     replace</span> ucod_leading = .z<span class="k"> if</span> ucod_leading <span class="o">&gt;=</span>.
<span class="k">     replace</span> diabetes = .z<span class="k"> if</span> diabetes <span class="o">&gt;=</span>.
<span class="k">     replace</span> hyperten = .z<span class="k"> if</span> hyperten <span class="o">&gt;=</span>.
<span class="k">     replace</span> permth_int = .z<span class="k"> if</span> permth_int <span class="o">&gt;=</span>.
<span class="k">     replace</span> permth_exm = .z<span class="k"> if</span> permth_exm <span class="o">&gt;=</span>.
	
}

<span class="k">quietly</span> {
	
	 <span class="c1">//3.define</span>
<span class="k">	 </span>
<span class="k">     label var</span> seqn <span class="s">&quot;NHANES Respondent Sequence Number&quot;</span>
<span class="k">     label var</span> eligstat <span class="s">&quot;Eligibility Status for Mortality Follow-up&quot;</span>
<span class="k">     label var</span> mortstat <span class="s">&quot;Final Mortality Status&quot;</span>
<span class="k">     label var</span> ucod_leading <span class="s">&quot;Underlying Cause of Death: Recode&quot;</span>
<span class="k">     label var</span> diabetes <span class="s">&quot;Diabetes flag from Multiple Cause of Death&quot;</span>
<span class="k">     label var</span> hyperten <span class="s">&quot;Hypertension flag from Multiple Cause of Death&quot;</span>
<span class="k">     label var</span> permth_int <span class="s">&quot;Person-Months of Follow-up from NHANES Interview date&quot;</span>
<span class="k">     label var</span> permth_exm <span class="s">&quot;Person-Months of Follow-up from NHANES Mobile Examination Center (MEC) Date&quot;</span>

<span class="k">     label</span> values eligstat eligfmt
<span class="k">     label</span> values mortstat mortfmt
<span class="k">     label</span> values ucod_leading ucodfmt
<span class="k">     label</span> values diabetes flagfmt
<span class="k">     label</span> values hyperten flagfmt
<span class="k">     label</span> value permth_int premiss
<span class="k">     label</span> value permth_exm premiss

<span class="k">     noi des</span> 
	 
	 <span class="c1">//eligibility</span>
<span class="k">	 drop if</span> <span class="nf">inlist</span>(eligstat,<span class="m">2</span>,<span class="m">3</span>)
<span class="k">	 duplicates drop</span> 

<span class="k">	 keep</span> seqn mortstat permth_int permth_exm 
<span class="k">	 save</span> <span class="s">&quot;11_nhmort</span><span class="vg">$date</span><span class="s">&quot;</span>,<span class="k"> replace</span> 
	 
	 <span class="c1">//big data!</span>
<span class="k">	 noi di</span> <span class="s">&quot;&quot;</span>
<span class="k">	 noi di</span> <span class="s">&quot;rows x columns:&quot;</span>
<span class="k">	 noi count</span>
<span class="k">	 ds</span> 
<span class="k">	 noi di</span> <span class="nf">wordcount</span>(<span class="nf">r</span>(varlist))
<span class="k">	 </span>
<span class="k">     global</span> finish  = <span class="nf">clock</span>(<span class="nf">c</span>(current_time),<span class="s">&quot;hms&quot;</span>)<span class="o">/</span><span class="m">10</span><span class="o">^</span><span class="m">3</span>
<span class="k">     global</span> duration = <span class="nf">round</span>((<span class="vg">$finish</span> <span class="o">-</span> <span class="vg">$start</span>)<span class="o">/</span><span class="m">60</span>,<span class="m">1</span>)

<span class="k">     noi di</span> <span class="s">&quot;runtime = </span><span class="vg">$duration</span><span class="s"> minute(s)&quot;</span>	 
<span class="k">	 </span>
<span class="k">	 log close</span>
}
</pre></div>
</div>
<hr class="docutils" />
<ol class="arabic simple" start="5">
<li><p>13_nhsurv_final.do</p></li>
</ol>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span>cls
<span class="k">clear</span>

<span class="c1">*! baseline 08_nhmerge.dta (previously 08_nhtable1.dta)</span>
<span class="c1">*! outcome 15_nhcohort.dta (previously 15_nhsurv.dta)</span>
<span class="c1">*! should be able to produce a km curve 30y mortality</span>

<span class="k">quietly</span> {
<span class="k">	</span>
<span class="k">     capture log close</span>
<span class="k">     global</span> date:<span class="k"> di</span> <span class="nx">%td</span> <span class="nf">date</span>(<span class="nf">c</span>(current_date),<span class="s">&quot;DMY&quot;</span>)
<span class="k">     log</span> using <span class="s">&quot;14_nhcohort</span><span class="vg">$date</span><span class="s">.log&quot;</span>,<span class="k"> replace</span>
<span class="k">     version</span> <span class="m">15</span>

<span class="k">     global</span> start = <span class="nf">clock</span>(<span class="nf">c</span>(current_time),<span class="s">&quot;hms&quot;</span>)<span class="o">/</span><span class="m">10</span><span class="o">^</span><span class="m">3</span>
	 
	 <span class="c1">//nhanes at baseline</span>
<span class="k">	 use</span> 08_nhmerge<span class="vg">$date</span>,<span class="k"> clear</span>
	 
	 <span class="c1">//nhanes at death or censoring</span>
<span class="k">	 noi merge</span> <span class="m">1</span>:<span class="m">1</span> seqn using 11_nhmort<span class="vg">$date</span>,<span class="k"> keep</span>(matched) nogen
	 
	 <span class="c1">//variable labels derived from wwwn.cdc.gov/nchs/nhanes/</span>
<span class="k">	 lab var</span> seqn <span class="s">&quot;Sequence number (seqn x -1 for NHANES III)&quot;</span>
<span class="k">	 lab var</span> dmpstat <span class="s">&quot;Examinmation/interview status&quot;</span>
<span class="k">	 lab var</span> dmarethn <span class="s">&quot;Race/ethnicity&quot;</span>
<span class="k">	 lab var</span> hssex <span class="s">&quot;Sex&quot;</span>
<span class="k">	 lab var</span> hsageir <span class="s">&quot;Age at interview (screener) -qty&quot;</span>
<span class="k">	 lab var</span> hfa8r <span class="s">&quot;Education level&quot;</span>
<span class="k">	 lab var</span> hff19r <span class="s">&quot;Total family 12 month income group&quot;</span>
<span class="k">	 lab var</span> pepmnk1r <span class="s">&quot;Overall average K1, systolic, BP(age 5+)&quot;</span>
<span class="k">	 lab var</span> pepmnk5r <span class="s">&quot;Overall average K5, diastolic, BP(age5+)&quot;</span>
<span class="k">	 lab var</span> bmpbmi <span class="s">&quot;Body mass index&quot;</span>
<span class="k">	 lab var</span> ghp <span class="s">&quot;Glycated hemoglobin: %&quot;</span>
<span class="k">	 lab var</span> ubp <span class="s">&quot;Urinary albumin (ug/mL)&quot;</span>
<span class="k">	 lab var</span> urp <span class="s">&quot;Urinary creatinine (mg/dL)&quot;</span>
<span class="k">	 lab var</span> sgpsi <span class="s">&quot;serum glucose: SI (mmol/L)&quot;</span>
<span class="k">	 lab var</span> cep <span class="s">&quot;Serum creatine (mg/dL)&quot;</span>
<span class="k">	 lab var</span> had1 <span class="s">&quot;Ever been told you have sugar/diabetes&quot;</span>
<span class="k">	 lab var</span> hae2 <span class="s">&quot;Doctor ever told had hypertension/HBP&quot;</span>
<span class="k">	 lab var</span> har1 <span class="s">&quot;Have tiy snijed 100_ cigarettes in life&quot;</span>
<span class="k">	 </span>
<span class="k">     lab</span> dat <span class="s">&quot;NHANES 1988-2018, Original Variables&quot;</span>
<span class="k">	 save</span> <span class="s">&quot;15_nhcohort</span><span class="vg">$date</span><span class="s">&quot;</span>,<span class="k"> replace</span> 
	 
	 <span class="c1">//big data!</span>
<span class="k">	 noi di</span> <span class="s">&quot;&quot;</span>
<span class="k">	 noi di</span> <span class="s">&quot;rows x columns:&quot;</span>
<span class="k">	 noi count</span>
<span class="k">	 ds</span> 
<span class="k">	 noi di</span> <span class="nf">wordcount</span>(<span class="nf">r</span>(varlist))
<span class="k">	 </span>
<span class="k">     global</span> finish  = <span class="nf">clock</span>(<span class="nf">c</span>(current_time),<span class="s">&quot;hms&quot;</span>)<span class="o">/</span><span class="m">10</span><span class="o">^</span><span class="m">3</span>
<span class="k">     global</span> duration = <span class="nf">round</span>((<span class="vg">$finish</span> <span class="o">-</span> <span class="vg">$start</span>)<span class="o">/</span><span class="m">60</span>,<span class="m">1</span>)

<span class="k">     noi di</span> <span class="s">&quot;runtime = </span><span class="vg">$duration</span><span class="s"> minute(s)&quot;</span>		 

<span class="k">	 log close</span>

}

<span class="k">des</span> 
</pre></div>
</div>
<ol class="arabic simple" start="6">
<li><p>17_nhtable1_final.do</p></li>
</ol>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span>
cls
macro drop _all

*! inputs 15_nhcohort$date.dta (previously 15_nhsurv$date.dta) 
*! renames cdc/nchs variables (previously done in 07_nhtable1.do)
*! applies selection criteria (previously done in 07_nhtable1.do)
*! ver 1.0 of 17_*.do 02/01/23 (after submission to rdc/nchs/cdc)

quietly {
	
	 capture log close
     global date: di %td date(c(current_date),&quot;DMY&quot;)
     log using &quot;19_nhtable1$date.log&quot;, replace
     version 12
     global start = clock(c(current_time),&quot;hms&quot;)/10^3 
	
     //1.data as sent to rdc/nchs/cdc
     use 15_nhcohort$date, clear  


}

quietly { //var renames
	 
	 //2.variables as used in analysis
	 
	 //seqn
	 isid seqn
	 
	 //survey
	 g year=surv
	 lab var year &quot;Year of Donation, %&quot;
	 label define Year ///
	     1 &quot;1988-1998&quot; ///
		 2 &quot;1999-2000&quot; ///
		 3 &quot;2001-2002&quot; ///
		 4 &quot;2003-2004&quot; ///
		 5 &quot;2005-2006&quot; ///
		 6 &quot;2007-2008&quot; ///
		 7 &quot;2009-2010&quot; ///
		 8 &quot;2011-2012&quot; ///
		 9 &quot;2013-2014&quot; ///
		 10 &quot;2015-2016&quot; ///
		 11 &quot;2017-2018&quot; 
	 label values year Year
	 
	 //eligibility
	     //1988-1998
	 drop if inlist(dmpstat,1,3)
	 
	     //1999-2018
	 drop if ridstatr==1
	 
	 //race
	     //1988-1998
	 g race=dmarethn
	 label var race &quot;Race/ethnicity, %&quot;
	 label define Race 1 &quot;White&quot; 2 &quot;Black&quot; 3 &quot;Hispanic&quot; 4 &quot;Other&quot; 
	 label values race Race
	 
	    //1999-2018
	 recode ridreth1 (3=1)(4=2)(1 2=3)(5=4)
	 replace race=ridreth1 if inrange(year,2,11)
	 
	 recode ridreth3 (3=1)(4=2)(1 2=3)(6=4)(7=5),gen(race2)
	 label var race2 &quot;Race/ethnicity, %&quot;
	 label define Race2 1 &quot;White&quot; 2 &quot;Black&quot; 3 &quot;Hispanic&quot; 4 &quot;Asian&quot; 5 &quot;Other&quot; 
	 label values race2 Race2
	 
	 //sex
	     //1988-1998
	 recode hssex (1=0)(2=1),gen(female)
	 label var female &quot;Female, %&quot;
	 
	     //1999-2018
	 recode riagendr (1=0)(2=1)
	 replace female=riagendr if inrange(year,2,11)
	 
	 //age
	     //1988-1998
     g age=hsageir 
	 label var age &quot;Age, y, median [IQR]&quot;
	 
	     //1999-2018
	 replace age=ridageyr if inrange(year,2,11)
	 
	     //eligibility
	 drop if !inrange(age,18,90)
	 
	 //education
	     //1988-1998
     recode hfa8r ///  
     (0/8=1) ///k-8
	 (9/12 13=2) ///highsch, diploma
	 (14/15=3) ///some coll/assoc
	 (16/17=4) ///coll/above
	 (66/99=.), gen(educ)
	 
	     //1999-2018
	 recode dmdeduc2 ///
	 (2 3=2) ///
	 (4=3) ///
	 (5=4) ///
	 (7 9=.)
	 replace educ=dmdeduc2 if inrange(year,2,11)
	 
     label define Educ /// 
     1 &quot;K-8&quot; ///
	 2 &quot;High school, Diploma/equivalent&quot; ///
	 3 &quot;Some college/associate&quot; ///
	 4 &quot;College graduate/above&quot; 
     label values educ Educ
	 label var educ &quot;Education, %&quot;
		 
	 //income
	     //1988-1998
	 g income=hff19r
	 label var income &quot;Income, $, median [IQR]&quot;
	 
	 replace income=. if inlist(income,88,99) 
     replace income=round(rweibull(2, 5000, 0)) if inrange(income,0,2)
     
	 forvalues i=3/20 {
	     replace income=round(runiform((`i&#39;000-1000),`i&#39;000)) if income==`i&#39;
     }
    
	 local lb=20000
     forvalues i=21/26 {
	     local ub=`lb&#39; + 4999
	     di &quot;`lb&#39;&quot; &quot; `ub&#39;&quot;
	     replace income=round(runiform(`lb&#39;,`ub&#39;)) if income==`i&#39;
	     local lb=`ub&#39; + 1
     }
   
     replace income=round(rweibull(1.09, 25000, 50000)) if income==27
	 
	     //1999-2018
		 
	 replace income=indhhinc  if inrange(year,2,5)
	 replace income=indhhin2  if inrange(year,6,11)
	 local lb=0
     foreach i of numlist 1 2 3 4 5 {
         local ub=`lb&#39; + 4999	     
		 replace income=runiform(`lb&#39;,`ub&#39;) if income==`i&#39; &amp; year!=1
		 local lb=`ub&#39; + 1
     }
    
	 local lb=25000
     foreach i of numlist 6 7 8 9 10 11 {
	     local ub=`lb&#39; + 9999
	     replace income=runiform(`lb&#39;,`ub&#39;) if income==`i&#39; &amp; year!=1
	     local lb=`ub&#39; + 1
     }
   
	 //dm
	     //1988-1998
	 recode had1 (2=0)(8 9=.), gen(dm)  
	 label var dm &quot;Diabetes, %&quot;
	 
	     //1999-2018
	 recode diq010 (1 3=1)(2=0)(7 9=.)
	 replace dm=diq010 if inrange(year,2,11)
		 
	 //htn
	     //1988-1998
	 recode hae2 (2=0)(8 9=.), gen(htn)  
	 label var htn &quot;Hypertension, %&quot;
	 
	     //1999-2018
     recode bpq020 (2=0)(9=.)
	 replace htn=bpq020 if inrange(year,2,11)
	 
	 //ckd 
	     //1988-1998
	
		   
		 //1999-2018
	 recode kiq020 (2=0)(7 9=.) if inlist(year,2),gen(ckd)
	 recode kiq022 (2=0)(7 9=.) if inrange(year,3,11)
	 replace ckd=kiq022 if inrange(year,3,11)
	 label var ckd &quot;CKD, %&quot;
	 
	 //smoke
	     //1988-1998
	 recode har1 (2=0),gen(smk)
	 label var smk &quot;Smoke, %&quot;
	 
	     //1999-2018
	 recode smq020 (2=0)(7 9=.)
	 replace smk=smq020 if inrange(year,2,11)
	 
	 //bp
	     //1988-1998
	 g sbp=pepmnk1r
	 label var sbp &quot;SBP, mmHg, median [IQR]&quot;
	 g dbp=pepmnk5r
	 label var dbp &quot;DBP, mmHg, median [IQR]&quot;
	 
	     //1999-2018
	 replace sbp=bpxsar if inrange(year,2,4)
	 replace dbp=bpxdar if inrange(year,2,4)
	 
	 replace sbp=bpxsy1 if inrange(year,5,11)
	 replace dbp=bpxdi1 if inrange(year,5,11)

	 //bmi
	     //1988-1998
	 g bmi=bmpbmi
	 label var bmi &quot;BMI, kg/m2, median [IQR]&quot;
	 
	     //1999-2018
	 replace bmi=bmxbmi if inrange(year,2,11)

	 //hba1c
	     //1988-1998
	 g hba1c=ghp
	 label var hba1c &quot;HBA1c, %, median [IQR]&quot;
	 
	     //1988-1998
	 replace hba1c=lbxgh if inrange(year,2,11)
	 
	 //uacr
	     //1988-1998
	 g acr=(ubp*1/10^-3)/(urp*1/10^-1) 
	 label var acr &quot;uACR, mg/g, median [IQR]&quot;
	 
	     //1999-2018
     replace acr=(urxuma*1/10^-3)/(urxucr*1/10^-1) if inrange(year,2,11)
	
	g logacr=log(acr)
	 label var logacr &quot;Log uACR, log(mg/g), median [IQR]&quot;	
	 
	 //glucose
	     //1988-1998
	 g glucose=sgpsi*18/10
	 label var glucose &quot;Glucose, mg/L, median [IQR]&quot;
	 
	     //1999-2018
	 replace glucose=lbxsgl*1/10^1 if inrange(year,2,11)
	 
	 //creatinine
	     //1988-1998
	 g creat=cep
	 label var creat &quot;Serum Creatinine, mg/dL, median [IAR]&quot;
	 
	     //1999-2018
	 replace creat=lbdscrsi/88.42 if inrange(year,2,11)

     
	 //ckd-epi
     replace creat=0.960*creat-0.184 if year==1
     local k=cond(female==1,0.7,0.9)
     local alpha=cond(female==1,-0.329,-0.411)
     g egfr=141*min(creat/`k&#39;,1)^`alpha&#39;* ///
	            max(creat/`k&#39;,1)^-1.209* ///
			    0.993^age* ///
				1.018^female* ///
				1.159^(race==2) if !missing(creat)
 	 label var egfr &quot;eGFR, ml/min/1.73m2, median [IAR]&quot;
	 
	
}

quietly {
	
	 //3.keep variables 
	     keep seqn age female race race2 educ income dm htn smk ///
		      sbp dbp bmi hba1c glucose acr logacr creat egfr year ///
			  mortstat permth_int permth_exm
}


     lab dat &quot;NHANES 1988-2018, Renamed Variables&quot;
     save &quot;18_nhtable1$date&quot;, replace
	
	
quietly {
	
		 //big data!
	 noi di &quot;&quot;
	 noi di &quot;rows x columns:&quot;
	 noi count
	 ds 
	 noi di wordcount(r(varlist))
	 
     global finish  = clock(c(current_time),&quot;hms&quot;)/10^3
     global duration = round(($finish - $start)/60,1)

     noi di &quot;runtime = $duration minute(s)&quot;	

     log close
	
}



</pre></div>
</div>
<ol class="arabic simple" start="7">
<li><p>20_nhsas7bdat.do</p></li>
</ol>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">* https://chat.openai.com/chat</span>
<span class="c1">* how do I create a .sas7bdat format file from stata?</span>
<span class="c1">* and the rest is history :)</span>

<span class="k">use</span> 18_nhtable102feb2023,<span class="k"> clear</span>
<span class="k">outsheet</span> using <span class="s">&quot;21_nhtable102feb2023.csv&quot;</span>, comma<span class="k"> replace</span>

<span class="k">if</span> <span class="m">0</span> {
	
	 proc import datafile=&#39;21_nhtable102feb2023<span class="m">.</span>csv&#39;
<span class="k">     out</span>=your_sas_dataset
     dbms=csv<span class="k"> replace</span>;
     getnames=yes;
<span class="k">     run</span>;

	
}
</pre></div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./act_0/act_0_0/act_0_0_7"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="simple visible nav section-nav flex-column">
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Abimereki Muzaale, Vincent Jin, and JHU TRC
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
       Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>