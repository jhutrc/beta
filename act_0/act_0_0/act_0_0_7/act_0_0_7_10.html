

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title> &#8212; My Jupyter Book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'act_0/act_0_0/act_0_0_7/act_0_0_7_10';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="https://raw.githubusercontent.com/jhutrc/jhutrc.github.io/main/hub_and_spoke.jpg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="https://raw.githubusercontent.com/jhutrc/jhutrc.github.io/main/hub_and_spoke.jpg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../intro.html">
                    Fena
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">1. Challenges</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../act_1/act_1_0/act_1_0_0/act_1_0_0_1.html"></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_1/act_1_0/act_1_0_0/act_1_0_0_2.html"></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_1/act_1_0/act_1_0_0/act_1_0_0_3.html"></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_1/act_1_0/act_1_0_1/act_1_0_1_1.html">Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_1/act_1_0/act_1_0_1/act_1_0_1_2.html">R</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_1/act_1_0/act_1_0_1/act_1_0_1_3.html">Stata</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_1/act_1_1/act_1_1_0/act_1_1_0_1.html">AI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_1/act_1_1/act_1_1_0/act_1_1_0_2.html">Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_1/act_1_1/act_1_1_0/act_1_1_0_3.html"></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_1/act_1_1/act_1_1_1/act_1_1_1_1.html"></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_1/act_1_1/act_1_1_1/act_1_1_1_2.html"></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_1/act_1_1/act_1_1_1/act_1_1_1_3.html"></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_1/act_1_2/act_1_2_0/act_1_2_0_1.html">Numeracy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_1/act_1_2/act_1_2_0/act_1_2_0_2.html">.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_1/act_1_2/act_1_2_0/act_1_2_0_3.html">.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_1/act_1_2/act_1_2_1/act_1_2_1_1.html">Literacy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_1/act_1_2/act_1_2_1/act_1_2_1_2.html">.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_1/act_1_2/act_1_2_1/act_1_2_1_3.html">.</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">2. Skills</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../act_2/act_2_0/act_2_0_0/act_2_0_0_1.html">Point estimates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_2/act_2_0/act_2_0_0/act_2_0_0_2.html">.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_2/act_2_0/act_2_0_0/act_2_0_0_3.html">.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_2/act_2_0/act_2_0_1/act_2_0_1_1.html">Interval estimates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_2/act_2_0/act_2_0_1/act_2_0_1_2.html">.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_2/act_2_0/act_2_0_1/act_2_0_1_3.html">.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_2/act_2_1/act_2_1_0/act_2_1_0_1.html">Statistical Inferences</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_2/act_2_1/act_2_1_0/act_2_1_0_2.html">.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_2/act_2_1/act_2_1_0/act_2_1_0_3.html">.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_2/act_2_1/act_2_1_1/act_2_1_1_1.html">Frequentist vs. Bayesian</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_2/act_2_1/act_2_1_1/act_2_1_1_2.html">.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_2/act_2_1/act_2_1_1/act_2_1_1_3.html">.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_2/act_2_2/act_2_2_0/act_2_2_0_1.html">Oneway</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_2/act_2_2/act_2_2_0/act_2_2_0_2.html">Twoway</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_2/act_2_2/act_2_2_0/act_2_2_0_3.html">Multivariable</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_2/act_2_2/act_2_2_1/act_2_2_1_1.html">Hierarchical</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_2/act_2_2/act_2_2_1/act_2_2_1_2.html">Clinical</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_2/act_2_2/act_2_2_1/act_2_2_1_3.html">Public</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">3. Workflow</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../act_3/act_3_0/act_3_0_0/act_3_0_0_1.html">Manuscripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_3/act_3_0/act_3_0_0/act_3_0_0_2.html">Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_3/act_3_0/act_3_0_0/act_3_0_0_3.html">Git</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_3/act_3_0/act_3_0_1/act_3_0_1_1.html">Open Science</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_3/act_3_0/act_3_0_1/act_3_0_1_2.html">Self publish</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_3/act_3_0/act_3_0_1/act_3_0_1_3.html">.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_3/act_3_1/act_3_1_0/act_3_1_0_1.html">Automate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_3/act_3_1/act_3_1_0/act_3_1_0_2.html">Bash</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_3/act_3_1/act_3_1_0/act_3_1_0_3.html">Unix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_3/act_3_1/act_3_1_1/act_3_1_1_1.html">.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_3/act_3_1/act_3_1_1/act_3_1_1_2.html">.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_3/act_3_1/act_3_1_1/act_3_1_1_3.html">.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_3/act_3_2/act_3_2_0/act_3_2_0_1.html">Stata programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_3/act_3_2/act_3_2_0/act_3_2_0_2.html">Data science for public health</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_3/act_3_2/act_3_2_0/act_3_2_0_3.html">.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_3/act_3_2/act_3_2_1/act_3_2_1_1.html">.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_3/act_3_2/act_3_2_1/act_3_2_1_2.html">.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../act_3/act_3_2/act_3_2_1/act_3_2_1_3.html">.</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../act_0_0_1/act_0_0_1_2.html">.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../act_0_0_1/act_0_0_1_3.html">.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../act_0_1/act_0_1_0/act_0_1_0_2.html">.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../act_0_1/act_0_1_0/act_0_1_0_3.html">.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../act_0_1/act_0_1_1/act_0_1_1_1.html"></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../act_0_1/act_0_1_1/act_0_1_1_2.html">.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../act_0_1/act_0_1_1/act_0_1_1_3.html">.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../act_0_2/act_0_2_0/act_0_2_0_3.html">.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../act_0_2/act_0_2_1/act_0_2_1_1.html">.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../act_0_2/act_0_2_1/act_0_2_1_2.html">.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../act_0_2/act_0_2_1/act_0_2_1_3.html">.</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/act_0/act_0_0/act_0_0_7/act_0_0_7_10.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1></h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#patient-survival-death">1. Patient survival/death</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#graft-survival-death-censored-and-all-cause">2. Graft survival (death censored and all-cause)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#delayed-graft-function-dgf">3. Delayed Graft Function (DGF)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#primary-non-function-pnf">4. Primary Non-Function (PNF)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#acute-rejection">5. Acute rejection</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#racial-category">6. Racial category</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pra-panel-reactive-antibody-time-varying-pra">7. PRA (Panel Reactive Antibody), Time-varying PRA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#kidney-disease-etiology-diagnosis">8. Kidney disease etiology/diagnosis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fix-abo-abo-mismatch">9. Fix ABO/ABO mismatch</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#age-categories">10. Age categories</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#body-mass-index-bmi">11. Body Mass Index (BMI)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cit-cold-ischemia-time">12. CIT (Cold Ischemia Time)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#donor-diabetes-mellitus-dm-hypertension-htn-terminal-serum-creatinine-scr-1-5-and-manually-recode-expanded-criteria-donor-ecd-scr-assessment">13. Donor Diabetes Mellitus (DM), Hypertension (HTN), terminal Serum Creatinine (SCr) &gt;1.5, and manually recode Expanded Criteria Donor (ECD), SCr Assessment</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hla-mismatch">14. HLA mismatch</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#duration-of-pre-kt-dialysis-vs-listing">15. Duration of pre-KT dialysis (vs listing?)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hepatitis-c-virus-hcv-by-diagnosis-for-candidate-by-serostatus-for-recipient-by-serostatus-for-donor">16. Hepatitis C Virus (HCV) (by diagnosis for candidate/by serostatus for recipient/by serostatus for donor)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hepatocellular-carcinoma-hcc-by-diagnosis-by-exception-points">17. Hepatocellular Carcinoma (HCC) (by diagnosis/by exception points)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#immunosuppression-induction">18. Immunosuppression/Induction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#insurance">19. Insurance</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#kidney-donor-risk-index-kdri-kidney-donor-profile-index-kdpi">20. Kidney Donor Risk Index (KDRI)/Kidney Donor Profile Index (KDPI)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#donor-risk-index-dri">21. Donor Risk Index (DRI)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estimated-post-transplant-survival-epts">22. Estimated Post Transplant Survival (EPTS)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#machine-perfusion">23. Machine perfusion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-for-end-stage-liver-disease-meld-listing-transplant">24. Model for End-Stage Liver Disease (MELD) (listing /transplant)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#previous-solid-organ-transplant-tx-previous-kidney-transplant-kt">25. Previous solid organ transplant (Tx)/ previous kidney transplant (KT)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#organ-sharing">26. Organ Sharing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#de-identification-code">27. De-identification Code</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transplant-date">28. Transplant Date</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#living-donor-programmed-kidney-injury-ldpki">29. Living Donor Programmed Kidney Injury (LDPKI)</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="id1">
<h1><a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h1>
<p>Analytic code snippets from The Epidemiology Research Group on Organ Transplantation</p>
<ul class="simple">
<li><p>Look for code by Ctrl+F</p></li>
<li><p>Be aware that there will be a 6-month lag in SRTR data update for outcomes that need follow-up, such as death and graft failure</p></li>
<li><p>So for example if you have Sep 2015 data set, it’s safer to include data in or earlier than Mar 2015 for analysis of these outcomes</p></li>
<li><p>For candidate datasets, <code class="docutils literal notranslate"><span class="pre">can_endwlfu</span></code> indicates the last date of follow-up For donor dispositions, such as discard, there is no lag</p></li>
<li><p>Discuss how to model missing data with your mentor- model-wise deletion? Imputation? <strike>Missing indicator</strike>?</p></li>
</ul>
<hr class="docutils" />
<section id="patient-survival-death">
<h2>1. Patient survival/death<a class="headerlink" href="#patient-survival-death" title="Permalink to this heading">#</a></h2>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">// -------------------------------------------</span>
<span class="c1">// Patient survival /death</span>
<span class="c1">// -------------------------------------------</span>

<span class="c1">*Date of mortality*</span>
<span class="k">egen</span> death_dt = rowmin( pers_ssa_death_dt pers_optn_death_dt pers_restrict_death_dt tfl_death_dt)
<span class="k">label var</span> death_dt <span class="s">&quot;Date of death&quot;</span>
<span class="c1">****A time metric taking administrative censoring into consideration****</span>
<span class="k">gen</span> t1=death_dt
<span class="k">replace</span> t1=<span class="nf">mdy</span>(<span class="m">03</span>,<span class="m">04</span>,<span class="m">2015</span>)<span class="k"> if</span> death_dt<span class="o">&gt;</span><span class="nf">mdy</span>(<span class="m">03</span>,<span class="m">04</span>,<span class="m">2015</span>)  <span class="c1">// modify according to study time frame</span>
<span class="k">label var</span> t1 <span class="s">&quot;Time metric for Death&quot;</span>
<span class="c1">****Mortality, only those happened before the end of F/U****</span>
<span class="k">gen</span> death=<span class="nf">inrange</span>(death_dt,rec_tx_dt,t1)
<span class="k">label var</span> death <span class="s">&quot;All-cause mortality&quot;</span>
<span class="k">label</span> define death <span class="m">0</span> <span class="s">&quot;Alive&quot;</span> <span class="m">1</span> <span class="s">&quot;Dead&quot;</span>
<span class="k">label</span> values death death

<span class="c1">//DEATH DATE</span>
<span class="c1">//when using candidate data set only</span>
<span class="k">egen</span> death_dt=rowmin(pers_ssa_death_dt pers_optn_death_dt pers_restrict_death_dt tfl_death_dt)
<span class="k">replace</span> death_dt=can_rem_dt<span class="k"> if</span> can_rem_dt<span class="o">&lt;</span>death_dt <span class="o">&amp;</span>
<span class="nf">inlist</span>(can_rem_cd,<span class="m">8</span>)
<span class="c1">//died (8)</span>

<span class="c1">*WAITLIST MORTALITY candidate data</span>
<span class="k">egen</span> death_dt=rowmin(pers_ssa_death_dt pers_optn_death_dt pers_restrict_death_dt tfl_death_dt)
<span class="k">replace</span> death_dt=can_rem_dt<span class="k"> if</span> can_rem_dt<span class="o">&lt;</span>death_dt <span class="o">&amp;</span>
<span class="nf">inlist</span>(can_rem_cd,<span class="m">8</span>,<span class="m">13</span>,<span class="m">5</span>)  <span class="c1">//8-died; 13-deterioration; 5- medically unsuitable</span>
<span class="k">replace</span> death_dt=.<span class="k"> if</span> can_rem_cd<span class="o">&lt;</span>death_dt <span class="o">&amp;</span> <span class="nf">inlist</span>(can_rem_cd,<span class="m">4</span>,<span class="m">15</span>,<span class="m">21</span>,<span class="m">14</span>,<span class="m">22</span>,<span class="m">18</span>,<span class="m">19</span>) <span class="c1">//4-DDTx; 15-LDTx; 21</span>
<span class="c1">//censor if removal is for tx</span>
<span class="c1">//discuss with your mentor</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="graft-survival-death-censored-and-all-cause">
<h2>2. Graft survival (death censored and all-cause)<a class="headerlink" href="#graft-survival-death-censored-and-all-cause" title="Permalink to this heading">#</a></h2>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">// -------------------------------------------</span>
<span class="c1">// Graft survival / failure GF (death censored and all-cause)</span>
<span class="c1">// -------------------------------------------</span>
<span class="k">gen</span> t1=death_dt
<span class="k">replace</span> t1=<span class="nf">mdy</span>(<span class="m">03</span>,<span class="m">04</span>,<span class="m">2015</span>)<span class="k"> if</span> death_dt<span class="o">&gt;</span><span class="nf">mdy</span>(<span class="m">03</span>,<span class="m">04</span>,<span class="m">2015</span>)
<span class="c1">//modify this based on how you define your study period!</span>
<span class="c1">****Date for all-cause graft failure****</span>
<span class="c1">//Some of these dates included in the brackets are version-specific. Check the SAF dataset you work on t</span>
<span class="c1">// rec_esrd_grf_fail_dt &amp; rec_esrd_fail_dt are only in Oct 14 dataset</span>
<span class="k">label var</span> acgf_dt <span class="s">&quot;Date of all-cause graft failure&quot;</span>
<span class="c1">//MUST ascertain death_dt prior to estimating gfail_dt</span>
<span class="c1">// check that death dates are post transplant</span>
<span class="c1">*compare death_dt tx_dt</span>
<span class="k">gen</span> acgf=<span class="nf">inrange</span>(acgf_dt,rec_tx_dt,t1)
<span class="k">label var</span> acgf <span class="s">&quot;All-cause graft failure&quot;</span>
<span class="k">label</span> define acgf <span class="m">0</span> <span class="s">&quot;Graft functioning up to administrative censor&quot;</span> <span class="m">1</span> <span class="s">&quot;Graft failed or died&quot;</span>
<span class="k">label</span> values acgf acgf
<span class="c1">****Graft failure date for Death-censored graft failure models****</span>
<span class="c1">****DCGF date****</span>
<span class="c1">// need to censor death later (still GF if gf_dt == death_dt</span>
<span class="k">gen</span> dcgf_dt = <span class="nf">min</span>(tfl_graft_dt, rec_esrd_fail_dt, rec_esrd_grf_fail_dt, pers_retx, rec_fail_dt, rec_resu
<span class="c1">// rec_esrd_grf_fail_dt &amp; rec_esrd_fail_dt are only in 1410 dataset</span>
<span class="k">label var</span> dcgf_dt <span class="s">&quot;Date of DCGF&quot;</span>
<span class="k">gen</span> dcgf=<span class="nf">inrange</span>(dcgf_dt,rec_tx_dt,<span class="nf">min</span>(death_dt, <span class="nf">mdy</span>(<span class="m">12</span>,<span class="m">31</span>,<span class="m">2015</span>)))
<span class="c1">//Change the date according to your study period</span>
<span class="k">label var</span> dcgf <span class="s">&quot;Death-censored graft failure&quot;</span>
<span class="k">label</span> define dcgf <span class="m">0</span> <span class="s">&quot;Graft functioning&quot;</span> <span class="m">1</span> <span class="s">&quot;Graft failed &lt;=death date or administrative censor&quot;</span>
<span class="k">label</span> values dcgf dcgf
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="delayed-graft-function-dgf">
<h2>3. Delayed Graft Function (DGF)<a class="headerlink" href="#delayed-graft-function-dgf" title="Permalink to this heading">#</a></h2>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">// -------------------------------------------</span>
<span class="c1">// ascertain DELAYED GRAFT FUNCTION</span>
<span class="c1">// -------------------------------------------</span>
<span class="c1">// Keep it in mind- if DGF is the main exposure/outcome, those with  dgf = 0 and died within the first w</span>
<span class="c1">// main analysis 1) adjust for pre-emptive as covariate, 2) exclude any pre-emptives (see mentor) - pre-</span>
<span class="k">gen</span> dgf=rec_first_week_dial<span class="o">==</span><span class="s">&quot;Y&quot;</span>
<span class="k">replace</span> dgf = .<span class="k"> if</span> rec_first_week_dial<span class="o">==</span><span class="s">&quot;U&quot;</span> | <span class="nf">missing</span>(rec_first_week_dial)
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="primary-non-function-pnf">
<h2>4. Primary Non-Function (PNF)<a class="headerlink" href="#primary-non-function-pnf" title="Permalink to this heading">#</a></h2>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">// -------------------------------------------</span>
<span class="c1">// ascertain primary non-function</span>
<span class="c1">// -------------------------------------------</span>
<span class="c1">// this is PNF for patients who survive at least 90 days</span>
<span class="c1">// CAUTION: anyone who doesn&#39;t survive to 90 days, they are dropped</span>
<span class="c1">//90 days and 1 week shown- ask your mentor re: the appropriate measure</span>
<span class="c1">//determine gfail_dt appropriately (death censored, not all-cause)</span>
<span class="c1">//Option 1 works fine if you are just excluding PNF folks. If PNF is a covariate, then, what is now code</span>
<span class="k">gen</span> byte pnf = (gfail_dt <span class="o">-</span> rec_tx_dt <span class="o">&lt;=</span> <span class="m">90</span>) <span class="c1">// doesn&#39;t need to be dgf==&quot;Y&quot;</span>
<span class="k">replace</span> pnf = .<span class="k"> if</span> death_dt <span class="o">&lt;</span> gfail_dt <span class="o">&amp;</span> death_dt<span class="o">-</span>rec_tx_dt <span class="o">&lt;=</span> <span class="m">90</span>

<span class="cm">/*Defined as &quot;the lack of kidney graft function recovery and</span>
<span class="cm">permanent need of dialysis since the first week of transplant surgery</span>
<span class="cm">(Jayaram, Clin Transplantation, 2012)*/</span>
<span class="k">gen</span> pnf=(gfail_dt<span class="o">-</span>rec_tx_dt<span class="o">&lt;=</span><span class="m">7</span>)
<span class="k">replace</span> pnf=.<span class="k"> if</span> gfail_dt<span class="o">==</span>. | rec_tx_dt<span class="o">==</span>.
<span class="k">label var</span> pnf <span class="s">&quot;Permanent non-functioning&quot;</span>
<span class="k">label</span> define pnf <span class="m">0</span> <span class="s">&quot;No PNF&quot;</span> <span class="m">1</span> <span class="s">&quot;PNF&quot;</span>
<span class="k">label</span> values pnf pnf
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="acute-rejection">
<h2>5. Acute rejection<a class="headerlink" href="#acute-rejection" title="Permalink to this heading">#</a></h2>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">// -----------------------------------</span>
<span class="c1">// 1-yr acute rejection</span>
<span class="c1">// -----------------------------------</span>
<span class="m">1</span>. Simple<span class="k"> version</span> (need to re<span class="o">-</span>test)
<span class="k">use</span> txf_ki<span class="m">.</span>dta,<span class="k"> clear</span>
<span class="k">gen</span> fu_time=tfl_px_stat_dt<span class="o">-</span>rec_tx_dt
<span class="k">gen</span> within1yr=(<span class="nf">inlist</span>(tfl_fol_cd,<span class="m">3</span>,<span class="m">6</span>,<span class="m">10</span>)|<span class="nf">inlist</span>(tfl_fol_cd, <span class="m">800</span>,<span class="m">801</span>, <span class="m">998</span>, <span class="m">999</span>)) <span class="o">&amp;</span> fu_time<span class="o">&lt;</span><span class="m">366</span>
<span class="c1">// within1yr==1 if (1) the data was from 3, 6, 12 months post-KT or (2) death, gloss or ltfu records tha</span>
<span class="k">keep if</span> within1yr<span class="o">==</span><span class="m">1</span>
<span class="k">gen</span> ar_bin = <span class="nf">cond</span>(<span class="nf">inrange</span>(tfl_acute_rej_episode, <span class="m">1</span>, <span class="m">2</span>), <span class="m">1</span>, <span class="m">0</span>)<span class="k"> if</span> tfl_acute_rej_episode <span class="o">!=</span><span class="m">998</span> <span class="o">&amp;</span> <span class="o">!</span><span class="nf">missing</span>(
<span class="k">gen</span> ar_biopsy=(tfl_acute_rej_biopsy_confirmed<span class="o">==</span><span class="m">2</span>)
<span class="k">tab</span> ar_bin ar_biopsy
<span class="k">gen</span> ar_treat=.
<span class="k">replace</span> ar_treat=<span class="m">1</span><span class="k"> if</span> tfl_rej_treat<span class="o">==</span><span class="s">&quot;Y&quot;</span>
<span class="k">replace</span> ar_treat=<span class="m">0</span><span class="k"> if</span> tfl_rej_treat<span class="o">==</span><span class="s">&quot;N&quot;</span>
<span class="k">gen</span> ar_bin_fail=.
<span class="k">replace</span> ar_bin_fail=<span class="m">1</span><span class="k"> if</span> tfl_fail_rej_acute<span class="o">==</span><span class="s">&quot;Y&quot;</span>
<span class="k">replace</span> ar_bin_fail=<span class="m">0</span><span class="k"> if</span> tfl_fail_rej_acute<span class="o">==</span><span class="s">&quot;N&quot;</span>
<span class="k">gen</span> ar_any=<span class="nf">max</span>(ar_bin, ar_biopsy, ar_treat, ar_bin_fail)
<span class="k">collapse</span> (max) ar_any<span class="o">*</span> ar_biopsy (first) rec_tx_dt,<span class="k"> by</span>(trr_id)
<span class="c1">** ar_biopsy is only if year(rec_tx_dt)&gt;=2004 and may be if ar_any==0.</span>
<span class="k">compress</span>
<span class="k">tempfile</span> ar
<span class="k">save</span> <span class="nv">`ar&#39;</span>
<span class="k">global</span> srtrdir=<span class="s">&quot;/dcs01/igm/segevlab/data/srtr1509/public&quot;</span>
<span class="k">local</span> rejfile=<span class="s">&quot;</span><span class="vg">$srtrdir</span><span class="s">/txf_ki.dta&quot;</span>
<span class="k">use</span> <span class="nv">`rejfile&#39;</span>,<span class="k"> clear</span>
<span class="k">keep if</span> rec_tx_ty<span class="o">==</span><span class="m">1</span>   <span class="c1">//this code is only for DDKT</span>

<span class="k">gen</span> fu_time=tfl_px_stat_dt<span class="o">-</span>rec_tx_dt
<span class="k">gen</span> m6=((<span class="nf">inlist</span>(tfl_fol_cd,<span class="m">3</span>,<span class="m">6</span>)|(<span class="nf">inlist</span>(tfl_fol_cd, <span class="m">800</span>, <span class="m">998</span>, <span class="m">999</span>)) <span class="o">&amp;</span> fu_time<span class="o">&lt;</span><span class="m">183</span>))
<span class="k">gen</span> within1yr=((<span class="nf">inlist</span>(tfl_fol_cd,<span class="m">3</span>,<span class="m">6</span>,<span class="m">10</span>)|(<span class="nf">inlist</span>(tfl_fol_cd, <span class="m">800</span>,<span class="m">801</span>, <span class="m">998</span>, <span class="m">999</span>)) <span class="o">&amp;</span> fu_time<span class="o">&lt;</span><span class="m">366</span>))
<span class="c1">// within1yr==1 if (1) the data was from 3, 6, 12 months post-KT or (2) death, gloss or ltfu happened wi</span>
<span class="k">gen</span> m24=((<span class="nf">inlist</span>(tfl_fol_cd,<span class="m">3</span>,<span class="m">6</span>,<span class="m">10</span>,<span class="m">20</span>)|(<span class="nf">inlist</span>(tfl_fol_cd, <span class="m">800</span>, <span class="m">801</span>,<span class="m">998</span>, <span class="m">999</span>)) <span class="o">&amp;</span> fu_time<span class="o">&lt;</span><span class="m">731</span>))
<span class="c1">***Clinical***</span>
<span class="k">rename</span> tfl_acute_rej_episode ar
<span class="k">gen</span> ar_bin= <span class="nf">cond</span>(<span class="nf">inrange</span>(ar, <span class="m">1</span>, <span class="m">2</span>), <span class="m">1</span>, <span class="m">0</span>)<span class="k"> if</span> ar <span class="o">!=</span><span class="m">998</span> <span class="o">&amp;</span> <span class="o">!</span><span class="nf">missing</span>(ar)
<span class="k">replace</span> ar_bin=.<span class="k"> if</span> ar<span class="o">==</span><span class="m">998</span> | ar<span class="o">==</span>.
<span class="c1">***Biopsy***</span>
<span class="k">gen</span> ar_bx=tfl_acute_rej_biopsy_confirmed<span class="o">==</span><span class="m">2</span>
<span class="k">replace</span> ar_bx=<span class="m">0</span><span class="k"> if</span> tfl_acute_rej_biopsy_confirmed<span class="o">==</span><span class="m">3</span>
<span class="k">replace</span> ar_bx=.<span class="k"> if</span> tfl_acute_rej_biopsy_confirmed<span class="o">==</span><span class="m">1</span> | tfl_acute_rej_biopsy_confirmed<span class="o">==</span><span class="m">998</span> | tfl_acute_r
<span class="k">gen</span> ar_bx2=ar_bx
<span class="k">replace</span> ar_bx2=<span class="m">0</span><span class="k"> if</span> ar_bin<span class="o">==</span><span class="m">0</span> <span class="o">&amp;</span> ar_bx2<span class="o">==</span>.
<span class="k">replace</span> ar_bx2=<span class="m">1</span><span class="k"> if</span> ar_bin<span class="o">==</span><span class="m">1</span> <span class="o">&amp;</span> ar_bx2<span class="o">==</span>.
<span class="k">rename</span> tfl_rej_treat ar_treat
<span class="k">replace</span> ar_treat = <span class="s">&quot;1&quot;</span><span class="k"> if</span> ar_treat<span class="o">==</span><span class="s">&quot;Y&quot;</span>
<span class="k">replace</span> ar_treat = <span class="s">&quot;0&quot;</span><span class="k"> if</span> ar_treat<span class="o">==</span><span class="s">&quot;N&quot;</span>
<span class="k">replace</span> ar_treat = <span class="s">&quot;&quot;</span><span class="k"> if</span> ar_treat<span class="o">==</span><span class="s">&quot;U&quot;</span>
<span class="k">destring</span> ar_treat,<span class="k"> replace</span>
<span class="k">gen</span> ar_bin_treat=(ar_bin<span class="o">==</span><span class="m">1</span> | ar_treat<span class="o">==</span><span class="m">1</span>)
<span class="k">replace</span> ar_bin_treat=.<span class="k"> if</span> ar_bin<span class="o">==</span>. <span class="o">&amp;</span> ar_treat<span class="o">==</span>.
<span class="k">saveold</span> <span class="vg">$hcvdir</span><span class="o">/</span>temp0 ,replace
<span class="c1">***Within 6 months***</span>
<span class="k">use</span> <span class="vg">$hcvdir</span><span class="o">/</span>temp0 ,clear
<span class="k">collapse</span> (max) ar_bin_treat ar_bx ar_bx2 ar_bin,<span class="k"> by</span>(trr_id m6)
<span class="k">keep if</span> m6<span class="o">==</span><span class="m">1</span>
<span class="k">drop</span> m6
<span class="k">rename</span> ar_bin ar_bin_6m
<span class="k">rename</span> ar_bx ar_bx_6m
<span class="k">rename</span> ar_bx2 ar_bx2_6m
<span class="k">rename</span> ar_bin_treat ar_bin_treat_6m
<span class="k">label var</span> ar_bin_6m <span class="s">&quot;AR in 6 months, binary&quot;</span>
<span class="k">label</span> define ar_bin_6m <span class="m">0</span> <span class="s">&quot;N&quot;</span> <span class="m">1</span> <span class="s">&quot;Y&quot;</span>
<span class="k">label</span> values ar_bin_6m ar_bin_6m
<span class="k">label var</span> ar_bx_6m <span class="s">&quot;AR by Bx in 6 months&quot;</span>
<span class="k">label</span> define ar_bx_6m <span class="m">0</span> <span class="s">&quot;N&quot;</span> <span class="m">1</span> <span class="s">&quot;Y&quot;</span>
<span class="k">label</span> values ar_bx_6m ar_bx_6m
<span class="k">label var</span> ar_bx2_6m <span class="s">&quot;AR by Bx 6 months(missing values filled in by ar_bin)&quot;</span>


<span class="k">label</span> define ar_bx2_6m <span class="m">0</span> <span class="s">&quot;N&quot;</span> <span class="m">1</span> <span class="s">&quot;Y&quot;</span>
<span class="k">label</span> values ar_bx2_6m ar_bx2_6m
<span class="k">label var</span> ar_bin_treat_6m <span class="s">&quot;AR clinically diagnosed or treated in 6 months&quot;</span>
<span class="k">label</span> define ar_bin_treat_6m <span class="m">0</span> <span class="s">&quot;No&quot;</span> <span class="m">1</span> <span class="s">&quot;Yes&quot;</span>
<span class="k">label</span> values ar_bin_treat_6m ar_bin_treat_6m
<span class="k">saveold</span> <span class="vg">$hcvdir</span><span class="o">/</span>temp1 ,replace
<span class="c1">***Within 1 year***</span>
<span class="k">use</span> <span class="vg">$hcvdir</span><span class="o">/</span>temp0 ,clear
<span class="k">collapse</span> (max) ar_bin_treat ar_bx ar_bx2 ar_bin,<span class="k"> by</span>(trr_id within1yr)
<span class="k">keep if</span> within1yr<span class="o">==</span><span class="m">1</span>
<span class="k">drop</span> within1yr
<span class="k">rename</span> ar_bin ar_bin_1y
<span class="k">rename</span> ar_bx ar_bx_1y
<span class="k">rename</span> ar_bx2 ar_bx2_1y
<span class="k">rename</span> ar_bin_treat ar_bin_treat_1y
<span class="k">label var</span> ar_bin_1y <span class="s">&quot;AR during 1st year, binary&quot;</span>
<span class="k">label</span> define ar_bin_1y <span class="m">0</span> <span class="s">&quot;N&quot;</span> <span class="m">1</span> <span class="s">&quot;Y&quot;</span>
<span class="k">label</span> values ar_bin_1y ar_bin_1y
<span class="k">label var</span> ar_bx_1y <span class="s">&quot;AR by Bx during 1st year&quot;</span>
<span class="k">label</span> define ar_bx_1y <span class="m">0</span> <span class="s">&quot;N&quot;</span> <span class="m">1</span> <span class="s">&quot;Y&quot;</span>
<span class="k">label</span> values ar_bx_1y ar_bx_1y
<span class="k">label var</span> ar_bx2_1y <span class="s">&quot;AR by Bx 1st year (missing values filled in by ar_bin0)&quot;</span>
<span class="k">label</span> define ar_bx2_1y <span class="m">0</span> <span class="s">&quot;N&quot;</span> <span class="m">1</span> <span class="s">&quot;Y&quot;</span>
<span class="k">label</span> values ar_bx2_1y ar_bx2_1y
<span class="k">label var</span> ar_bin_treat_1y <span class="s">&quot;AR clinically diagnosed or treated in 1st year&quot;</span>
<span class="k">label</span> define ar_bin_treat_1y <span class="m">0</span> <span class="s">&quot;No&quot;</span> <span class="m">1</span> <span class="s">&quot;Yes&quot;</span>
<span class="k">label</span> values ar_bin_treat_1y ar_bin_treat_1y
<span class="k">saveold</span> <span class="vg">$hcvdir</span><span class="o">/</span>temp2 ,replace
<span class="c1">***Within 2 years***</span>
<span class="k">use</span> <span class="vg">$hcvdir</span><span class="o">/</span>temp0 ,clear
<span class="k">collapse</span> (max) ar_bin_treat ar_bx ar_bx2 ar_bin,<span class="k"> by</span>(trr_id m24)
<span class="k">keep if</span> m24<span class="o">==</span><span class="m">1</span>
<span class="k">drop</span> m24
<span class="k">rename</span> ar_bin ar_bin_2y
<span class="k">rename</span> ar_bx ar_bx_2y
<span class="k">rename</span> ar_bx2 ar_bx2_2y
<span class="k">rename</span> ar_bin_treat ar_bin_treat_2y
<span class="k">label var</span> ar_bin_2y <span class="s">&quot;AR in 2 years, binary&quot;</span>
<span class="k">label</span> define ar_bin_2y <span class="m">0</span> <span class="s">&quot;N&quot;</span> <span class="m">1</span> <span class="s">&quot;Y&quot;</span>
<span class="k">label</span> values ar_bin_2y ar_bin_2y


<span class="k">label var</span> ar_bx_2y <span class="s">&quot;AR by Bx in 2 years&quot;</span>
<span class="k">label</span> define ar_bx_2y <span class="m">0</span> <span class="s">&quot;N&quot;</span> <span class="m">1</span> <span class="s">&quot;Y&quot;</span>
<span class="k">label</span> values ar_bx_2y ar_bx_2y
<span class="k">label var</span> ar_bx2_2y <span class="s">&quot;AR by Bx 2 yearss(missing values filled in by ar_bin)&quot;</span>
<span class="k">label</span> define ar_bx2_2y <span class="m">0</span> <span class="s">&quot;N&quot;</span> <span class="m">1</span> <span class="s">&quot;Y&quot;</span>
<span class="k">label</span> values ar_bx2_2y ar_bx2_2y
<span class="k">label var</span> ar_bin_treat_2y <span class="s">&quot;AR clinically diagnosed or treated in 2 years&quot;</span>
<span class="k">label</span> define ar_bin_treat_2y <span class="m">0</span> <span class="s">&quot;No&quot;</span> <span class="m">1</span> <span class="s">&quot;Yes&quot;</span>
<span class="k">label</span> values ar_bin_treat_2y ar_bin_treat_2y
<span class="k">saveold</span> <span class="vg">$hcvdir</span><span class="o">/</span>temp3 ,replace
<span class="c1">***Clinical AR outcome for the entire F/U period***</span>
<span class="k">use</span> <span class="vg">$hcvdir</span><span class="o">/</span>temp0 ,clear
<span class="k">collapse</span> (max) ar_bin_treat ar_bx ar_bx2 ar_bin,<span class="k"> by</span>(trr_id)
<span class="k">rename</span> ar_bin ar_bin_ever
<span class="k">label var</span> ar_bin_ever <span class="s">&quot;AR binary(ever)&quot;</span>
<span class="k">label</span> define ar_bin_ever <span class="m">0</span> <span class="s">&quot;N&quot;</span> <span class="m">1</span> <span class="s">&quot;Y&quot;</span>
<span class="k">label</span> values ar_bin_ever ar_bin_ever
<span class="k">rename</span> ar_bx ar_bx_ever
<span class="k">label var</span> ar_bx_ever <span class="s">&quot;AR by Bx(ever)&quot;</span>
<span class="k">label</span> define ar_bx_ever <span class="m">0</span> <span class="s">&quot;N&quot;</span> <span class="m">1</span> <span class="s">&quot;Y&quot;</span>
<span class="k">label</span> values ar_bx_ever ar_bx_ever
<span class="k">rename</span> ar_bx2 ar_bx2_ever
<span class="k">label var</span> ar_bx2_ever <span class="s">&quot;AR by Bx(ever,adjusted by ar_bin)&quot;</span>
<span class="k">label</span> define ar_bx2_ever <span class="m">0</span> <span class="s">&quot;N&quot;</span> <span class="m">1</span> <span class="s">&quot;Y&quot;</span>
<span class="k">label</span> values ar_bx2_ever ar_bx2_ever
<span class="k">rename</span> ar_bin_treat ar_bin_treat_ever
<span class="k">label var</span> ar_bin_treat_ever <span class="s">&quot;AR ever diagnosed or treated&quot;</span>
<span class="k">label</span> define ar_bin_treat_ever <span class="m">0</span> <span class="s">&quot;N&quot;</span> <span class="m">1</span> <span class="s">&quot;Y&quot;</span>
<span class="k">label</span> values ar_bin_treat_ever ar_bin_treat_ever
<span class="k">saveold</span> <span class="vg">$hcvdir</span><span class="o">/</span>temp4 ,replace
<span class="c1">****Merging AR variables****</span>
<span class="k">use</span> <span class="vg">$hcvdir</span><span class="o">/</span>temp4 ,clear
<span class="k">merge</span> <span class="m">1</span>:<span class="m">1</span> trr_id using <span class="vg">$hcvdir</span><span class="o">/</span>temp1 ,keep(master match) nogen
<span class="k">merge</span> <span class="m">1</span>:<span class="m">1</span> trr_id using <span class="vg">$hcvdir</span><span class="o">/</span>temp2 ,keep(master match) nogen
<span class="k">merge</span> <span class="m">1</span>:<span class="m">1</span> trr_id using <span class="vg">$hcvdir</span><span class="o">/</span>temp3 ,keep(master match) nogen
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="racial-category">
<h2>6. Racial category<a class="headerlink" href="#racial-category" title="Permalink to this heading">#</a></h2>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">// -----------------------------------</span>
<span class="c1">// Racial category- donor &amp; recipient similar</span>
<span class="c1">// -----------------------------------</span>

<span class="k">gen</span> rec_race3=<span class="m">0</span>
<span class="k">replace</span> rec_race3=<span class="m">1</span><span class="o">*</span>(can_race<span class="o">==</span><span class="m">16</span>)<span class="o">+</span><span class="m">2</span><span class="o">*</span>(can_race<span class="o">==</span><span class="m">2000</span>)
<span class="k">replace</span> rec_race3=.<span class="k"> if</span> <span class="nf">missing</span>(can_race)
<span class="k">label var</span> rec_race3 <span class="s">&quot;Recipient&#39;s race&quot;</span>
<span class="k">label</span> define rec_race3 <span class="m">0</span> <span class="s">&quot;Non-AA,non-Hispanic&quot;</span> <span class="m">1</span> <span class="s">&quot;AA&quot;</span> <span class="m">2</span> <span class="s">&quot;Hispanic&quot;</span>
<span class="k">label</span> values rec_race3 rec_race3

<span class="k">gen</span> can_race_simple=.
<span class="k">replace</span> can_race_simple=<span class="m">1</span><span class="k"> if</span> can_race<span class="o">==</span><span class="m">8</span>
<span class="k">replace</span> can_race_simple=<span class="m">2</span><span class="k"> if</span> can_race<span class="o">==</span><span class="m">16</span>
<span class="k">replace</span> can_race_simple=<span class="m">3</span><span class="k"> if</span> can_race<span class="o">==</span><span class="m">2000</span>
<span class="k">replace</span> can_race_simple=<span class="m">4</span><span class="k"> if</span> <span class="o">!</span><span class="nf">inlist</span>(can_race,<span class="m">8</span>,<span class="m">16</span>,<span class="m">2000</span>) <span class="o">&amp;</span> can_race<span class="o">!=</span>.
<span class="k">label</span> variable can_race_simple <span class="s">&quot;Patient/s simplified race&quot;</span>
<span class="k">label</span> define can_race_simple <span class="m">1</span> <span class="s">&quot;White&quot;</span> <span class="m">2</span> <span class="s">&quot;African American&quot;</span> <span class="m">3</span> <span class="s">&quot;Hispanic/Latino&quot;</span> <span class="m">4</span> <span class="s">&quot;Other/multi-racial&quot;</span>
<span class="k">label</span> values can_race_simple can_race_simple
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="pra-panel-reactive-antibody-time-varying-pra">
<h2>7. PRA (Panel Reactive Antibody), Time-varying PRA<a class="headerlink" href="#pra-panel-reactive-antibody-time-varying-pra" title="Permalink to this heading">#</a></h2>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">// -----------------------------------</span>
<span class="c1">// PRA (Panel Reactive Antibody)</span>
<span class="c1">// -----------------------------------</span>

<span class="c1">****SRTR****</span>
<span class="k">gen</span> rec_peak_pra_con_srtr=can_last_srtr_peak_pra
<span class="k">label var</span> rec_peak_pra_con_srtr <span class="s">&quot;Peak PRA continuous, per SRTR&quot;</span>
<span class="c1">*Peak PRA continuous,manually calculated*</span>
<span class="k">egen</span> rec_peak_pra_con_recode=rowmax(rec_pra_most_recent can_last_srtr_peak_pra can_last_alloc_pra can_la
<span class="k">label var</span> rec_peak_pra_con_recode <span class="s">&quot;Peak PRA continuous, manually recoded&quot;</span>
<span class="c1">****Highly sensitized, 80% cut off****</span>
<span class="k">gen</span> rec_pra80=(rec_peak_pra_con_recode<span class="o">&gt;</span><span class="m">80</span>)
<span class="k">replace</span> rec_pra80=.<span class="k"> if</span> <span class="nf">missing</span>(rec_peak_pra_con_recode)
<span class="k">label var</span> rec_pra80 <span class="s">&quot;Recipient recoded peak PRA&gt;80%&quot;</span>
<span class="k">label</span> define rec_pra80 <span class="m">0</span> <span class="s">&quot;No&quot;</span> <span class="m">1</span> <span class="s">&quot;Yes&quot;</span>
<span class="k">label</span> values rec_pra80 rec_pra80
</pre></div>
</div>
<hr class="docutils" />
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">// time varying PRA for candidate (maximum PRA within period) Use for candidate time</span>
<span class="c1">//categories used in match run (KAS) 0, 1-9, 10-19,20-29,30-39,40-49,...80-89,90-94,95,96,97,98,99,100</span>
<span class="c1">//convenient cutoffs binary at 80 (SRTR-way),</span>
<span class="c1">// -------------------------------------------------</span>
<span class="c1">// Time-varying PRA history for candidate time</span>
<span class="c1">// from pra_hist.dta</span>
<span class="c1">//</span>
<span class="c1">// before 2009: use max of !cPRA</span>
<span class="c1">// 2009 - 2010: use max of all 4 PRAs</span>
<span class="c1">// 2011 onward: use cPRA</span>
<span class="c1">//</span>
<span class="c1">// written by Xun Luo, commentary by Eric Chow 2016</span>
<span class="c1">// -------------------------------------------------</span>
<span class="k">use</span> <span class="s">&quot;~/srtr1603/pra_hist.dta&quot;</span>,<span class="k"> clear</span>
<span class="k">replace</span> canhx_cpra=<span class="nf">round</span>(<span class="m">100</span><span class="o">*</span>canhx_cpra) <span class="c1">// make it out of 100</span>
<span class="c1">// keep certain variables (3 PRA variables, and cPRA)</span>
<span class="k">keep</span> px_id     canhx_begin_dt canhx_end_dt  <span class="cs">///</span>
               canhx_srtr_peak_pra canhx_cur_pra canhx_alloc_pra <span class="cs">///</span>
               canhx_cpra
<span class="c1">// because we all enjoy order in our lives</span>
<span class="k">sort</span> px_id canhx_begin_dt
<span class="c1">// check that histories are time-contiguous and not missing</span>
<span class="k">assert</span> canhx_begin_dt <span class="o">==</span> canhx_end_dt[_n<span class="m">-1</span>]<span class="o">+</span><span class="m">1</span><span class="k"> if</span> px_id<span class="o">==</span>px_id[_n<span class="m">-1</span>]
<span class="k">assert</span> <span class="o">!</span><span class="nf">mi</span>(canhx_begin_dt)
<span class="c1">// create a history end-date (1603 censorship)</span>
<span class="k">replace</span> canhx_end_dt = <span class="nf">min</span>(canhx_end_dt,<span class="nf">td</span>(31aug2015))
<span class="c1">// drop if the history begins after the censor date</span>
<span class="m">13</span>
<span class="k">drop if</span> canhx_begin_dt <span class="o">&gt;</span> canhx_end_dt
<span class="k">sort</span> px_id canhx_begin_dt <span class="c1">// because entropy</span>
<span class="c1">// use max of all 4 PRA&#39;s if 2009-2010</span>
<span class="k">gen</span> pra_all_prahx = <span class="nf">max</span>(canhx_srtr_peak_pra,canhx_cur_pra,canhx_alloc_pra,canhx_cpra)
<span class="k">gen</span> pra_09all_prahx = pra_all_prahx
<span class="c1">// use max of 3 PRA&#39;s if 2008 and before</span>
<span class="k">replace</span> pra_09all_prahx=<span class="nf">max</span>(canhx_srtr_peak_pra,canhx_cur_pra,canhx_alloc_pra)<span class="k"> if</span> <span class="nf">year</span>(canhx_begin_dt)<span class="o">&lt;</span><span class="m">2</span>
<span class="c1">// use cPRA if 2011 and onwards</span>
<span class="k">gen</span> pra_09all_11c_prahx=pra_09all_prahx
<span class="k">replace</span> pra_09all_11c_prahx=canhx_cpra<span class="k"> if</span> <span class="nf">year</span>(canhx_begin_dt)<span class="o">&gt;=</span><span class="m">2011</span>
<span class="c1">// the patient + history should be unique</span>
<span class="k">isid</span> px_id canhx_begin_dt
<span class="c1">// keep the px_id, history range, and composite PRA</span>
<span class="k">keep</span> px_id canhx_begin_dt canhx_end_dt pra_09all_11c_prahx
<span class="c1">// check contiguity again</span>
<span class="k">assert</span> canhx_begin_dt <span class="o">==</span> canhx_end_dt[_n<span class="m">-1</span>]<span class="o">+</span><span class="m">1</span><span class="k"> if</span> px_id<span class="o">==</span>px_id[_n<span class="m">-1</span>]
<span class="k">assert</span> <span class="m">1</span><span class="o">==</span><span class="m">0</span>
<span class="c1">// save it to file</span>
<span class="k">compress</span>
<span class="k">saveold</span> pra_hist_composite, v(<span class="m">12</span>)<span class="k"> replace</span>
<span class="c1">// fin</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="kidney-disease-etiology-diagnosis">
<h2>8. Kidney disease etiology/diagnosis<a class="headerlink" href="#kidney-disease-etiology-diagnosis" title="Permalink to this heading">#</a></h2>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">// -----------------------------------</span>
<span class="c1">// kidney disease etiology</span>
<span class="c1">// -----------------------------------</span>
HTN, GN, DM, PKD, Other
<span class="k">gen</span> dgn = <span class="m">0</span> <span class="c1">// other</span>
<span class="c1">// DM</span>
<span class="k">replace</span> dgn = <span class="m">1</span><span class="k"> if</span> <span class="nf">inlist</span>(can_dgn, <span class="m">3011</span>, <span class="m">3012</span>, <span class="m">3038</span>, <span class="m">3039</span>, <span class="m">3069</span>, <span class="m">3070</span>, <span class="m">3071</span>)
<span class="c1">// HTN</span>
<span class="k">replace</span> dgn = <span class="m">2</span><span class="k"> if</span> can_dgn <span class="o">==</span> <span class="m">3040</span>
<span class="c1">// PKD</span>
<span class="k">replace</span> dgn = <span class="m">3</span><span class="k"> if</span> can_dgn <span class="o">==</span> <span class="m">3008</span>
<span class="c1">// FSGS</span>
<span class="k">replace</span> dgn = <span class="m">4</span><span class="k"> if</span> can_dgn <span class="o">==</span> <span class="m">3006</span>
<span class="c1">// GN</span>
<span class="k">replace</span> dgn = <span class="m">5</span><span class="k"> if</span> can_dgn <span class="o">==</span> <span class="m">3001</span> | can_dgn <span class="o">==</span> <span class="m">3041</span>
<span class="c1">// IGA</span>
<span class="k">replace</span> dgn = <span class="m">6</span><span class="k"> if</span> can_dgn <span class="o">==</span> <span class="m">3004</span>
<span class="m">2</span>.
<span class="k">gen</span> rec_dx4=<span class="m">3</span>
<span class="k">replace</span> rec_dx4=<span class="m">0</span><span class="k"> if</span> <span class="nf">inlist</span>(rec_dgn,<span class="m">3000</span>,<span class="m">3001</span>,<span class="m">3002</span>,<span class="m">3003</span>,<span class="m">3004</span>,<span class="m">3005</span>,<span class="m">3006</span>,<span class="m">3016</span>,<span class="m">3018</span>,<span class="m">3024</span>,<span class="m">3029</span>,<span class="m">3031</span>,<span class="m">3033</span>,<span class="m">303</span>
<span class="m">18</span>
<span class="k">replace</span> rec_dx4=<span class="m">1</span><span class="k"> if</span> <span class="nf">inlist</span>(rec_dgn,<span class="m">3011</span>,<span class="m">3012</span>,<span class="m">3038</span>,<span class="m">3039</span>,<span class="m">3069</span>,<span class="m">3070</span>,<span class="m">3071</span>)
<span class="k">replace</span> rec_dx4=<span class="m">2</span><span class="k"> if</span> rec_dgn<span class="o">==</span><span class="m">3040</span>
<span class="k">replace</span> rec_dx4=.<span class="k"> if</span> rec_dgn<span class="o">==</span>.
<span class="k">label var</span> rec_dx4 <span class="s">&quot;Recipient&#39;s Dx,4 categories&quot;</span>
<span class="k">label</span> define rec_dx4 <span class="m">0</span> <span class="s">&quot;Glomerulonephritis&quot;</span> <span class="m">1</span> <span class="s">&quot;DMN&quot;</span> <span class="m">2</span> <span class="s">&quot;HTN&quot;</span> <span class="m">3</span> <span class="s">&quot;Everything else&quot;</span>
<span class="k">label</span> values rec_dx4 rec_dx4

<span class="k">recode</span> can_dgn (<span class="m">3011</span> <span class="m">3012</span> <span class="m">3039</span> <span class="m">3069</span> <span class="m">3070</span> <span class="m">3071</span> = <span class="m">1</span> <span class="s">&quot;dgn-DM&quot;</span>) <span class="cs">///</span>
    (<span class="m">3034</span> <span class="m">3040</span> <span class="m">3051</span> = <span class="m">2</span> <span class="s">&quot;dgn-htn&quot;</span>) <span class="cs">///</span>
    (<span class="m">3008</span> = <span class="m">3</span> <span class="s">&quot;dgn-PKD&quot;</span>) <span class="cs">///</span>
    (<span class="m">3050</span> <span class="m">3053</span> <span class="m">3055</span> <span class="m">3066</span>  <span class="cs">///</span>
    <span class="m">999</span> <span class="m">3007</span> <span class="m">3009</span> <span class="m">3010</span> <span class="m">3013</span> <span class="m">3014</span> <span class="m">3015</span> <span class="m">3017</span> <span class="m">3020</span> <span class="m">3021</span> <span class="m">3022</span> <span class="m">3023</span> <span class="m">3025</span> <span class="m">3026</span> <span class="cs">///</span>
        <span class="m">3027</span> <span class="m">3028</span> <span class="m">3030</span> <span class="m">3032</span> <span class="m">3036</span> <span class="m">3044</span> <span class="m">3045</span> <span class="m">3046</span> <span class="m">3047</span> <span class="m">3048</span> <span class="m">3049</span> <span class="m">3052</span> <span class="m">3056</span> <span class="cs">///</span>
        <span class="m">3057</span> <span class="m">3058</span> <span class="m">3059</span> <span class="m">3060</span> <span class="m">3063</span> = <span class="m">4</span> <span class="s">&quot;dgn-oth&quot;</span>) <span class="cs">///</span>
    (<span class="o">*</span> = <span class="m">0</span> <span class="s">&quot;dgn-glomerular&quot;</span>),<span class="k"> gen</span>(can_dgn2)
<span class="k">drop</span> can_dgn
<span class="k">rename</span> can_dgn2 can_dgn

<span class="c1">// Right now it&#39;s essentially the same thing as option 2 but this gives you convenience if you want t</span>
<span class="cm">/* Cause of ESRD */</span>
<span class="k">gen</span> cause=<span class="m">0</span>
<span class="k">replace</span> cause=<span class="m">1</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3000</span>
<span class="k">replace</span> cause=<span class="m">1</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3001</span>
<span class="k">replace</span> cause=<span class="m">1</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3002</span>
<span class="k">replace</span> cause=<span class="m">1</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3003</span>
<span class="k">replace</span> cause=<span class="m">1</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3004</span>
<span class="k">replace</span> cause=<span class="m">1</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3005</span>
<span class="k">replace</span> cause=<span class="m">1</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3006</span>
<span class="k">replace</span> cause=<span class="m">1</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3016</span>
<span class="k">replace</span> cause=<span class="m">1</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3018</span>
<span class="k">replace</span> cause=<span class="m">1</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3024</span>
<span class="k">replace</span> cause=<span class="m">1</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3029</span>
<span class="k">replace</span> cause=<span class="m">1</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3031</span>
<span class="k">replace</span> cause=<span class="m">1</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3033</span>
<span class="k">replace</span> cause=<span class="m">1</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3035</span>
<span class="k">replace</span> cause=<span class="m">1</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3041</span>
<span class="k">replace</span> cause=<span class="m">1</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3042</span>
<span class="k">replace</span> cause=<span class="m">1</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3043</span>
<span class="k">replace</span> cause=<span class="m">1</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3054</span>
<span class="k">replace</span> cause=<span class="m">1</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3067</span>
<span class="k">replace</span> cause=<span class="m">2</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3011</span>
<span class="k">replace</span> cause=<span class="m">2</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3012</span>
<span class="k">replace</span> cause=<span class="m">2</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3038</span>
<span class="k">replace</span> cause=<span class="m">2</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3039</span>
<span class="k">replace</span> cause=<span class="m">2</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3069</span>
<span class="k">replace</span> cause=<span class="m">2</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3070</span>
<span class="k">replace</span> cause=<span class="m">2</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3071</span>
<span class="k">replace</span> cause=<span class="m">3</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3008</span>
<span class="k">replace</span> cause=<span class="m">4</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3040</span>
<span class="k">replace</span> cause=<span class="m">5</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3019</span>
<span class="k">replace</span> cause=<span class="m">5</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3034</span>
<span class="k">replace</span> cause=<span class="m">5</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3050</span>
<span class="k">replace</span> cause=<span class="m">5</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3051</span>
<span class="k">replace</span> cause=<span class="m">5</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3053</span>
<span class="k">replace</span> cause=<span class="m">5</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3055</span>


<span class="k">replace</span> cause=<span class="m">6</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3010</span>
<span class="k">replace</span> cause=<span class="m">6</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3014</span>
<span class="k">replace</span> cause=<span class="m">6</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3015</span>
<span class="k">replace</span> cause=<span class="m">6</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3025</span>
<span class="k">replace</span> cause=<span class="m">6</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3028</span>
<span class="k">replace</span> cause=<span class="m">6</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3036</span>
<span class="k">replace</span> cause=<span class="m">6</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3052</span>
<span class="k">replace</span> cause=<span class="m">6</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3061</span>
<span class="k">replace</span> cause=<span class="m">7</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3007</span>
<span class="k">replace</span> cause=<span class="m">7</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3009</span>
<span class="k">replace</span> cause=<span class="m">7</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3013</span>
<span class="k">replace</span> cause=<span class="m">7</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3017</span>
<span class="k">replace</span> cause=<span class="m">7</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3026</span>
<span class="k">replace</span> cause=<span class="m">7</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3027</span>
<span class="k">replace</span> cause=<span class="m">7</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3030</span>
<span class="k">replace</span> cause=<span class="m">7</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3044</span>
<span class="k">replace</span> cause=<span class="m">7</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3045</span>
<span class="k">replace</span> cause=<span class="m">7</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3046</span>
<span class="k">replace</span> cause=<span class="m">7</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3047</span>
<span class="k">replace</span> cause=<span class="m">7</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3048</span>
<span class="k">replace</span> cause=<span class="m">7</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3049</span>
<span class="k">replace</span> cause=<span class="m">7</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3057</span>
<span class="k">replace</span> cause=<span class="m">7</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3059</span>
<span class="k">replace</span> cause=<span class="m">7</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3060</span>
<span class="k">replace</span> cause=<span class="m">7</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3063</span>
<span class="k">replace</span> cause=<span class="m">8</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3020</span>
<span class="k">replace</span> cause=<span class="m">8</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3021</span>
<span class="k">replace</span> cause=<span class="m">8</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3022</span>
<span class="k">replace</span> cause=<span class="m">8</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3023</span>
<span class="k">replace</span> cause=<span class="m">8</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3058</span>
<span class="k">replace</span> cause=<span class="m">9</span><span class="k"> if</span> can_dgn<span class="o">==</span><span class="m">3037</span>
<span class="k">replace</span> cause=<span class="m">10</span><span class="k"> if</span> <span class="o">!</span><span class="nf">inlist</span>(cause,<span class="m">1</span>,<span class="m">2</span>,<span class="m">4</span>)
<span class="k">label</span> define cause <span class="m">1</span> <span class="s">&quot;GN&quot;</span> <span class="m">2</span> <span class="s">&quot;DM&quot;</span> <span class="m">4</span> <span class="s">&quot;HTN&quot;</span> <span class="m">10</span> <span class="s">&quot;Others&quot;</span>
<span class="k">label</span> values cause cause
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="fix-abo-abo-mismatch">
<h2>9. Fix ABO/ABO mismatch<a class="headerlink" href="#fix-abo-abo-mismatch" title="Permalink to this heading">#</a></h2>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">// -----------------------------------</span>
<span class="c1">// fix ABO</span>
<span class="c1">// -----------------------------------</span>
<span class="c1">// fix A1, A2 to A for bloodtype</span>
<span class="k">foreach</span> v of<span class="k"> varlist</span> don_abo can_abo {
<span class="k">    replace</span> <span class="nv">`v&#39;</span> = <span class="s">&quot;AB&quot;</span><span class="k"> if</span> <span class="nf">inlist</span>(<span class="nv">`v&#39;</span>, <span class="s">&quot;A1B&quot;</span>, <span class="s">&quot;A2B&quot;</span>)
<span class="k">    replace</span> <span class="nv">`v&#39;</span> = <span class="s">&quot;A&quot;</span><span class="k"> if</span> <span class="nf">inlist</span>(<span class="nv">`v&#39;</span>, <span class="s">&quot;A1&quot;</span>, <span class="s">&quot;A2&quot;</span>)
}
<span class="k"> encode</span> can_abo,gen(cand_abo)
<span class="k">encode</span> don_abo,gen(donor_abo) <span class="c1">//makes them numeric with approp. value labels</span>
</pre></div>
</div>
<hr class="docutils" />
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">// -------------------------------------------</span>
<span class="c1">// ABO mismatch</span>
<span class="c1">// -------------------------------------------</span>
<span class="k">gen</span> aboi=<span class="m">0</span>
<span class="k">replace</span> aboi=<span class="m">1</span><span class="k"> if</span> (<span class="nf">inlist</span>(don_abo, <span class="s">&quot;A&quot;</span>, <span class="s">&quot;A1&quot;</span>, <span class="s">&quot;A2&quot;</span>, <span class="s">&quot;B&quot;</span>, <span class="s">&quot;AB&quot;</span>, <span class="s">&quot;A1B&quot;</span>, <span class="s">&quot;A2B&quot;</span>) <span class="o">&amp;</span> can_abo<span class="o">==</span><span class="s">&quot;O&quot;</span>) | <span class="cs">///</span>
                  (<span class="nf">inlist</span>(don_abo, <span class="s">&quot;B&quot;</span>, <span class="s">&quot;AB&quot;</span>, <span class="s">&quot;A1B&quot;</span>, <span class="s">&quot;A2B&quot;</span>) <span class="o">&amp;</span> <span class="nf">inlist</span>(can_abo, <span class="s">&quot;A&quot;</span>, <span class="s">&quot;A1&quot;</span>, <span class="s">&quot;A2&quot;</span>)) | <span class="cs">///</span>
                  (<span class="nf">inlist</span>(don_abo, <span class="s">&quot;A&quot;</span>, <span class="s">&quot;A1&quot;</span>, <span class="s">&quot;A2&quot;</span>, <span class="s">&quot;AB&quot;</span>, <span class="s">&quot;A1B&quot;</span>, <span class="s">&quot;A2B&quot;</span>) <span class="o">&amp;</span> can_abo<span class="o">==</span><span class="s">&quot;B&quot;</span>)
<span class="k">replace</span> aboi=.<span class="k"> if</span> don_abo<span class="o">==</span><span class="s">&quot;UNK&quot;</span> | can_abo<span class="o">==</span><span class="s">&quot;UNK&quot;</span>
<span class="k">label var</span> aboi <span class="s">&quot;ABO incompatibility&quot;</span>
<span class="k">label</span> define aboi <span class="m">0</span> <span class="s">&quot;N&quot;</span> <span class="m">1</span> <span class="s">&quot;Y&quot;</span>
<span class="k">label</span> values aboi aboi
<span class="k">gen</span> compatible = <span class="m">0</span>
<span class="k">    replace</span> compatible = <span class="m">1</span><span class="k"> if</span> <span class="nf">inlist</span>(don_abo,<span class="s">&quot;A&quot;</span>) <span class="o">&amp;</span> <span class="nf">inlist</span>(can_abo,<span class="s">&quot;A&quot;</span>,<span class="s">&quot;A1&quot;</span>,<span class="s">&quot;A1B&quot;</span>,<span class="s">&quot;A2&quot;</span>,<span class="s">&quot;A2B&quot;</span>,<span class="s">&quot;AB&quot;</span>)
<span class="k">    replace</span> compatible = <span class="m">1</span><span class="k"> if</span> <span class="nf">inlist</span>(don_abo,<span class="s">&quot;A1&quot;</span>) <span class="o">&amp;</span> <span class="nf">inlist</span>(can_abo,<span class="s">&quot;A&quot;</span>,<span class="s">&quot;A1&quot;</span>,<span class="s">&quot;A1B&quot;</span>,<span class="s">&quot;A2&quot;</span>,<span class="s">&quot;A2B&quot;</span>,<span class="s">&quot;AB&quot;</span>)
<span class="k">    replace</span> compatible = <span class="m">1</span><span class="k"> if</span> <span class="nf">inlist</span>(don_abo,<span class="s">&quot;A1B&quot;</span>) <span class="o">&amp;</span> <span class="nf">inlist</span>(can_abo,<span class="s">&quot;A1B&quot;</span>,<span class="s">&quot;A2B&quot;</span>,<span class="s">&quot;AB&quot;</span>)
<span class="k">    replace</span> compatible = <span class="m">1</span><span class="k"> if</span> <span class="nf">inlist</span>(don_abo,<span class="s">&quot;A2&quot;</span>) <span class="o">&amp;</span> <span class="nf">inlist</span>(can_abo,<span class="s">&quot;A&quot;</span>,<span class="s">&quot;A1&quot;</span>,<span class="s">&quot;A1B&quot;</span>,<span class="s">&quot;A2&quot;</span>,<span class="s">&quot;A2B&quot;</span>,<span class="s">&quot;AB&quot;</span>)
<span class="k">    replace</span> compatible = <span class="m">1</span><span class="k"> if</span> <span class="nf">inlist</span>(don_abo,<span class="s">&quot;A2B&quot;</span>) <span class="o">&amp;</span> <span class="nf">inlist</span>(can_abo,<span class="s">&quot;A1B&quot;</span>,<span class="s">&quot;A2B&quot;</span>,<span class="s">&quot;AB&quot;</span>)
<span class="k">    replace</span> compatible = <span class="m">1</span><span class="k"> if</span> <span class="nf">inlist</span>(don_abo,<span class="s">&quot;AB&quot;</span>) <span class="o">&amp;</span> <span class="nf">inlist</span>(can_abo,<span class="s">&quot;A1B&quot;</span>,<span class="s">&quot;A2B&quot;</span>,<span class="s">&quot;AB&quot;</span>)
<span class="k">    replace</span> compatible = <span class="m">1</span><span class="k"> if</span> <span class="nf">inlist</span>(don_abo,<span class="s">&quot;B&quot;</span>) <span class="o">&amp;</span> <span class="nf">inlist</span>(can_abo,<span class="s">&quot;A1B&quot;</span>,<span class="s">&quot;A2B&quot;</span>,<span class="s">&quot;AB&quot;</span>,<span class="s">&quot;B&quot;</span>)
<span class="k">    replace</span> compatible = <span class="m">1</span><span class="k"> if</span> <span class="nf">inlist</span>(don_abo,<span class="s">&quot;O&quot;</span>) <span class="o">&amp;</span> <span class="nf">inlist</span>(can_abo,<span class="s">&quot;A&quot;</span>,<span class="s">&quot;A1&quot;</span>,<span class="s">&quot;A1B&quot;</span>,<span class="s">&quot;A2&quot;</span>,<span class="s">&quot;A2B&quot;</span>,<span class="s">&quot;AB&quot;</span>,<span class="s">&quot;O&quot;</span>,<span class="s">&quot;B</span>
<span class="k">    label var</span> compatible <span class="s">&quot;Compatible Groups&quot;</span>
<span class="c1">//A2 incompatible, population &amp; variable [pyc]</span>
<span class="k">keep if</span> <span class="nf">inlist</span>(can_abo, <span class="s">&quot;O&quot;</span>, <span class="s">&quot;B&quot;</span>)  <span class="c1">// only those transplanted with O or B</span>
<span class="c1">// drop all the truly incompatible</span>
<span class="k">tab</span> don_abo can_abo,<span class="k"> m</span>
<span class="k">drop if</span> can_abo<span class="o">==</span><span class="s">&quot;O&quot;</span> <span class="o">&amp;</span> <span class="nf">regexm</span>(don_abo, <span class="s">&quot;B&quot;</span>)  <span class="c1">// candidates O + donor with any B, incompatible</span>
<span class="k">drop if</span> <span class="nf">regexm</span>(don_abo, <span class="s">&quot;A1&quot;</span>)  <span class="c1">// considered incompatible for both O and B candidates</span>
<span class="k">drop if</span> don_abo<span class="o">==</span><span class="s">&quot;UNK&quot;</span>
<span class="k">drop if</span> <span class="nf">inlist</span>(don_abo, <span class="s">&quot;A&quot;</span>, <span class="s">&quot;AB&quot;</span>)  <span class="c1">// incompatible for both O and B candidates</span>
<span class="k">tab</span> don_abo can_abo,<span class="k"> m</span>
<span class="k">gen</span> byte a2i = <span class="cs">///</span>
    (can_abo<span class="o">==</span><span class="s">&quot;O&quot;</span> <span class="o">&amp;</span> don_abo<span class="o">==</span><span class="s">&quot;A2&quot;</span>) | <span class="cs">///</span>

(can_abo<span class="o">==</span><span class="s">&quot;B&quot;</span> <span class="o">&amp;</span> <span class="nf">inlist</span>(don_abo, <span class="s">&quot;A2&quot;</span>, <span class="s">&quot;A2B&quot;</span>))
<span class="k">    lab var</span> a2i <span class="s">&quot;A2 incompatibility indicator&quot;</span>
<span class="k">    capture lab drop</span> a2i
<span class="k">    lab</span> def a2i <span class="m">0</span> <span class="s">&quot;Compatible O &amp; B recipient&quot;</span> <span class="m">1</span> <span class="s">&quot;A2 incompatible (A2 to O/B; or A2B to B)&quot;</span>
<span class="k">    lab</span> val a2i a2i
<span class="c1">// A2 incompatible</span>
<span class="k">gen</span> incompatible = <span class="m">0</span>
<span class="k">replace</span> incompatible = <span class="m">1</span><span class="k"> if</span> <span class="nf">inlist</span>(don_abo,<span class="s">&quot;A2&quot;</span>) <span class="o">&amp;</span> <span class="nf">inlist</span>(can_abo,<span class="s">&quot;B&quot;</span>,<span class="s">&quot;O&quot;</span>)
<span class="k">replace</span> incompatible = <span class="m">2</span><span class="k"> if</span> <span class="nf">inlist</span>(don_abo,<span class="s">&quot;A2B&quot;</span>) <span class="o">&amp;</span> <span class="nf">inlist</span>(can_abo,<span class="s">&quot;B&quot;</span>)
<span class="k">label var</span> incompatible <span class="s">&quot;A2 Incompatible Groups&quot;</span>
<span class="k">label</span> define incompatible <span class="m">0</span> <span class="s">&quot;Not&quot;</span> <span class="m">1</span> <span class="s">&quot;A2 to B or O recipient&quot;</span> <span class="m">2</span> <span class="s">&quot;A2B to B recipient&quot;</span>
<span class="k">label</span> val incompatible incompatible
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="age-categories">
<h2>10. Age categories<a class="headerlink" href="#age-categories" title="Permalink to this heading">#</a></h2>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">// -----------------------------------</span>
<span class="c1">// Age category</span>
<span class="c1">// -----------------------------------</span>
<span class="c1">//Recipient Age Categories</span>
<span class="k">    gen</span> rec_age=<span class="m">0</span><span class="k"> if</span> <span class="nf">inrange</span>(rec_age_at,<span class="m">18</span>,<span class="m">44</span>)
<span class="k">      replace</span> rec_age=<span class="m">1</span><span class="k"> if</span> <span class="nf">inrange</span>(rec_age_at,<span class="m">45</span>,<span class="m">54</span>)
<span class="k">      replace</span> rec_age=<span class="m">2</span><span class="k"> if</span> <span class="nf">inrange</span>(rec_age_at,<span class="m">55</span>,<span class="m">64</span>)
<span class="k">      replace</span> rec_age=<span class="m">3</span><span class="k"> if</span> <span class="nf">inrange</span>(rec_age_at,<span class="m">65</span>,<span class="m">101</span>)
<span class="k">        lab var</span> rec_age <span class="s">&quot;Recipient Age Categories&quot;</span>gen
<span class="k">        lab</span> define RECAGE <span class="m">0</span> <span class="s">&quot;18-44&quot;</span> <span class="m">1</span> <span class="s">&quot;45-54&quot;</span> <span class="m">2</span> <span class="s">&quot;55-64&quot;</span> <span class="m">3</span> <span class="s">&quot;65+&quot;</span>
<span class="k">        lab</span> values rec_age RECAGE
<span class="c1">*For Below: Have to be careful of cut point if the original variable is truly continuous* [PC]</span>
<span class="c1">//Recipient Age Categories</span>
<span class="k">gen</span> rec_txage_cat=<span class="nf">recode</span>(rec_age_at_tx, <span class="m">17</span>, <span class="m">34</span>, <span class="m">49</span>, <span class="m">64</span>, <span class="m">101</span>)
<span class="k">        lab var</span> rec_txage_cat <span class="s">&quot;Recipient Age Categories&quot;</span>
<span class="k">    gen</span> don_age_cat=<span class="nf">recode</span>(don_age, <span class="m">17</span>, <span class="m">34</span>, <span class="m">49</span>, <span class="m">64</span>, <span class="m">101</span>)
<span class="k">        lab var</span> don_age_cat <span class="s">&quot;Donor Age Categories&quot;</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="body-mass-index-bmi">
<h2>11. Body Mass Index (BMI)<a class="headerlink" href="#body-mass-index-bmi" title="Permalink to this heading">#</a></h2>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">// -----------------------------------</span>
<span class="c1">// BMI</span>
<span class="c1">// -----------------------------------</span>

<span class="k">gen</span> rec_ht=rec_hgt_cm
<span class="k">replace</span> rec_ht=can_hgt_cm<span class="k"> if</span> rec_ht<span class="o">==</span>.
<span class="k">label var</span> rec_ht <span class="s">&quot;Recipient&#39;s ht in cm&quot;</span>
<span class="k">gen</span> rec_wt=rec_wgt_kg
<span class="k">replace</span> rec_wt=can_wgt_kg<span class="k"> if</span> rec_wt<span class="o">==</span>.
<span class="k">label var</span> rec_wt <span class="s">&quot;Recipient&#39;s wt in kg&quot;</span>
<span class="c1">*EDA showed that there were recipients with ht&lt;50cm or wt&lt;25kg, spurious*</span>
<span class="k">replace</span> rec_ht=.<span class="k"> if</span> rec_ht<span class="o">&lt;</span><span class="m">50</span>
<span class="k">replace</span> rec_wt=.<span class="k"> if</span> rec_wt<span class="o">&lt;</span><span class="m">25</span>
<span class="k">gen</span> rec_bmi2=rec_wt<span class="o">/</span>((rec_ht<span class="o">/</span><span class="m">100</span>)<span class="o">^</span><span class="m">2</span>)
<span class="k">replace</span> rec_bmi2=rec_bmi<span class="k"> if</span> rec_bmi2<span class="o">==</span>.
<span class="k">drop</span> rec_bmi
<span class="k">rename</span> rec_bmi2 rec_bmi
<span class="k">label var</span> rec_bmi <span class="s">&quot;Recipient&#39;s BMI @ Tx&quot;</span>
<span class="c1">**After data checking, decided to convert BMI&lt;14 &amp; BMI&gt;50 to missing**</span>
<span class="c1">**CHECK WITH YOUR MENTOR in terms of how you define the &quot;WEIRD&quot; BMI value cut-off!!**</span>
<span class="c1">**See bmi_check.do (by Allan) for detail**</span>
<span class="k">replace</span> rec_bmi=.<span class="k"> if</span> rec_bmi<span class="o">&lt;</span><span class="m">14</span> | (rec_bmi<span class="o">&gt;</span><span class="m">50</span> <span class="o">&amp;</span> rec_bmi<span class="o">!=</span>.)
<span class="m">3</span>
<span class="c1">*BMI categorical*</span>
<span class="k">gen</span> rec_bmi3=<span class="m">0</span><span class="o">*</span>(rec_bmi<span class="o">&lt;=</span><span class="m">25</span>)<span class="o">+</span><span class="m">1</span><span class="o">*</span>(rec_bmi<span class="o">&gt;</span><span class="m">25</span> <span class="o">&amp;</span> rec_bmi<span class="o">&lt;=</span><span class="m">30</span>)<span class="o">+</span><span class="m">2</span><span class="o">*</span>(rec_bmi<span class="o">&gt;</span><span class="m">30</span>)
<span class="k">replace</span> rec_bmi3=.<span class="k"> if</span> rec_bmi<span class="o">==</span>.
<span class="k">label var</span> rec_bmi3 <span class="s">&quot;Recipient&#39;s BMI, 3 categories&quot;</span>
<span class="k">label</span> define rec_bmi3 <span class="m">0</span> <span class="s">&quot;&lt;=25&quot;</span> <span class="m">1</span> <span class="s">&quot;(25-30]&quot;</span> <span class="m">2</span> <span class="s">&quot;&gt;30&quot;</span>
<span class="k">label</span> values rec_bmi3 rec_bmi3
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="cit-cold-ischemia-time">
<h2>12. CIT (Cold Ischemia Time)<a class="headerlink" href="#cit-cold-ischemia-time" title="Permalink to this heading">#</a></h2>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">// -----------------------------------</span>
<span class="c1">// CIT (cold ischemia time/ cold ischemic time)</span>
<span class="c1">// -----------------------------------</span>
<span class="c1">*Continuous-per hour*</span>
<span class="k">rename</span> rec_cold_isch_tm rec_cit
<span class="k">replace</span> rec_cit=.<span class="k"> if</span> rec_cit<span class="o">==</span><span class="m">99</span>
<span class="k">label var</span> rec_cit <span class="s">&quot;CIT-continuous&quot;</span>
<span class="c1">*Define categorical CIT based on distribution*</span>
<span class="k">gen</span> rec_cit3=<span class="m">0</span><span class="o">*</span>(rec_cit<span class="o">&lt;=</span><span class="m">12</span>)<span class="o">+</span><span class="m">1</span><span class="o">*</span>(rec_cit<span class="o">&gt;</span><span class="m">12</span> <span class="o">&amp;</span> rec_cit<span class="o">&lt;=</span><span class="m">24</span>)<span class="o">+</span><span class="m">2</span><span class="o">*</span>(rec_cit<span class="o">&gt;</span><span class="m">24</span>)
<span class="k">replace</span> rec_cit3=.<span class="k"> if</span> <span class="nf">missing</span>(rec_cit)
<span class="k">label var</span> rec_cit3 <span class="s">&quot;CIT, 3 categories&quot;</span>
<span class="k">label</span> define rec_cit3 <span class="m">0</span> <span class="s">&quot;&lt;=12hr&quot;</span> <span class="m">1</span> <span class="s">&quot;(12,24]hr&quot;</span> <span class="m">2</span> <span class="s">&quot;&gt;24hr&quot;</span>
<span class="k">label</span> values rec_cit3 rec_cit3
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="donor-diabetes-mellitus-dm-hypertension-htn-terminal-serum-creatinine-scr-1-5-and-manually-recode-expanded-criteria-donor-ecd-scr-assessment">
<h2>13. Donor Diabetes Mellitus (DM), Hypertension (HTN), terminal Serum Creatinine (SCr) &gt;1.5, and manually recode Expanded Criteria Donor (ECD), SCr Assessment<a class="headerlink" href="#donor-diabetes-mellitus-dm-hypertension-htn-terminal-serum-creatinine-scr-1-5-and-manually-recode-expanded-criteria-donor-ecd-scr-assessment" title="Permalink to this heading">#</a></h2>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">// -------------------------------------------</span>
<span class="c1">// Donor DM, HTN, terminal SCr&gt;1.5, and ECD recode manually</span>
<span class="c1">// -------------------------------------------</span>
<span class="c1">// definition of ECD: The expanded criteria donor (ECD) is any donor over the age of 60, or a donor over</span>
<span class="c1">// antiquated, allocation by KDPI now</span>
<span class="c1">// Note: Just use ECD! don_expand_don_ki. Compared with manual coding, consistent</span>
<span class="c1">*HTN- maximize information from don_hist_hyperten and don_htn*</span>
<span class="k">tempvar</span> don_htn1
<span class="k">gen</span> <span class="nv">`don_htn1&#39;</span>=<span class="m">0</span><span class="o">*</span>(don_hist_hyperten<span class="o">==</span><span class="m">1</span>)<span class="o">+</span><span class="m">1</span><span class="o">*</span>(<span class="nf">inrange</span>(don_hist_hyperten,<span class="m">2</span>,<span class="m">5</span>))
<span class="k">replace</span> <span class="nv">`don_htn1&#39;</span>=.<span class="k"> if</span> <span class="nf">inlist</span>(don_hist_hyperten,<span class="m">998</span>,.)
<span class="k">egen</span> don_htn_bi=rowmax(<span class="nv">`don_htn1&#39;</span> don_htn)
<span class="k">label var</span> don_htn_bi <span class="s">&quot;Donor HTN, binary&quot;</span>
<span class="k">label</span> define don_htn_bi <span class="m">0</span> <span class="s">&quot;No&quot;</span> <span class="m">1</span> <span class="s">&quot;Yes&quot;</span>
<span class="k">label</span> values don_htn_bi don_htn_bi
<span class="c1">// ****Donor died from stroke****</span>
<span class="k">gen</span> don_stroke=<span class="m">0</span><span class="o">*</span>(don_cod_don_stroke<span class="o">==</span><span class="m">0</span>)<span class="o">+</span><span class="m">1</span><span class="o">*</span>(don_cod_don_stroke<span class="o">==</span><span class="m">1</span>)
<span class="k">replace</span> don_stroke=.<span class="k"> if</span> don_cod_don_stroke<span class="o">==</span>. | don_type<span class="o">!=</span><span class="m">0</span>
<span class="k">label var</span> don_stroke <span class="s">&quot;Donor died from stroke&quot;</span>
<span class="k">label</span> define don_stroke <span class="m">0</span> <span class="s">&quot;Died from other reasons&quot;</span> <span class="m">1</span> <span class="s">&quot;Died from stroke&quot;</span>
<span class="k">label</span> values don_stroke don_stroke
<span class="m">24</span>
<span class="c1">*DM: binary*</span>
<span class="k">gen</span> don_dm=<span class="m">0</span><span class="o">*</span>(don_hist_diab<span class="o">==</span><span class="m">1</span>)<span class="o">+</span><span class="m">1</span><span class="o">*</span>(don_hist_diab<span class="o">&gt;=</span><span class="m">2</span> <span class="o">&amp;</span> don_hist_diab<span class="o">&lt;=</span><span class="m">5</span>)
<span class="k">replace</span> don_dm=.<span class="k"> if</span> <span class="nf">inlist</span>(don_hist_diab,.,<span class="m">998</span>)
<span class="k">label var</span> don_dm <span class="s">&quot;Donor DM-binary&quot;</span>
<span class="k">label</span> define don_dm <span class="m">0</span> <span class="s">&quot;No&quot;</span> <span class="m">1</span> <span class="s">&quot;Yes&quot;</span>
<span class="k">label</span> values don_dm don_dm
<span class="c1">****ECD****</span>
<span class="c1">***Coded by SRTR***</span>
<span class="k">gen</span> don_ecd_srtr=<span class="m">0</span><span class="o">*</span>(don_expand_don_ki<span class="o">==</span><span class="m">0</span>)<span class="o">+</span><span class="m">1</span><span class="o">*</span>(don_expand_don_ki<span class="o">==</span><span class="m">1</span>)
<span class="k">replace</span> don_ecd_srtr=.<span class="k"> if</span> don_type<span class="o">!=</span><span class="m">0</span>
<span class="k">label var</span> don_ecd_srtr <span class="s">&quot;ECD per SRTR&quot;</span>
<span class="k">label</span> define don_ecd_srtr <span class="m">0</span> <span class="s">&quot;SCD&quot;</span> <span class="m">1</span> <span class="s">&quot;ECD&quot;</span>
<span class="k">label</span> values don_ecd_srtr don_ecd_srtr
<span class="c1">****Manual recoding as per Port, Transplantation 2002****</span>
<span class="k">gen</span> don_ecd_recode=.
<span class="k">replace</span> don_ecd_recode=<span class="m">1</span><span class="k"> if</span> don_age<span class="o">&gt;=</span><span class="m">60</span>
<span class="k">replace</span> don_ecd_recode=<span class="m">1</span><span class="k"> if</span> <span class="nf">inrange</span>(don_age,<span class="m">50</span>,<span class="m">59</span>) <span class="o">&amp;</span> ( <span class="cs">///</span>
                            (don_stroke<span class="o">==</span><span class="m">1</span> <span class="o">&amp;</span> don_high_creat<span class="o">==</span><span class="m">1</span>) |  <span class="cs">///</span>
                            (don_stroke<span class="o">==</span><span class="m">1</span> <span class="o">&amp;</span> don_htn_bi<span class="o">==</span><span class="m">1</span>) | <span class="cs">///</span>
                            (don_high_creat<span class="o">==</span><span class="m">1</span> <span class="o">&amp;</span> don_htn_bi<span class="o">==</span><span class="m">1</span>) | <span class="cs">///</span>
                            (don_stroke<span class="o">==</span><span class="m">1</span> <span class="o">&amp;</span> don_high_creat<span class="o">==</span><span class="m">1</span> <span class="o">&amp;</span> don_htn_bi<span class="o">==</span><span class="m">1</span>) <span class="cs">///</span>
                            )
<span class="k">replace</span> don_ecd_recode=<span class="m">0</span><span class="k"> if</span> don_age<span class="o">&lt;</span><span class="m">50</span> | <span class="cs">///</span>
                            (<span class="nf">inrange</span>(don_age,<span class="m">50</span>,<span class="m">59</span>) <span class="o">&amp;</span> <span class="cs">///</span>
                            ((don_stroke<span class="o">==</span><span class="m">0</span> <span class="o">&amp;</span> don_high_creat<span class="o">==</span><span class="m">0</span>) |  <span class="cs">///</span>
                            (don_stroke<span class="o">==</span><span class="m">0</span> <span class="o">&amp;</span> don_htn_bi<span class="o">==</span><span class="m">0</span>) | <span class="cs">///</span>
                            (don_high_creat<span class="o">==</span><span class="m">0</span> <span class="o">&amp;</span> don_htn_bi<span class="o">==</span><span class="m">0</span>) | <span class="cs">///</span>
                            (don_stroke<span class="o">==</span><span class="m">0</span> <span class="o">&amp;</span> don_high_creat<span class="o">==</span><span class="m">0</span> <span class="o">&amp;</span> don_htn_bi<span class="o">==</span><span class="m">0</span>)) <span class="cs">///</span>
                            )
<span class="k">label var</span> don_ecd_recode <span class="s">&quot;ECD recoded by hand&quot;</span>
<span class="k">label</span> define don_ecd_recode <span class="m">0</span> <span class="s">&quot;No&quot;</span> <span class="m">1</span> <span class="s">&quot;Yes&quot;</span>
<span class="k">label</span> values don_ecd_recode don_ecd_recode
<span class="k">tab</span> don_ecd_srtr don_ecd_recode
</pre></div>
</div>
<hr class="docutils" />
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">// -------------------------------------------</span>
<span class="c1">// Serum Creatinine ascertainment</span>
<span class="c1">// -------------------------------------------</span>

<span class="c1">// link to donor_deceased.dta</span>
<span class="c1">// ideally want to ascertain terminal serum creatinine of donor before donation</span>

<span class="c1">// tx_ki, if missing(don_creat), fill in from donor_deceased don_creat</span>
<span class="c1">// don_creat, don_max_creat</span>

<span class="c1">// untested: needs work!!!</span>
<span class="k">gen</span> serum_cr = don_creat
<span class="k">merge m</span>:<span class="m">1</span> donor_id using donor_deceased, keepusing(don_creat? don_max etc..)
<span class="k">replace</span> serum_cr = (don_creat? don_max etc..)<span class="k"> if</span> <span class="nf">missing</span>(serum_cr)

<span class="c1">// donor scr variables from donor_deceased</span>
don_creat don_peak_serum_creat don_final_serum_creat don_alloc_ecd_serum_creat don_max_creat
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="hla-mismatch">
<h2>14. HLA mismatch<a class="headerlink" href="#hla-mismatch" title="Permalink to this heading">#</a></h2>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">// -----------------------------------</span>
<span class="c1">// HLA mismatch</span>
<span class="c1">// -----------------------------------</span>



<span class="c1">// Some notes</span>
rec_mm_equiv_tx is less complete than rec_mm_equiv_cur.
rec_mm_equiv_tx<span class="o">&lt;=</span>rec_mm_equiv_cur

<span class="c1">//Continuous HLA is not a continuous concept</span>

<span class="k">rename</span> rec_mm_equiv_tx rec_hla_mis

<span class="c1">*Binary-0 yes/no*</span>
<span class="k">gen</span> rec_hla0mis = (rec_hla_mis<span class="o">==</span><span class="m">0</span>)
<span class="k">replace</span> rec_hla0mis=.<span class="k"> if</span> rec_hla_mis<span class="o">==</span>.
<span class="k">label var</span> rec_hla0mis <span class="s">&quot;HLA 100% matched&quot;</span>
<span class="k">label</span> define rec_hla0mis <span class="m">0</span> <span class="s">&quot;HLA&lt;100% matched&quot;</span> <span class="m">1</span> <span class="s">&quot;HLA100% matched&quot;</span>
<span class="k">label</span> values rec_hla0mis rec_hla0mis

<span class="c1">// HLA mismatch level (new SRTR way)</span>
<span class="c1">// ascertain A (0,1,2 mismatch or missing), AND DR (0,1,2 mismatch, or missing)</span>
<span class="c1">// DR and A is in graft survival, and A in pt-survival (SRTR models, 2015)</span>
<span class="c1">// untested code</span>

<span class="k">gen</span> hla_A = .
<span class="k">gen</span> hla_DR = .

<span class="k">replace</span> hla_A = <span class="m">0</span><span class="k"> if</span> rec_a_mm_equiv_tx <span class="o">==</span> <span class="m">0</span>
<span class="k">replace</span> hla_A = <span class="m">1</span><span class="k"> if</span> rec_a_mm_equiv_tx <span class="o">==</span> <span class="m">1</span>
<span class="k">replace</span> hla_A = <span class="m">2</span><span class="k"> if</span> rec_a_mm_equiv_tx <span class="o">==</span> <span class="m">2</span>

<span class="k">replace</span> hla_DR = <span class="m">0</span><span class="k"> if</span> rec_dr_mm_equiv_tx <span class="o">==</span> <span class="m">0</span>
<span class="k">replace</span> hla_DR = <span class="m">1</span><span class="k"> if</span> rec_dr_mm_equiv_tx <span class="o">==</span> <span class="m">1</span>
<span class="k">replace</span> hla_DR = <span class="m">2</span><span class="k"> if</span> rec_dr_mm_equiv_tx <span class="o">==</span> <span class="m">2</span>


<span class="c1">//HLA mismatch level (old SRTR way)</span>
<span class="k">gen</span> hla = .
 <span class="c1">// 0 mismatch</span>
<span class="k">replace</span> hla=<span class="m">0</span><span class="k"> if</span> rec_dr_mm_equiv_tx <span class="o">==</span> <span class="m">0</span> <span class="o">&amp;</span> rec_b_mm_equiv_tx <span class="o">==</span> <span class="m">0</span> <span class="o">&amp;</span> rec_a_mm_equiv_tx <span class="o">==</span> <span class="m">0</span>
<span class="c1">// A/B mismatch</span>
<span class="k">replace</span> hla=<span class="m">1</span><span class="k"> if</span> rec_dr_mm_equiv_tx <span class="o">==</span> <span class="m">0</span> <span class="o">&amp;</span> <span class="nf">mi</span>(hla)
<span class="c1">// one DR mismatch</span>
<span class="k">replace</span> hla=<span class="m">2</span><span class="k"> if</span> rec_dr_mm_equiv_tx <span class="o">==</span> <span class="m">1</span>
<span class="c1">// two DR mismatch</span>
<span class="k">replace</span> hla=<span class="m">3</span><span class="k"> if</span> (rec_dr_mm_equiv_tx <span class="o">==</span> <span class="m">2</span> | rec_a_mm_equiv_tx <span class="o">!=</span> <span class="m">0</span> | rec_b_mm_equiv_tx <span class="o">!=</span> <span class="m">0</span> | rec_dr_mm_equiv_tx <span class="o">!=</span> <span class="m">0</span>) <span class="o">&amp;</span> <span class="nf">mi</span>(hla)

<span class="k">assert</span> <span class="o">!</span><span class="nf">mi</span>(hla)
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="duration-of-pre-kt-dialysis-vs-listing">
<h2>15. Duration of pre-KT dialysis (vs listing?)<a class="headerlink" href="#duration-of-pre-kt-dialysis-vs-listing" title="Permalink to this heading">#</a></h2>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">// -----------------------------------</span>
<span class="c1">// Duration of pre-KT dialysis</span>
<span class="c1">// -----------------------------------</span>
<span class="c1">*Preemptive*</span>
<span class="k">gen</span> rec_preemptive=<span class="m">0</span><span class="o">*</span>(rec_pretx_dial<span class="o">==</span><span class="s">&quot;Y&quot;</span>)<span class="o">+</span><span class="m">1</span><span class="o">*</span>(rec_pretx_dial<span class="o">==</span><span class="s">&quot;N&quot;</span>)
<span class="k">replace</span> rec_preemptive=.<span class="k"> if</span> <span class="nf">inlist</span>(rec_pretx_dial,<span class="s">&quot;U&quot;</span>,<span class="s">&quot;&quot;</span>)
<span class="k">label var</span> rec_preemptive <span class="s">&quot;Preemptive Tx&quot;</span>
<span class="k">label</span> define rec_preemptive <span class="m">0</span> <span class="s">&quot;Tx after dialysis&quot;</span> <span class="m">1</span> <span class="s">&quot;Premptive Tx&quot;</span>
<span class="k">label</span> values rec_preemptive rec_preemptive
.
<span class="c1">*Continous (based on time)*</span>
<span class="k">gen</span> rec_dial_con=(rec_tx_dt<span class="o">-</span>rec_dial_dt)<span class="o">/</span><span class="m">365.25</span>
<span class="k">replace</span> rec_dial_con=.<span class="k"> if</span> rec_dial_con<span class="o">&lt;</span><span class="m">0</span>
<span class="k">replace</span> rec_dial_con=<span class="m">0</span><span class="k"> if</span> rec_preemptive<span class="o">==</span><span class="m">1</span>
<span class="c1">// Some folks had rec_dial_con but preemptive=1. We need to account for that</span>
<span class="k">replace</span> rec_dial_con=.<span class="k"> if</span> rec_dial_con<span class="o">&gt;</span>rec_age
<span class="k">label var</span> rec_dial_con <span class="s">&quot;Time on dialysis pre-tx,in years&quot;</span>
<span class="c1">*Categorical*</span>

<span class="k">gen</span> rec_dial4=<span class="m">0</span><span class="o">*</span>(rec_premptive<span class="o">==</span><span class="m">1</span>)<span class="o">+</span><span class="m">1</span><span class="o">*</span>(rec_dial_con<span class="o">&lt;=</span><span class="m">2</span>)<span class="o">+</span><span class="m">2</span><span class="o">*</span>(rec_dial_con<span class="o">&gt;</span><span class="m">2</span> <span class="o">&amp;</span> rec_dial_con<span class="o">&lt;=</span><span class="m">6</span>)<span class="o">+</span><span class="m">3</span><span class="o">*</span>(rec_dial_
<span class="k">replace</span> rec_dial4=.<span class="k"> if</span> rec_dial_con<span class="o">==</span>.
<span class="k">label var</span> rec_dial4 <span class="s">&quot;Time on dialysis pre-KTx,categorical&quot;</span>
<span class="k">label</span> define rec_dial4 <span class="m">0</span> <span class="s">&quot;Preemptive&quot;</span> <span class="m">1</span>  <span class="s">&quot;&lt;=2yr including preemptive&quot;</span> <span class="m">2</span> <span class="s">&quot;(2-6]&quot;</span> <span class="m">3</span> <span class="s">&quot;&gt;6yr&quot;</span>
<span class="k">label</span> values rec_dial4 rec_dial4
<span class="c1">*******</span>
<span class="c1">//start with the transplant recipients</span>
<span class="k">use</span> E:\data\srtr1407\stata\kipa\tx_ki,<span class="k"> clear</span>
<span class="k">keep</span> px_id pers_id org_ty rec_tx_dt <span class="o">*</span>death<span class="o">*</span>dt rec_age_at_tx can_diab can_abo can_gender can_race tfl_gra
<span class="k">append</span> using E:\data\srtr1407\stata\kipa\tx_kp,<span class="k"> keep</span>(px_id pers_id org_ty rec_tx_dt <span class="o">*</span>death<span class="o">*</span>dt rec_age_at
<span class="k">drop if</span> org_ty<span class="o">==</span><span class="s">&quot;PA&quot;</span>
<span class="c1">//years of prior dialysis / transplant</span>
<span class="k">merge</span> <span class="m">1</span>:<span class="m">1</span> px_id using E:\data\srtr1407\stata\kipa\cand, keepusing(can_dial_dt)
<span class="k">drop if</span> _merge<span class="o">==</span><span class="m">2</span>
<span class="k">drop</span> _merge
<span class="k">gen</span> origin_dt=rec_tx_dt
<span class="k">assert</span> <span class="o">!</span><span class="nf">mi</span>(origin_dt)
<span class="k">gen</span> date=origin_dt
<span class="k">gen</span> kf = <span class="nf">min</span>(rec_tx_dt, rec_dial_dt, pers_esrd_first_dial_dt,can_dial_dt)
<span class="k">bys</span> pers_id:<span class="k"> egen</span> kfail = <span class="nf">min</span>(kf)
<span class="k">gen</span> years_rrt = origin_dt <span class="o">-</span> kfail
<span class="k">replace</span> years_rrt=<span class="m">0</span><span class="k"> if</span> years_rrt<span class="o">&lt;</span><span class="m">0</span> | <span class="nf">mi</span>(years_rrt)
<span class="c1">//merge with transplant dataset based on px_id; obtain time to graft failure</span>
<span class="k">preserve</span>
<span class="k">tempfile</span> years_kt
<span class="c1">//correct failaure date from the two dataset</span>
<span class="k">replace</span> tfl_graft_dt=tfl_graft_dt_ki<span class="k"> if</span> <span class="nf">mi</span>(tfl_graft_dt)
<span class="k">replace</span> pers_retx=pers_retxki<span class="k"> if</span> <span class="nf">mi</span>(pers_retx)
<span class="k">gen</span> gfail_dt=<span class="nf">min</span>(tfl_graft_dt,rec_esrd_fail_dt,rec_esrd_grf_fail_dt,pers_retx,rec_fail_dt,rec_resum_main
<span class="k">keep</span> pers_id rec_tx_dt gfail_dt
<span class="c1">//graft failed before transplant date is regarded as 0 transplant day</span>
<span class="k">replace</span> gfail_dt = rec_tx_dt<span class="k"> if</span> gfail_dt <span class="o">&lt;</span> rec_tx_dt
<span class="c1">//modify graft failure date by next transplant</span>
<span class="k">sort</span> pers_id rec_tx_dt
<span class="k">by</span> pers_id:<span class="k"> replace</span> gfail_dt=<span class="nf">min</span>(gfail_dt,rec_tx_dt[_n<span class="m">+1</span>])
<span class="k">by</span> pers_id:<span class="k"> gen</span> tx_n=_n
<span class="k">sum</span> tx_n
<span class="k">local n</span>=<span class="nf">r</span>(max
<span class="k">reshape</span> wide rec_tx_dt gfail_dt, i(pers_id) j(tx_n)
<span class="k">keep</span> pers_id rec_tx_dt1<span class="o">-</span>rec_tx_dt<span class="nv">`n&#39;</span> gfail_dt1<span class="o">-</span>gfail_dt<span class="nv">`n&#39;</span>
<span class="k">duplicates drop</span>
<span class="k">isid</span> pers_id
<span class="k">save</span> <span class="nv">`years_kt&#39;</span>,<span class="k"> replace</span>
<span class="k">restore</span>
<span class="k">merge m</span>:<span class="m">1</span> pers_id using <span class="nv">`years_kt&#39;</span>
<span class="k">assert</span> _merge<span class="o">==</span><span class="m">3</span>
<span class="k">drop</span> _merge
<span class="c1">//accumulate previous transplant days</span>
<span class="k">gen</span> years_kt=<span class="m">0</span>


<span class="k">forvalues</span> j= <span class="m">1</span><span class="o">/</span><span class="nv">`n&#39;</span> {
<span class="k">                    quietly replace</span> years_kt=years_kt<span class="o">+</span><span class="nf">min</span>(gfail_dt<span class="nv">`j&#39;</span>,origin_dt)<span class="o">-</span>rec_tx_dt<span class="nv">`j&#39;</span><span class="k"> if</span> origin_
}
<span class="k">replace</span> years_rrt=<span class="m">0</span><span class="k"> if</span> <span class="nf">mi</span>(years_rrt) | years_rrt<span class="o">&lt;</span><span class="m">0</span>
<span class="k">assert</span> years_rrt<span class="o">&gt;=</span>years_kt
<span class="k">isid</span> px_id
<span class="k">keep</span> px_id years_rrt years_kt
<span class="k">gen</span> years_dial=years_rrt<span class="o">-</span>years_kt
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="hepatitis-c-virus-hcv-by-diagnosis-for-candidate-by-serostatus-for-recipient-by-serostatus-for-donor">
<h2>16. Hepatitis C Virus (HCV) (by diagnosis for candidate/by serostatus for recipient/by serostatus for donor)<a class="headerlink" href="#hepatitis-c-virus-hcv-by-diagnosis-for-candidate-by-serostatus-for-recipient-by-serostatus-for-donor" title="Permalink to this heading">#</a></h2>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">// -----------------------------------</span>
<span class="c1">// Candidate HCV from Liver waitlist dgn</span>
<span class="c1">// -----------------------------------</span>
<span class="c1">//HCV among liver waitlist candidates</span>
<span class="k">    gen</span> hcv = <span class="nf">cond</span>(<span class="nf">inlist</span>(can_dgn, <span class="cs">///</span>
    <span class="m">4104</span>,<span class="m">4106</span>,<span class="m">4204</span>,<span class="m">4206</span>,<span class="m">4216</span>,<span class="m">4593</span>),<span class="m">1</span>,<span class="m">0</span>)<span class="k"> if</span> <span class="o">!</span><span class="nf">missing</span>(can_dgn)
<span class="k">    replace</span> hcv=<span class="m">1</span><span class="k"> if</span> <span class="nf">inlist</span>(can_dgn2, <span class="cs">///</span>
    <span class="m">4104</span>,<span class="m">4106</span>,<span class="m">4204</span>,<span class="m">4206</span>,<span class="m">4216</span>,<span class="m">4593</span>) <span class="o">&amp;</span> <span class="o">!</span><span class="nf">missing</span>(can_dgn2)
<span class="k">    replace</span> hcv=<span class="m">1</span><span class="k"> if</span> <span class="nf">strpos</span>(can_dgn_ost,<span class="s">&quot;HCV&quot;</span>)
<span class="k">    replace</span> hcv=<span class="m">1</span><span class="k"> if</span> <span class="nf">strpos</span>(can_dgn_ost,<span class="s">&quot;TYPE C&quot;</span>)
<span class="k">    replace</span> hcv=<span class="m">1</span><span class="k"> if</span> <span class="nf">strpos</span>(can_dgn_ost,<span class="s">&quot;HEP C&quot;</span>)
<span class="k">    replace</span> hcv=<span class="m">1</span><span class="k"> if</span> <span class="nf">strpos</span>(can_dgn_ost,<span class="s">&quot;HEPATITIS C&quot;</span>)
<span class="k">    replace</span> hcv=<span class="m">1</span><span class="k"> if</span> <span class="nf">strpos</span>(can_dgn_ost,<span class="s">&quot;HEPATITIA C&quot;</span>)
<span class="k">    replace</span> hcv=<span class="m">1</span><span class="k"> if</span> <span class="nf">strpos</span>(can_dgn_ost,<span class="s">&quot;HAPETITIS C&quot;</span>)
<span class="k">    replace</span> hcv=<span class="m">1</span><span class="k"> if</span> <span class="nf">strpos</span>(can_dgn_ost,<span class="s">&quot;HEPATITISC&quot;</span>)
<span class="k">        lab var</span> hcv <span class="s">&quot;HCV Cand. Diagnosis&quot;</span>
</pre></div>
</div>
<hr class="docutils" />
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">// -----------------------------------</span>
<span class="c1">// Recipient HCV</span>
<span class="c1">// -----------------------------------</span>
This assumes rec_hcv_stat<span class="o">==</span>.<span class="k"> as</span> HCV negative. Don&#39;t<span class="k"> do</span> this<span class="k"> if</span> HCV is<span class="k"> an</span> important variable<span class="k"> in</span> your stud
<span class="k">gen</span> rec_hcv=rec_hcv_stat<span class="o">==</span><span class="s">&quot;P&quot;</span> <span class="c1">//rec_hcv_stat: recipient HCV serostatus</span>
<span class="k">replace</span> rec_hcv=<span class="m">1</span><span class="k"> if</span> <span class="nf">inlist</span>(can_dgn, <span class="cs">///</span>
    <span class="m">4104</span>,<span class="m">4106</span>,<span class="m">4204</span>,<span class="m">4206</span>,<span class="m">4216</span>,<span class="m">4593</span>),<span class="m">1</span>,<span class="m">0</span>)<span class="k"> if</span> <span class="o">!</span><span class="nf">missing</span>(can_dgn)
<span class="k">replace</span> hcv=<span class="m">1</span><span class="k"> if</span> <span class="nf">inlist</span>(can_dgn2, <span class="cs">///</span>
    <span class="m">4104</span>,<span class="m">4106</span>,<span class="m">4204</span>,<span class="m">4206</span>,<span class="m">4216</span>,<span class="m">4593</span>) <span class="o">&amp;</span> <span class="o">!</span><span class="nf">missing</span>(can_dgn2)
<span class="m">2</span>. HCV<span class="k"> as</span> exposure
<span class="k">    gen</span> rec_hcv=<span class="nf">cond</span>(rec_hcv_stat<span class="o">==</span><span class="s">&quot;P&quot;</span>,<span class="m">1</span>,<span class="nf">cond</span>(rec_hcv_stat<span class="o">==</span><span class="s">&quot;N&quot;</span>,<span class="m">0</span>,.))
<span class="k">replace</span> rec_hcv=<span class="m">1</span><span class="k"> if</span> <span class="nf">inlist</span>(can_dgn, <span class="cs">///</span>
        <span class="m">4104</span>,<span class="m">4106</span>,<span class="m">4204</span>,<span class="m">4206</span>,<span class="m">4216</span>,<span class="m">4593</span>),<span class="m">1</span>,<span class="m">0</span>)<span class="k"> if</span> <span class="o">!</span><span class="nf">missing</span>(can_dgn)
<span class="k">replace</span> rec_hcv=<span class="m">1</span><span class="k"> if</span> <span class="nf">inlist</span>(can_dgn2, <span class="cs">///</span>
        <span class="m">4104</span>,<span class="m">4106</span>,<span class="m">4204</span>,<span class="m">4206</span>,<span class="m">4216</span>,<span class="m">4593</span>) <span class="o">&amp;</span> <span class="o">!</span><span class="nf">missing</span>(can_dgn2)
<span class="k">label var</span> rec_hcv <span class="s">&quot;Recipient HCV pos,binary&quot;</span>
<span class="k">label</span> define rec_hcv <span class="m">0</span> <span class="s">&quot;HCV neg&quot;</span> <span class="m">1</span> <span class="s">&quot;HCV pos&quot;</span>
<span class="k">label</span> values rec_hcv rec_hcv
</pre></div>
</div>
<hr class="docutils" />
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">// -----------------------------------</span>
<span class="c1">// Donor HCV</span>
<span class="c1">// -----------------------------------</span>
<span class="m">1</span>. This code assumes don_anti_hcv<span class="o">==</span>.<span class="k"> as</span> HCV(<span class="o">-</span>). Don&#39;t<span class="k"> do</span> this<span class="k"> if</span> HCV is<span class="k"> an</span> important variable<span class="k"> in</span> your<span class="k"> st</span>
<span class="k">gen</span> don_hcv=don_anti_hcv<span class="o">==</span><span class="s">&quot;P&quot;</span>
<span class="k">label var</span> don_hcv <span class="s">&quot;Donor HCV Ab&quot;</span>
<span class="k">label</span> define don_hcv <span class="m">0</span> <span class="s">&quot;Neg/I&quot;</span> <span class="m">1</span> <span class="s">&quot;Pos&quot;</span>
<span class="k">label</span> values don_hcv don_hcv
<span class="m">2</span>. When Donor HCV is crucial part of analysis<span class="k"> do</span> not assume missing is HCV negative
<span class="k">global</span> srtrdir=<span class="s">&quot;/dcs01/igm/segevlab/data/srtr1509/public&quot;</span>
<span class="k">local</span> ddfile=<span class="s">&quot;</span><span class="vg">$srtrdir</span><span class="s">/donor_deceased.dta&quot;</span>
<span class="k">use</span> <span class="nv">`ddfile&#39;</span>,clear  <span class="c1">//Separate file for live donor. Need to do some merging after this</span>
<span class="k">gen</span> don_hcv=.
<span class="k">replace</span> don_hcv=<span class="m">1</span><span class="k"> if</span> don_anti_hcv<span class="o">==</span><span class="s">&quot;P&quot;</span>
<span class="m">4</span>
<span class="k">replace</span> don_hcv=<span class="m">0</span><span class="k"> if</span> don_anti_hcv<span class="o">==</span><span class="s">&quot;N&quot;</span>
<span class="k">label var</span> don_hcv <span class="s">&quot;Donor HCV Ab&quot;</span>
<span class="k">label</span> define don_hcv <span class="m">0</span> <span class="s">&quot;Neg/I&quot;</span> <span class="m">1</span> <span class="s">&quot;Pos&quot;</span>
<span class="k">label</span> values don_hcv don_hcv
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="hepatocellular-carcinoma-hcc-by-diagnosis-by-exception-points">
<h2>17. Hepatocellular Carcinoma (HCC) (by diagnosis/by exception points)<a class="headerlink" href="#hepatocellular-carcinoma-hcc-by-diagnosis-by-exception-points" title="Permalink to this heading">#</a></h2>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">// -----------------------------------</span>
<span class="c1">// HCC</span>
<span class="c1">// -----------------------------------</span>
<span class="c1">//HCC by exception point status</span>
<span class="k">    capt drop</span> hcc
<span class="k">    gen</span> hcc = canhx_meld_diff_reason_cd <span class="o">==</span><span class="m">8</span>
<span class="k">    replace</span> hcc= .<span class="k"> if</span> canhx_meld_diff<span class="o">==</span><span class="m">1</span> | canhx_meld_diff<span class="o">==</span><span class="m">2</span> <span class="cs">///</span>
    | canhx_meld_diff<span class="o">==</span><span class="m">5</span> | canhx_meld_diff<span class="o">==</span><span class="m">12</span> | <span class="cs">///</span>
    canhx_meld_diff<span class="o">==</span><span class="m">15</span> | canhx_meld_diff<span class="o">==</span><span class="m">16</span>
<span class="c1">//HCC by diagnosis</span>
<span class="k">    gen</span> hcc = <span class="nf">cond</span>(<span class="nf">inlist</span>(can_dgn,<span class="m">4400</span>,<span class="m">4401</span>),<span class="m">1</span>,<span class="m">0</span>)<span class="k"> if</span> <span class="o">!</span><span class="nf">mi</span>(can_dgn)
<span class="k">        replace</span> hcc = <span class="m">1</span><span class="k"> if</span> <span class="nf">inlist</span>(can_dgn2, <span class="m">4400</span>,<span class="m">4401</span>)
<span class="k">        replace</span> hcc= <span class="m">1</span><span class="k"> if</span> <span class="nf">strpos</span>(can_dgn_ost, <span class="s">&quot;HCC&quot;</span>)
<span class="k">        replace</span> hcc= <span class="m">1</span><span class="k"> if</span> <span class="nf">strpos</span>(can_dgn_ost, <span class="s">&quot;HEPATOCELLULAR CARCINOMA&quot;</span>)
<span class="k">            replace</span> hcc= <span class="m">1</span><span class="k"> if</span> <span class="nf">strpos</span>(can_dgn_ost, <span class="s">&quot;HEPATOCELLULARCARCINOMA&quot;</span>)
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="immunosuppression-induction">
<h2>18. Immunosuppression/Induction<a class="headerlink" href="#immunosuppression-induction" title="Permalink to this heading">#</a></h2>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">// -----------------------------------</span>
<span class="c1">// Immunosuppression/ Induction</span>
<span class="c1">// induction - before transplant or on day, you get shots</span>
<span class="c1">// with goal to deactive T or B cells</span>
<span class="c1">// maintenance: start AFTER transplant that you carry on for life</span>
<span class="c1">// relevant to transplant outcomes</span>
<span class="c1">// includes substantial additions by Mary-Grace Bowring</span>
<span class="c1">// -----------------------------------</span>



<span class="k">global</span> srtrdir=<span class="s">&quot;/dcs01/igm/segevlab/data/srtr1509/public&quot;</span>
<span class="k">local</span> isfile=<span class="s">&quot;</span><span class="vg">$srtrdir</span><span class="s">/immuno.dta&quot;</span>


<span class="k">use</span> <span class="nv">`isfile&#39;</span>,clear

<span class="c1">****Induction****</span>
<span class="k">tempvar</span> is_induct00 is_induct11

<span class="k">gen</span> <span class="nv">`is_induct00&#39;</span>=(rec_drug_induction<span class="o">==</span><span class="m">1</span> <span class="o">&amp;</span> <span class="nf">inlist</span>(rec_drug_cd,<span class="m">16</span>,<span class="o">-</span><span class="m">1</span>,<span class="m">14</span>,<span class="m">41</span>,<span class="m">15</span>,<span class="m">50</span>))
<span class="k">gen</span> <span class="nv">`is_induct11&#39;</span>=(rec_drug_induction<span class="o">==</span><span class="m">1</span> <span class="o">&amp;</span> <span class="nf">inlist</span>(rec_drug_cd,<span class="m">42</span>,<span class="m">43</span>,<span class="m">52</span>))

<span class="k">forvalues n</span>=<span class="m">0</span><span class="o">/</span><span class="m">1</span> {

<span class="k">    replace</span> <span class="nv">`is_induct`n&#39;`n&#39;&#39;</span>=.<span class="k"> if</span> rec_drug_induction<span class="o">==</span>. | rec_drug_cd<span class="o">==</span>.
<span class="k">	bys</span> trr_id:<span class="k"> egen</span> is_induct<span class="nv">`n&#39;</span>=<span class="nf">max</span>(<span class="nv">`is_induct`n&#39;`n&#39;&#39;</span>)

}


<span class="k">label var</span> is_induct0 <span class="s">&quot;1-Induction(depleting)&quot;</span>
<span class="k">label var</span> is_induct1 <span class="s">&quot;1-Induction(non-depleting)&quot;</span>
<span class="c1">	 </span>
<span class="c1">			 </span>
<span class="c1">****Maintenance****</span>
<span class="k">tempvar</span> is_steroid_withdraw0
<span class="k">gen</span> <span class="nv">`is_steroid_withdraw0&#39;</span>=<span class="m">1</span>
<span class="k">replace</span> <span class="nv">`is_steroid_withdraw0&#39;</span>=<span class="m">0</span><span class="k"> if</span> rec_drug_maint<span class="o">==</span><span class="m">1</span> <span class="o">&amp;</span> <span class="nf">inlist</span>(rec_drug_cd,<span class="m">1</span>,<span class="m">49</span>)
<span class="k">replace</span> <span class="nv">`is_steroid_withdraw0&#39;</span>=.<span class="k"> if</span> <span class="nf">missing</span>(rec_drug_maint) | <span class="nf">missing</span>(rec_drug_cd)
<span class="k">bys</span> trr_id:<span class="k"> egen</span> is_steroid_withdraw=<span class="nf">min</span>(<span class="nv">`is_steroid_withdraw0&#39;</span>)
<span class="k">				</span>
<span class="k">collapse</span> (max)  is_induct0 is_induct1 <span class="cs">///</span>
                is_steroid_withdraw,by(trr_id) 
<span class="k">				</span>
<span class="k">gen</span> is_induct_other=(is_induct0<span class="o">==</span><span class="m">0</span> <span class="o">&amp;</span> is_induct1<span class="o">==</span><span class="m">0</span>)
<span class="k">label var</span> is_induct_other <span class="s">&quot;1-Anything else besides depleting or non-depleting&quot;</span>			

<span class="k">tabstat</span> is_induct0 is_induct1 is_induct_other <span class="cs">///</span>
        is_steroid_withdraw,statistics(mean)
<span class="k">		</span>
<span class="k">tab</span> is_induct0 is_induct1,m

<span class="c1">**************************************************************************************</span>
<span class="c1">** This do-file transforms the SRTR immunosuppression dataset so that it can be linked to tx_ki dataset using trr_id.</span>

<span class="cm">/** v3 update</span>
<span class="cm">- separated non-rabbit ATG from &quot;thymo&quot; as nratg</span>
<span class="cm">*/</span>

<span class="cm">/* Classification of the drugs:</span>
<span class="cm">1. Induction: OKT3, thymoglobulin (rabbit only), non-rabbit anti-thymocyte glubline (ALG, Atgam, NRATG/NRATS), Daclizumab, Basiliximab, Alemtuzumab, Rituximab.</span>
<span class="cm">2. Maintanence</span>
<span class="cm">	1) Steroids (Istedoid)</span>
<span class="cm">	2) CNI (Icni): Cyclosporin(including Neoral), Tacrolimus</span>
<span class="cm">	3) Anti-metabolites (Iantimeta): MMF(including Myfortic), mTOR(Sirolimus and Everolimus), Azathioprine  </span>
<span class="cm">3. Everything else is dumped. 	  */</span>

<span class="k">local</span> ver=<span class="s">&quot;1903&quot;</span>
<span class="k">global</span> srtrdir <span class="s">&quot;/dcs01/igm/segevlab/data/srtr</span><span class="nv">`ver&#39;</span><span class="s">/public&quot;</span>
<span class="k">global</span> LOCAL <span class="o">/</span>users<span class="o">/</span>syu<span class="o">/</span>016_dataset<span class="o">/</span>001_steroid_rejection
<span class="k">	</span>
<span class="k">set more</span> off
<span class="k">use</span> <span class="vg">$srtrdir</span><span class="o">/</span>immuno<span class="m">.</span>dta,<span class="k"> clear</span>
<span class="k">cd</span> <span class="s">&quot;/users/syu/016_dataset/001_steroid_rejection&quot;</span>
	
<span class="c1">// Generate indicators</span>
<span class="k">gen</span> Iokt3=<span class="nf">inlist</span>(rec_drug_cd, <span class="m">16</span>)
<span class="k">gen</span> Ithymo=<span class="nf">inlist</span>(rec_drug_cd, <span class="m">41</span>)
<span class="k">gen</span> Inratg=<span class="nf">inlist</span>(rec_drug_cd, <span class="o">-</span><span class="m">1</span> ,<span class="m">14</span>, <span class="m">15</span>)
<span class="k">gen</span> Idaclizumab=<span class="nf">inlist</span>(rec_drug_cd, <span class="m">42</span>)
<span class="k">gen</span> Ibasiliximab=<span class="nf">inlist</span>(rec_drug_cd, <span class="m">43</span>)
<span class="k">gen</span> Irituximab=<span class="nf">inlist</span>(rec_drug_cd, <span class="m">52</span>)
<span class="k">gen</span> Ialemtuzumab=<span class="nf">inlist</span>(rec_drug_cd,<span class="m">50</span>)
<span class="k">gen</span> Isteroid=<span class="nf">inlist</span>(rec_drug_cd,<span class="m">1</span>,<span class="m">2</span>,<span class="m">49</span>) <span class="cs">/// WAW: I added in code 2 for methylpred as steroid induction. </span>
<span class="k">gen</span> Icyclosporin=<span class="nf">inlist</span>(rec_drug_cd,<span class="m">3</span>,<span class="m">4</span>,<span class="o">-</span><span class="m">2</span>,<span class="m">44</span>,<span class="m">46</span>,<span class="m">48</span>)
<span class="k">gen</span> Itacro=<span class="nf">inlist</span>(rec_drug_cd,<span class="m">5</span>,<span class="m">53</span>,<span class="m">54</span>,<span class="m">59</span>) <span class="cs">///	WAW: I added in code 59 for envarsus XR. </span>
<span class="k">gen</span> Immf=<span class="nf">inlist</span>(rec_drug_cd,<span class="m">9</span>,<span class="m">47</span>,<span class="m">55</span>,<span class="m">57</span>)	<span class="cs">/// WAW: I added in code 57 for generic myfortic. </span>
<span class="k">gen</span> Imtor=<span class="nf">inlist</span>(rec_drug_cd,<span class="m">6</span>,<span class="m">45</span>)
<span class="k">gen</span> Iaza=<span class="nf">inlist</span>(rec_drug_cd,<span class="m">8</span>)

<span class="k">gen</span>	Iinduction_steroid=<span class="nf">inlist</span>(rec_drug_cd,<span class="m">2</span>)	
<span class="cs">///	WAW: although high dose steroids (nearly always methlypred) are not considered induction per se, they are almost always given up front. </span>
<span class="cs">///	WAW: for ESW work, this seems important to note as may be an mediator of the effects of later ESW. </span>

<span class="k">gen</span> Iinduction=(Iokt3<span class="o">+</span> Ithymo<span class="o">+</span> Inratg<span class="o">+</span>Idaclizumab<span class="o">+</span>Ibasiliximab<span class="o">+</span> Irituximab<span class="o">+</span> Ialemtuzumab)<span class="o">&gt;</span><span class="m">0</span>
<span class="k">gen</span> Icni=(Icyclosporin<span class="o">+</span>Itacro)<span class="o">&gt;</span><span class="m">0</span>
<span class="k">gen</span> Iantimeta=(Immf<span class="o">+</span>Iaza)<span class="o">&gt;</span><span class="m">0</span>	<span class="cs">/// WAW: I generally refer to aza/mmf only when I talk about antimetabolites, while mtor is an &quot;antiproliferative&quot;. So i took mtor out of here.</span>

<span class="c1">// Create a list of trr_ids that has any information on this dataset</span>
<span class="k">preserve</span>
<span class="k">keep</span> trr_id
<span class="k">duplicates drop</span>
<span class="k">save</span> imsup_all_v3,<span class="k"> replace</span>
<span class="k">restore</span>

<span class="c1">** But IS data for the most recent cohort is NOT comprehensive. Consider censoring everyone in the last year or something.</span>

<span class="c1">// See if they make clinical sense</span>
<span class="k">drop if</span> rec_drug_induction <span class="o">+</span> rec_drug_maint <span class="o">+</span> rec_drug_anti_rej <span class="o">==</span><span class="m">0</span>
<span class="k">drop if</span> Iinduction <span class="o">&amp;</span> (rec_drug_induction <span class="o">+</span> rec_drug_anti_rej) <span class="o">==</span> <span class="m">0</span>

<span class="c1">// Export</span>
<span class="k">preserve</span>
<span class="k">collapse</span> (max) I<span class="o">*</span><span class="k"> if</span> rec_drug_induction,<span class="k"> by</span>(trr_id)
<span class="k">save</span> imsup_ind,<span class="k"> replace</span>
<span class="k">restore</span>

<span class="k">preserve</span>
<span class="k">collapse</span> (max) I<span class="o">*</span><span class="k"> if</span> rec_drug_maint,<span class="k"> by</span>(trr_id)
<span class="k">save</span> imsup_maint,<span class="k"> replace</span>
<span class="k">restore</span>

<span class="k">preserve</span>
<span class="k">collapse</span> (max) I<span class="o">*</span><span class="k"> if</span> rec_drug_anti_rej,<span class="k"> by</span>(trr_id)
<span class="k">save</span> imsup_anti_rej,<span class="k"> replace</span>
<span class="k">restore</span>

<span class="c1">*** Also get the number of days for induction</span>
<span class="k">preserve</span>
<span class="k">keep if</span> <span class="nf">inlist</span>(rec_drug_cd,<span class="m">16</span>,<span class="o">-</span><span class="m">1</span>,<span class="m">14</span>,<span class="m">41</span>,<span class="m">15</span>,<span class="m">42</span>,<span class="m">43</span>,<span class="m">52</span>,<span class="m">50</span>)
<span class="k">keep if</span> rec_drug_induction
<span class="k">replace</span> rec_drug_cd=<span class="m">100</span><span class="k"> if</span> rec_drug_cd<span class="o">==-</span><span class="m">1</span> <span class="c1">//values need to be positive to reshape</span>

<span class="k">keep</span> trr_id rec_drug_cd rec_drug_days
<span class="k">reshape</span> wide rec_drug_days, i(trr_id) j(rec_drug_cd)
<span class="k">mvencode</span> _all, mv(<span class="m">0</span>) override  <span class="c1">//force the missing data to 0 </span>

<span class="k">gen</span> days_atg=rec_drug_days41
<span class="k">gen</span> days_nratg=rec_drug_days100<span class="o">+</span>rec_drug_days14<span class="o">+</span>rec_drug_days15
<span class="k">gen</span> days_il2=rec_drug_days42<span class="o">+</span>rec_drug_days43
<span class="k">gen</span> days_alm=rec_drug_days50
<span class="k">gen</span> days_ritux=rec_drug_days52
<span class="k">gen</span> days_okt3=rec_drug_days16

<span class="k">drop</span> rec_drug_days<span class="o">*</span>
<span class="k">compress</span>
<span class="k">save</span> imsup_days,<span class="k"> replace</span>
<span class="k">restore</span>


<span class="k">foreach</span> c<span class="k"> in</span> ind maint anti_rej {
<span class="k">	use</span> imsup_<span class="nv">`c&#39;</span>,<span class="k"> clear</span>
<span class="k">	foreach</span> v of<span class="k"> varlist</span> I<span class="o">*</span> {
<span class="k">		rename</span> <span class="nv">`v&#39;</span> <span class="nv">`v&#39;</span>_<span class="nv">`c&#39;</span>
	}
<span class="k">	save</span> imsup_<span class="nv">`c&#39;</span>,<span class="k"> replace</span>
}

<span class="c1">// Lump all of them up into imsup_all_v3 dataset</span>
<span class="k">use</span> imsup_all_v3,<span class="k"> clear</span>
<span class="k">merge</span> <span class="m">1</span>:<span class="m">1</span> trr_id using imsup_ind, nogen
<span class="k">merge</span> <span class="m">1</span>:<span class="m">1</span> trr_id using imsup_maint, nogen
<span class="k">merge</span> <span class="m">1</span>:<span class="m">1</span> trr_id using imsup_anti_rej, nogen
<span class="k">merge</span> <span class="m">1</span>:<span class="m">1</span> trr_id using imsup_days, nogen

<span class="k">mvencode</span> _all, mv(<span class="m">0</span>) override
<span class="k">save</span> <span class="s">&quot;</span><span class="vg">$LOCAL</span><span class="s">/imsup_all_</span><span class="nv">`ver&#39;</span><span class="s">&quot;</span>,<span class="k"> replace</span>

<span class="c1">// If _ever indicators are needed:  </span>
<span class="cm">/*</span>
<span class="cm">foreach drugname in Iokt3 Ithymo Inratg Idaclizumab Ibasiliximab Irituximab Ialemtuzumab Isteroid Icyclosporin Itacro Immf Imtor Iaza Iinduction Icni Iantimeta {</span>
<span class="cm">	egen `drugname&#39;_ever=rowmax(`drugname&#39;*)</span>
<span class="cm">}</span>
<span class="cm">save imsup_all_v3, replace</span>
<span class="cm">*/</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="insurance">
<h2>19. Insurance<a class="headerlink" href="#insurance" title="Permalink to this heading">#</a></h2>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">// -----------------------------------</span>
<span class="c1">// insurance</span>
<span class="c1">// -----------------------------------</span>
<span class="k">gen</span> insurance = <span class="m">2</span> <span class="c1">//&quot;Other&quot;</span>
<span class="k">replace</span> insurance = <span class="m">1</span><span class="k"> if</span> rec_primary_pay <span class="o">==</span> <span class="m">1</span> | rec_primary_pay <span class="o">==</span> <span class="m">8</span>
<span class="c1">// private (1) &amp; self-pay (8)</span>
<span class="k">replace</span> insurance = <span class="m">0</span><span class="k"> if</span> (rec_primary_pay <span class="o">&gt;=</span><span class="m">2</span> <span class="o">&amp;</span> rec_primary_pay <span class="o">&lt;=</span> <span class="m">7</span>) | rec_primary_pay <span class="o">==</span> <span class="m">13</span> | rec_prim
<span class="k">replace</span> insurance=.<span class="k"> if</span> <span class="nf">missing</span>(rec_primary_pay)
<span class="k">label</span> define insurance <span class="m">0</span> <span class="s">&quot;Public&quot;</span> <span class="m">1</span> <span class="s">&quot;Private&quot;</span> <span class="m">2</span> <span class="s">&quot;Other&quot;</span>
<span class="k">label</span> values insurance insurance
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="kidney-donor-risk-index-kdri-kidney-donor-profile-index-kdpi">
<h2>20. Kidney Donor Risk Index (KDRI)/Kidney Donor Profile Index (KDPI)<a class="headerlink" href="#kidney-donor-risk-index-kdri-kidney-donor-profile-index-kdpi" title="Permalink to this heading">#</a></h2>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">// -----------------------------------</span>
<span class="c1">// KDRI/ KDPI</span>
<span class="c1">// -----------------------------------</span>
<span class="c1">//be mindful of time period when using this (can be odd to explore KDPI before it was adopted)</span>
<span class="c1">//this use the reference year 2013, ref year can be changed</span>
<span class="c1">//truncate serum creatinine and height at some extreme value and can replace htn with mean of previous y</span>
<span class="o">&lt;</span>https:<span class="o">//</span>optn<span class="m">.</span>transplant<span class="m">.</span>hrsa<span class="m">.</span>gov<span class="o">/</span>ContentDocuments<span class="o">/</span>Guide_to_Calculating_Interpreting_KDPI<span class="m">.</span>pdf<span class="o">&gt;</span>

<span class="c1">//AM: define path and reference year instead of hard-coding</span>
<span class="k">global</span> DATA <span class="o">/</span>dcs01<span class="o">/</span>igm<span class="o">/</span>segevlab<span class="o">/</span>data<span class="o">/</span>srtr1903<span class="o">/</span>public
<span class="k">global</span> REF_Y <span class="m">2018</span>  <span class="c1">//reference year for KDPI calculation</span>
<span class="c1">//keep recovered kidneys</span>
<span class="k">use</span> don_disposition donor_id don_org using <span class="vg">$DATA</span><span class="o">/</span>donor_disposition<span class="m">.</span>dta,clear
<span class="k">keep if</span> <span class="nf">inlist</span>(don_org,<span class="s">&quot;LKI&quot;</span>,<span class="s">&quot;RKI&quot;</span>,<span class="s">&quot;EKI&quot;</span>)
<span class="k">keep if</span> <span class="nf">inlist</span>(don_disposition,<span class="m">5</span>,<span class="m">6</span>)
<span class="k">isid</span> donor_id don_org
<span class="k">merge m</span>:<span class="m">1</span> donor_id using <span class="vg">$DATA</span><span class="o">/</span>donor_deceased<span class="m">.</span>dta,keep(match)
<span class="k">drop</span> _merge
<span class="k">keep</span> <span class="o">*</span>id<span class="o">*</span> <span class="o">*</span>_dt<span class="o">*</span> don_age <span class="o">*</span>hgt<span class="o">*</span> <span class="o">*</span>wgt<span class="o">*</span> <span class="o">*</span>race<span class="o">*</span>  <span class="cs">///</span>
     don_hist_h<span class="o">*</span> <span class="o">*</span>diab<span class="o">*</span> don_cad<span class="o">*</span> <span class="o">*</span>creat<span class="o">*</span> <span class="o">*</span>hcv<span class="o">*</span> <span class="o">*</span>hr<span class="o">*</span> don_cad
<span class="k">duplicates drop</span>
<span class="k">isid</span> donor_id
<span class="c1">//kdri</span>
<span class="k">    gen</span> age40 = don_age<span class="m">-40</span>
<span class="k">    gen</span> age18 = don_age<span class="m">-18</span>
<span class="k">    replace</span> age18 = <span class="m">0</span><span class="k"> if</span> don_age<span class="o">&gt;=</span><span class="m">18</span>
<span class="k">    gen</span> age50 = don_age<span class="m">-50</span>
<span class="k">    replace</span> age50 = <span class="m">0</span><span class="k"> if</span> don_age<span class="o">&lt;=</span><span class="m">50</span>
<span class="k">    gen</span> hgt170 = don_hgt_cm<span class="m">-170</span>
<span class="k">    gen</span> wgt80 = (don_wgt_kg<span class="m">-80</span>)<span class="o">/</span><span class="m">5</span>
<span class="k">    replace</span> wgt80 = <span class="m">0</span><span class="k"> if</span> don_wgt_kg <span class="o">&gt;=</span><span class="m">80</span>
<span class="k">    gen</span> aa = <span class="nf">cond</span>(don_race<span class="o">==</span><span class="m">16</span>,<span class="m">1</span>,<span class="m">0</span>)
<span class="k">    gen</span> hyp = <span class="nf">cond</span>(<span class="nf">inrange</span>(don_hist_hyp,<span class="m">2</span>,<span class="m">5</span>),<span class="m">1</span>,<span class="m">0</span>)
<span class="k">    gen</span> diab = <span class="nf">cond</span>(<span class="nf">inrange</span>(don_hist_diab,<span class="m">2</span>,<span class="m">5</span>),<span class="m">1</span>,<span class="m">0</span>)
<span class="k">    gen</span> cva = <span class="nf">cond</span>(don_cad_don<span class="o">==</span><span class="m">2</span>,<span class="m">1</span>,<span class="m">0</span>)
<span class="k">    gen</span> creat= don_creat
<span class="k">        replace</span> creat= don_max_creat<span class="k"> if</span> creat<span class="o">==</span>. <span class="o">&amp;</span> don_max_creat<span class="o">!=</span>.
<span class="k">        replace</span> creat=don_peak_<span class="k"> if</span> creat<span class="o">==</span>. <span class="o">&amp;</span> don_peak_<span class="o">!=</span>.
<span class="k">        codebook</span> creat
    <span class="c1">//replace creat=8 if creat&gt;8 &amp; !mi(creat)</span>
<span class="c1">//SZ: creatinine should be capped at 8</span>
<span class="k">    gen</span> creat1 = creat<span class="m">-1</span>
<span class="k">    gen</span> creat1_5 = creat<span class="m">-1.5</span>
<span class="k">    replace</span> creat1_5 = <span class="m">0</span><span class="k"> if</span> creat <span class="o">&lt;=</span><span class="m">1.5</span>
<span class="k">    gen</span> hcv=<span class="nf">cond</span>(don_anti_hcv<span class="o">==</span><span class="s">&quot;P&quot;</span>,<span class="m">1</span>,<span class="m">0</span>)


<span class="k">gen</span> dcd = <span class="nf">cond</span>(don_non_hr_beat<span class="o">==</span><span class="s">&quot;Y&quot;</span>,<span class="m">1</span>,<span class="m">0</span>)
<span class="k">gen</span> logkdri =
<span class="m">0.0128</span> <span class="o">*</span> (age40)       <span class="cs">///</span>
<span class="o">-</span><span class="m">0.0194</span> <span class="o">*</span> (age18)      <span class="cs">///</span>
<span class="o">+</span><span class="m">0.0107</span> <span class="o">*</span> (age50)      <span class="cs">///</span>
<span class="cs">///</span>
<span class="o">-</span><span class="m">0.0464</span> <span class="o">*</span> (hgt170)<span class="o">/</span><span class="m">10</span>  <span class="cs">///</span>
<span class="o">-</span><span class="m">0.0199</span> <span class="o">*</span> (wgt80)
<span class="cs">///</span>
<span class="o">+</span><span class="m">0.1790</span> <span class="o">*</span> aa
<span class="cs">///</span>
<span class="o">+</span><span class="m">0.1260</span> <span class="o">*</span> hyp
<span class="o">+</span><span class="m">0.1300</span> <span class="o">*</span> diab
<span class="o">+</span><span class="m">0.0881</span> <span class="o">*</span> cva
<span class="cs">///</span>
<span class="o">+</span><span class="m">0.2200</span> <span class="o">*</span> (creat1)
<span class="o">-</span><span class="m">0.2090</span> <span class="o">*</span> (creat1_5)
<span class="o">+</span><span class="m">0.2400</span> <span class="o">*</span> (hcv)
<span class="o">+</span><span class="m">0.1330</span> <span class="o">*</span> dcd
<span class="cs">/// </span><span class="c1">///</span>
<span class="cs">/// </span><span class="c1">/// ///</span>
<span class="cs">/// </span><span class="c1">///</span>
<span class="cs">///</span>
<span class="k">gen</span> y = <span class="nf">year</span>(don_recov_dt)
<span class="c1">//AM: you don&#39;t really need to exponentiate</span>
<span class="k">gen</span> kdri = <span class="nf">exp</span>(logkdri)
<span class="k">sum</span> kdri<span class="k"> if</span> y <span class="o">==</span><span class="vg">$REF_Y</span>,det
<span class="k">local median</span> <span class="nf">r</span>(p50)
<span class="k">gen</span> kdri_med = kdri<span class="o">/</span><span class="nv">`median&#39;</span>
<span class="k">hist</span> kdri_med
<span class="k">drop if</span> kdri<span class="o">==</span>.
<span class="k">egen</span> rank =rank(kdri_med)<span class="k"> if</span> y<span class="o">==</span><span class="vg">$REF_Y</span>
<span class="k">    sort</span> y
<span class="k">    sort</span> rank
<span class="k">bys</span> y:<span class="k"> gen total</span> = _N<span class="k"> if</span> y<span class="o">==</span><span class="vg">$REF_Y</span>
<span class="k">sort</span> rank
<span class="k">gen pctile</span>=rank<span class="o">/</span>total
<span class="k">gen</span> kdpi =<span class="k"> pctile</span><span class="o">*</span><span class="m">100</span>
<span class="k">hist</span> kdpi,freq
<span class="k">sort</span> kdri
<span class="k">replace</span> kdpi=kdpi[_n<span class="m">-1</span>]<span class="k"> if</span> kdpi<span class="o">==</span>.
<span class="k">gsort</span> <span class="o">-</span>kdri
<span class="k">replace</span> kdpi=kdpi[_n<span class="m">-1</span>]<span class="k"> if</span> kdpi<span class="o">==</span>.
<span class="k">keep</span> donor_id kdri kdpi logkdri don_recov_dt
<span class="k">capt drop</span> _merge
<span class="k">save</span> kdpi_id<span class="m">.</span>dta,replace
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="donor-risk-index-dri">
<h2>21. Donor Risk Index (DRI)<a class="headerlink" href="#donor-risk-index-dri" title="Permalink to this heading">#</a></h2>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">// -----------------------------------</span>
<span class="c1">// DRI</span>
<span class="c1">// -----------------------------------</span>
<span class="c1">//you can exclude rec_tx_procedure_ty/sharing/CIT to calculate &quot;adjusted DRI&quot; (pre-tx DRI)</span>
<span class="k">gen</span> log_dri = <span class="cs">///</span>
<span class="m">0.154</span><span class="o">*</span>(<span class="nf">inrange</span>(don_age, <span class="m">40</span>, <span class="m">49</span>)) <span class="o">+</span> <span class="cs">///</span>
<span class="m">0.274</span><span class="o">*</span>(<span class="nf">inrange</span>(don_age, <span class="m">50</span>, <span class="m">59</span>)) <span class="o">+</span> <span class="cs">///</span>
<span class="m">0.424</span><span class="o">*</span>(<span class="nf">inrange</span>(don_age, <span class="m">60</span>, <span class="m">69</span>)) <span class="o">+</span> <span class="cs">///</span>
<span class="m">0.501</span><span class="o">*</span>(<span class="nf">inrange</span>(don_age, <span class="m">70</span>, <span class="m">99</span>)) <span class="o">+</span> <span class="cs">///</span>
<span class="m">0.079</span><span class="o">*</span>(don_cad_don_cod<span class="o">==</span><span class="m">1</span>) <span class="o">+</span> <span class="cs">///</span>
<span class="m">0.145</span><span class="o">*</span>(don_cad_don_cod<span class="o">==</span><span class="m">2</span>) <span class="o">+</span> <span class="cs">///</span>
<span class="m">0.184</span><span class="o">*</span>(<span class="o">!</span><span class="nf">inlist</span>(don_cad_don_cod, <span class="m">1</span>, <span class="m">2</span>, <span class="m">3</span>)) <span class="o">+</span> <span class="cs">///  </span><span class="c1">// not Anoxia (1), CVA/stroke (2) , or trauma (3)</span>
<span class="m">0.176</span><span class="o">*</span>(don_race<span class="o">==</span><span class="m">16</span>) <span class="o">+</span> <span class="cs">///</span>
    <span class="m">0.126</span><span class="o">*</span>(<span class="o">!</span><span class="nf">inlist</span>(don_race, <span class="m">8</span>, <span class="m">16</span>)) <span class="o">+</span> <span class="cs">///</span>
    <span class="m">0.411</span><span class="o">*</span>(don_non_hr_beat<span class="o">==</span><span class="s">&quot;Y&quot;</span>) <span class="o">+</span> <span class="cs">///</span>
    <span class="m">0.066</span><span class="o">*</span>((<span class="m">170</span><span class="o">-</span>don_hgt_cm)<span class="o">/</span><span class="m">10</span>) <span class="o">+</span>  <span class="cs">///</span>
    <span class="m">0.422</span><span class="o">*</span>(rec_tx_procedure_ty <span class="o">!=</span> <span class="m">701</span>) <span class="o">+</span> <span class="cs">///</span>
    <span class="m">0.105</span><span class="o">*</span>(regional_share) <span class="o">+</span> <span class="cs">///</span>
    <span class="m">0.244</span><span class="o">*</span>(national_share)<span class="o">+</span> <span class="cs">///</span>
    <span class="m">0.010</span><span class="o">*</span>(rec_cold_isch_tm)
<span class="k">gen</span> don_dri = <span class="nf">exp</span>(log_dri)
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="estimated-post-transplant-survival-epts">
<h2>22. Estimated Post Transplant Survival (EPTS)<a class="headerlink" href="#estimated-post-transplant-survival-epts" title="Permalink to this heading">#</a></h2>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">// -----------------------------------</span>
<span class="c1">// EPTS</span>
<span class="c1">// -----------------------------------</span>
<span class="c1">//see https://optn.transplant.hrsa.gov/media/1511/guide_to_calculating_interpreting_epts.pdf</span>

<span class="k">gen</span> epts_age25 = <span class="nf">max</span>(rec_age_at<span class="m">-25</span>, <span class="m">0</span>)
<span class="c1">//NOTE: not clear how to ascertain post-listing incident DM</span>
<span class="k">gen</span> rec_dm = <span class="nf">inrange</span>(can_diab_ty, <span class="m">2</span>, <span class="m">5</span>)<span class="k"> if</span> <span class="nf">inrange</span>(can_diab_ty, <span class="m">1</span>, <span class="m">5</span>)
<span class="k">replace</span> rec_dm = <span class="nf">inlist</span>(can_diab, <span class="m">2</span>, <span class="m">3</span>)<span class="k"> if</span> can_diab<span class="o">&lt;=</span><span class="m">3</span> <span class="o">&amp;</span> <span class="nf">missing</span>(rec_dm)
<span class="c1">//NOTE: this is for EPTS as of date of transplant</span>
<span class="k">gen</span> rrt_y = (rec_tx_dt<span class="o">-</span>rec_dial_dt)<span class="o">/</span><span class="m">365.25</span>
<span class="k">gen</span> byte rec_prev_tx = (rec_prev_ki<span class="o">==</span><span class="m">1</span> | rec_prev_li<span class="o">==</span><span class="m">1</span> | rec_prev_hr<span class="o">==</span><span class="m">1</span> <span class="cs">///</span>
    | rec_prev_lu<span class="o">==</span><span class="m">1</span> | rec_prev_pa<span class="o">==</span><span class="m">1</span>)

<span class="k">gen</span> raw_epts = <span class="cs">///</span>
    <span class="m">0.047</span><span class="o">*</span>epts_age25 <span class="o">+</span> <span class="cs">///</span>
   <span class="o">-</span><span class="m">0.015</span><span class="o">*</span>rec_dm<span class="o">*</span>epts_age25 <span class="o">+</span> <span class="cs">///</span>
    <span class="m">0.398</span><span class="o">*</span>rec_prev_tx <span class="o">+</span> <span class="cs">///</span>
   <span class="o">-</span><span class="m">0.237</span><span class="o">*</span>rec_dm<span class="o">*</span>rec_prev_tx <span class="o">+</span> <span class="cs">///</span>
    <span class="m">0.315</span><span class="o">*</span><span class="nf">log</span>(rrt_y<span class="m">+1</span>) <span class="o">+</span> <span class="cs">///</span>
    <span class="m">0.130</span><span class="o">*</span>(rrt_y<span class="o">==</span><span class="m">0</span>) <span class="o">+</span> <span class="cs">///</span>
   <span class="o">-</span><span class="m">0.348</span><span class="o">*</span>rec_dm<span class="o">*</span>(rrt_y<span class="o">==</span><span class="m">0</span>) <span class="o">+</span> <span class="cs">///</span>
    <span class="m">1.262</span><span class="o">*</span>rec_dm
<span class="k">sum</span> raw_epts, detail
<span class="k">count if</span> <span class="nf">missing</span>(raw_epts)
<span class="k">assert</span> <span class="nf">r</span>(N)<span class="o">&lt;</span><span class="m">100</span>
<span class="k">local</span> N_EPTS = _N<span class="o">-</span><span class="nf">r</span>(N)
<span class="k">sort</span> raw_epts
<span class="k">gen</span> rec_epts = _n<span class="o">/</span><span class="nv">`N_EPTS&#39;</span><span class="k"> if</span> <span class="o">!</span><span class="nf">missing</span>(raw_epts)
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="machine-perfusion">
<h2>23. Machine perfusion<a class="headerlink" href="#machine-perfusion" title="Permalink to this heading">#</a></h2>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">// -----------------------------------</span>
<span class="c1">// Machine perfusion</span>
<span class="c1">// -----------------------------------</span>
<span class="k">use</span> <span class="vg">$srtrdir</span><span class="o">/</span>donor_disposition<span class="m">.</span>dta,<span class="k"> clear</span>
<span class="k">keep</span> donor_id px_id don_org
<span class="k">drop if</span> px_id<span class="o">==</span>.
<span class="k">keep if</span> <span class="nf">inlist</span>(don_org,<span class="s">&quot;LKI&quot;</span>,<span class="s">&quot;RKI&quot;</span>,<span class="s">&quot;EKI&quot;</span>)  <span class="c1">// drop all other organs (especially pancrease (PA))</span>
<span class="k">isid</span> px_id               <span class="c1">// no news is good news here.</span>
<span class="k">tempfile</span> donor
<span class="k">saveold</span> <span class="nv">`donor&#39;</span>
<span class="k">use</span> <span class="vg">$hcvdir</span><span class="o">/</span>hcv_ar,clear
<span class="k">capture drop</span> organ
<span class="k">merge</span> <span class="m">1</span>:<span class="m">1</span> px_id using <span class="nv">`donor&#39;</span>,keep(master match) nogen
<span class="k">saveold</span> <span class="vg">$hcvdir</span><span class="o">/</span>hcv_ar ,replace
<span class="k">gen</span> rec_which_k=<span class="m">0</span><span class="o">*</span>(don_org<span class="o">==</span><span class="s">&quot;LKI&quot;</span>)<span class="o">+</span><span class="m">1</span><span class="o">*</span>(don_org<span class="o">==</span><span class="s">&quot;RKI&quot;</span>)<span class="o">+</span><span class="m">2</span><span class="o">*</span>(don_org<span class="o">==</span><span class="s">&quot;EKI&quot;</span>)
<span class="k">label var</span> rec_which_k <span class="s">&quot;Which kidney Tx&quot;</span>
<span class="k">label</span> define rec_which_k <span class="m">0</span> <span class="s">&quot;Lt&quot;</span> <span class="m">1</span> <span class="s">&quot;Rt&quot;</span> <span class="m">2</span> <span class="s">&quot;En bloc&quot;</span>
<span class="k">label</span> values rec_which_k rec_which_k
<span class="k">gen</span> rec_pump=<span class="nf">cond</span>(don_lf_ki_pump<span class="o">==</span><span class="s">&quot;Y&quot;</span>,<span class="m">1</span>,<span class="m">0</span>,.)<span class="k"> if</span> rec_which_k<span class="o">==</span><span class="m">0</span>
<span class="k">replace</span> rec_pump=<span class="nf">cond</span>(don_rt_ki_pump<span class="o">==</span><span class="s">&quot;Y&quot;</span>,<span class="m">1</span>,<span class="m">0</span>,.)<span class="k"> if</span> rec_which_k<span class="o">==</span><span class="m">1</span>
<span class="k">replace</span> rec_pump=<span class="m">1</span><span class="k"> if</span> (don_rt_ki_pump<span class="o">==</span><span class="s">&quot;Y&quot;</span> | don_lf_ki_pump<span class="o">==</span><span class="s">&quot;Y&quot;</span>) <span class="o">&amp;</span> rec_which_k<span class="o">==</span><span class="m">2</span>
<span class="k">replace</span> rec_pump=.<span class="k"> if</span> don_rt_ki_pump<span class="o">==</span><span class="s">&quot;&quot;</span> <span class="o">&amp;</span> don_lf_ki_pump<span class="o">==</span><span class="s">&quot;&quot;</span> <span class="o">&amp;</span> rec_pump<span class="o">!=</span>.
<span class="c1">****Reconcile with the SRTR machine perfusion variable****</span>
<span class="m">8</span>
<span class="k">replace</span> rec_pump=<span class="m">1</span><span class="k"> if</span> rec_received_on_pump<span class="o">==</span><span class="m">1</span> <span class="o">&amp;</span> <span class="nf">missing</span>(rec_pump)
<span class="k">label var</span> rec_pump <span class="s">&quot;Donor kidney pumped&quot;</span>
<span class="k">label</span> define rec_pump <span class="m">0</span> <span class="s">&quot;Cold storage&quot;</span> <span class="m">1</span> <span class="s">&quot;Pumped&quot;</span>
<span class="k">label</span> values rec_pump rec_pump
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="model-for-end-stage-liver-disease-meld-listing-transplant">
<h2>24. Model for End-Stage Liver Disease (MELD) (listing /transplant)<a class="headerlink" href="#model-for-end-stage-liver-disease-meld-listing-transplant" title="Permalink to this heading">#</a></h2>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">// -----------------------------------</span>
<span class="c1">// MELD: INR, Serum CR, bilirubin, dialysis within past week</span>
<span class="c1">// -----------------------------------</span>
<span class="c1">//MELD AT TX (BIOLOGIC)</span>
<span class="k">  gen</span> byte meld=can_last_srtr_lab_meld <span class="o">-</span> <span class="m">6200</span> <span class="cs">///</span>
<span class="k">        if</span> <span class="nf">inrange</span>(can_last_srtr_lab_meld, <span class="m">6206</span>, <span class="m">6240</span>)
<span class="k">  replace</span> meld=<span class="m">41</span><span class="k"> if</span> <span class="nf">inlist</span>(can_last_srtr_lab_meld, <span class="m">3010</span>, <span class="m">6011</span>, <span class="m">6012</span>) <span class="c1">//*urgent*</span>
<span class="k">  replace</span> meld=<span class="m">6</span><span class="k"> if</span> can_last_srtr_lab_meld <span class="o">==</span><span class="m">3020</span> <span class="c1">//&quot;non-urgent*</span>
<span class="c1">//MELD AT LISTING (BIOLOGIC)</span>
<span class="k">  gen</span> byte meld_listing=can_init_srtr_lab_meld <span class="o">-</span> <span class="m">6200</span> <span class="cs">///</span>
<span class="k">            if</span> <span class="nf">inrange</span>(can_init_srtr_lab_meld,<span class="m">6206</span>, <span class="m">6240</span>)

<span class="c1">//anoxia</span>
<span class="c1">// CVA/stroke</span>
<span class="k">replace</span> meld_listing=<span class="m">41</span><span class="k"> if</span> <span class="nf">inlist</span>(can_init_srtr_lab_meld, <span class="m">3010</span>, <span class="m">6011</span>, <span class="m">6012</span>) <span class="c1">//*urgent*</span>
<span class="k">  replace</span> meld_listing=<span class="m">6</span><span class="k"> if</span> can_init_srtr_lab_meld <span class="o">==</span><span class="m">3020</span> <span class="c1">//&quot;non-urgent*</span>
<span class="c1">*MELD AT TX (ALLOCATION)</span>
<span class="c1">// status 1A,1B treated as 41</span>
<span class="k">  gen</span> byte meld=can_last_stat <span class="o">-</span> <span class="m">6200</span> <span class="cs">///</span>
<span class="k">        if</span> <span class="nf">inrange</span>(can_last_stat,<span class="m">6206</span>, <span class="m">6240</span>)
<span class="k">  replace</span> meld=<span class="m">41</span><span class="k"> if</span> <span class="nf">inlist</span>(can_last_stat, <span class="m">3010</span>, <span class="m">6011</span>, <span class="m">6012</span>) <span class="c1">//*urgent*</span>
<span class="k">  replace</span> meld=<span class="m">6</span><span class="k"> if</span> can_last_stat <span class="o">==</span><span class="m">3020</span> <span class="c1">//&quot;non-urgent*</span>
<span class="k">  tab</span> can_last_stat<span class="k"> if</span> <span class="nf">missing</span>(meld) <span class="c1">//make sure these are all inactive</span>
<span class="c1">// if inactive (6999) but transplanted (?) or you want to include inactive time on waitlist then replace</span>
<span class="c1">// There is an OPTN version! sensitivity analysis</span>
<span class="c1">//MELD AT LISTING (ALLOCATION)</span>
<span class="k">  gen</span> byte meld_listing=can_init_stat <span class="o">-</span> <span class="m">6200</span> <span class="cs">///</span>
<span class="k">            if</span> <span class="nf">inrange</span>(can_init_stat,<span class="m">6206</span>, <span class="m">6240</span>)
<span class="k">  replace</span> meld_listing=<span class="m">41</span><span class="k"> if</span> <span class="nf">inlist</span>(can_init_stat, <span class="m">3010</span>, <span class="m">6011</span>, <span class="m">6012</span>) <span class="c1">//*urgent*</span>
<span class="k">  replace</span> meld_listing=<span class="m">6</span><span class="k"> if</span> can_init_stat <span class="o">==</span><span class="m">3020</span> <span class="c1">//&quot;non-urgent*</span>
<span class="k">  tab</span> can_init_stat<span class="k"> if</span> <span class="nf">missing</span>(meld_listing) <span class="c1">//make sure these are all inactive</span>
<span class="c1">//time-varying MELD AT LISTING (ALLOCATION) (stathist.dta)</span>
<span class="k">    gen</span> byte ameld=canhx_stat_cd <span class="o">-</span> <span class="m">6200</span> <span class="cs">///</span>
<span class="k">    if</span> <span class="nf">inrange</span>(canhx_stat_cd,<span class="m">6206</span>, <span class="m">6240</span>)
<span class="k">    replace</span> ameld=<span class="m">41</span><span class="k"> if</span> <span class="nf">inlist</span>(canhx_stat_cd, <span class="m">3010</span>, <span class="m">6011</span>, <span class="m">6010</span>, <span class="m">6012</span>) <span class="c1">//*urgent*</span>
<span class="k">    replace</span> ameld=<span class="m">6</span><span class="k"> if</span> canhx_stat_cd <span class="o">==</span><span class="m">3020</span> <span class="c1">//&quot;non-urgent*</span>
<span class="k">    replace</span> ameld = <span class="m">40</span><span class="k"> if</span> canhx_stat_cd<span class="o">&gt;</span><span class="m">6240</span> <span class="o">&amp;</span> canhx_stat_cd<span class="o">&lt;=</span><span class="m">6282</span>
<span class="k">    replace</span> ameld=<span class="m">99</span><span class="k"> if</span> canhx_stat_cd <span class="o">==</span><span class="m">6999</span>
<span class="k">    replace</span> ameld = <span class="m">6</span><span class="k"> if</span> canhx_stat_cd<span class="o">&lt;</span><span class="m">6206</span> <span class="o">&amp;</span> canhx_stat_cd<span class="o">&gt;=</span><span class="m">6188</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="previous-solid-organ-transplant-tx-previous-kidney-transplant-kt">
<h2>25. Previous solid organ transplant (Tx)/ previous kidney transplant (KT)<a class="headerlink" href="#previous-solid-organ-transplant-tx-previous-kidney-transplant-kt" title="Permalink to this heading">#</a></h2>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">// -------------------------------------------</span>
<span class="c1">// Previous solid organ Tx or previous KT-&gt; just to show where to find it</span>
<span class="c1">// -------------------------------------------</span>
<span class="c1">*****Repeat KT variable based on SRTR can_prev_tx variable*****</span>
<span class="k">rename</span> can_prev_ki rec_repeat_kt
<span class="k">label var</span> rec_repeat_kt <span class="s">&quot;Repeat KT based on SRTR can_prev_tx variable&quot;</span>
<span class="c1">****Previous organ transplantation****</span>
<span class="k">rename</span> can_prev_tx rec_prev_tx
<span class="k">label var</span> rec_prev_tx <span class="s">&quot;Previous solid organ Tx&quot;</span>
<span class="k">label</span> define rec_prev_tx <span class="m">0</span> <span class="s">&quot;N&quot;</span> <span class="m">1</span> <span class="s">&quot;Y&quot;</span>
<span class="k">label</span> values rec_prev_tx rec_prev_tx
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="organ-sharing">
<h2>26. Organ Sharing<a class="headerlink" href="#organ-sharing" title="Permalink to this heading">#</a></h2>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">// -----------------------------------</span>
<span class="c1">// Organ Sharing</span>
<span class="c1">// need to merge with srtr1407/../institutions.dta</span>
<span class="c1">// -----------------------------------</span>
<span class="c1">// untested code</span>
<span class="k">gen local</span> = <span class="m">0</span>
<span class="k">gen</span> regional = <span class="m">0</span>
<span class="k">gen</span> national = <span class="m">0</span>
<span class="c1">// must merge to institutions.dta</span>
<span class="c1">// to get rec_region, don_region</span>
<span class="c1">// other race (not white or black)</span>
<span class="k">replace local</span> = <span class="m">1</span><span class="k"> if</span> <span class="o">!</span>(don_org_shared)
<span class="k">replace</span> regional = <span class="m">1</span><span class="k"> if</span> (don_org_shared <span class="o">==</span> <span class="m">1</span>) <span class="o">&amp;</span> (rec_region <span class="o">==</span> don_region)
<span class="k">replace</span> national = <span class="m">1</span><span class="k"> if</span> <span class="o">!</span>(local) <span class="o">&amp;</span> <span class="o">!</span>(regional)
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="de-identification-code">
<h2>27. De-identification Code<a class="headerlink" href="#de-identification-code" title="Permalink to this heading">#</a></h2>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">*DE-IDENTIFICATION CODE:</span>

<span class="cm">/* run this code on a dataset to remove identifiers, dates (less than year), geographic identifiers, or</span>
<span class="cm">// -------------------------------------------------</span>
<span class="cm">// SRTR de-identification     v1.0      Sep 14, 2016</span>
<span class="cm">// CAUTION: this code not guaranteed to de-identify</span>
<span class="cm">// data, please review with your analyst.</span>
<span class="cm">// * drop identifying variables *</span>
<span class="cm">foreach keyw in    id dt date day mrn name ssn  ///</span>
<span class="cm">                   address city county fips zip ///</span>
<span class="cm">                   tel fax email                ///</span>
<span class="cm">        { capture drop *`keyw&#39;* }</span>
<span class="cm">// * drop date-format variables *</span>
<span class="cm">ds, has(format %d* %-d* %t* %-t*)</span>
<span class="cm">capture drop `r(varlist)&#39;</span>
<span class="cm">// * no one older than 90 *</span>
<span class="cm">foreach var of varlist *age* {</span>
<span class="cm">    assert `var&#39; &lt; 90 }</span>
<span class="cm">// -------------------------------------------------</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="transplant-date">
<h2>28. Transplant Date<a class="headerlink" href="#transplant-date" title="Permalink to this heading">#</a></h2>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">// -------------------------------------------</span>
<span class="c1">// transplant date</span>
<span class="c1">// -------------------------------------------</span>
<span class="c1">//If you only deal with Tx recipients but not candidates, just think about tx_dt</span>

<span class="c1">//for waitlist removals and transplant rates when using candidate.dta sets</span>
<span class="k">gen</span> tx_dt= rec_tx_dt
<span class="k">replace</span> tx_dt =can_rem_dt<span class="k"> if</span> <span class="nf">inlist</span>(can_rem_cd,<span class="m">4</span>)
<span class="c1">//if estimating DD transplant rates</span>
<span class="k">replace</span> tx_dt =can_rem_dt<span class="k"> if</span> <span class="nf">inlist</span>(can_rem_cd,<span class="m">4</span>,<span class="m">18</span>,<span class="m">19</span>,<span class="m">21</span>,<span class="m">22</span>)
<span class="k">replace</span> tx_dt = .<span class="k"> if</span> <span class="nf">inlist</span>(can_rem_cd,<span class="m">14</span>,<span class="m">15</span>)
<span class="c1">//to censor live donors</span>
<span class="k">replace</span> tx_dt = .<span class="k"> if</span> can_rem_cd<span class="o">==</span><span class="m">15</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="living-donor-programmed-kidney-injury-ldpki">
<h2>29. Living Donor Programmed Kidney Injury (LDPKI)<a class="headerlink" href="#living-donor-programmed-kidney-injury-ldpki" title="Permalink to this heading">#</a></h2>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="c1">*LKDPI or LD KDPI</span>

<span class="c1">// -------------------------------------------</span>
<span class="c1">// Calculate LKDPI</span>
<span class="c1">// -------------------------------------------</span>
<span class="c1">// m2m?</span>
<span class="k">gen</span> m2m = <span class="m">0</span>
<span class="k">replace</span> m2m = <span class="m">1</span><span class="k"> if</span> (don_fem <span class="o">==</span> <span class="m">0</span> <span class="o">&amp;</span> can_fem <span class="o">==</span> <span class="m">0</span>)
<span class="c1">// MIN of DRWR and 0.9</span>
<span class="k">gen</span> drwr = don_wgt_kg <span class="o">/</span> rec_wgt_kg
<span class="k">replace</span> drwr = <span class="m">0.9</span><span class="k"> if</span> drwr <span class="o">&gt;</span> <span class="m">0.9</span> <span class="o">&amp;</span> <span class="o">!</span><span class="nf">missing</span>(drwr)
<span class="k">sum</span> don_bp_preop_syst, detail
<span class="k">gen</span> sbp = don_bp_preop_syst
<span class="k">tab</span> don_hist_cigarette

<span class="k">gen</span> smok = don_hist_cigarette <span class="o">==</span> <span class="s">&quot;Y&quot;</span>
<span class="c1">// are they ABO incompatible?</span>
<span class="k">tab</span> don_abo can_abo
<span class="k">capture drop</span> aboi
<span class="k">gen</span> aboi = .
<span class="k">replace</span> aboi = <span class="nf">inlist</span>(don_abo, <span class="s">&quot;A&quot;</span>, <span class="s">&quot;A1&quot;</span>, <span class="s">&quot;A2&quot;</span>) <span class="o">&amp;</span> <span class="nf">inlist</span>(can_abo, <span class="s">&quot;B&quot;</span>, <span class="s">&quot;O&quot;</span>) | <span class="cs">///</span>
               <span class="nf">inlist</span>(don_abo, <span class="s">&quot;A1B&quot;</span>, <span class="s">&quot;A2B&quot;</span>, <span class="s">&quot;AB&quot;</span>) <span class="o">&amp;</span> <span class="nf">inlist</span>(can_abo, <span class="s">&quot;A&quot;</span>, <span class="s">&quot;A1&quot;</span>,<span class="s">&quot;A2&quot;</span>,<span class="s">&quot;B&quot;</span>,<span class="s">&quot;O&quot;</span>) | <span class="cs">///</span>
               <span class="nf">inlist</span>(don_abo, <span class="s">&quot;B&quot;</span>) <span class="o">&amp;</span> <span class="nf">inlist</span>(can_abo, <span class="s">&quot;A&quot;</span>, <span class="s">&quot;A1&quot;</span>, <span class="s">&quot;A2&quot;</span>,<span class="s">&quot;O&quot;</span>)
<span class="k">tab</span> aboi
<span class="k">capture drop</span> lkdpi
<span class="c1">// calculate lkdpi</span>
<span class="k">gen</span> lkdpi = <span class="o">-</span><span class="m">11.3</span> <span class="cs">///</span>
    <span class="o">+</span> <span class="m">1.85</span> <span class="o">*</span>  dage50_spline <span class="cs">///</span>
    <span class="o">-</span> <span class="m">0.381</span> <span class="o">*</span> ld_egfr_preop <span class="cs">///</span>
    <span class="o">+</span> <span class="m">1.17</span> <span class="o">*</span>  don_bmi <span class="cs">///</span>
    <span class="o">+</span> <span class="m">22.34</span> <span class="o">*</span> don_black <span class="cs">///</span>
    <span class="o">+</span> <span class="m">14.33</span> <span class="o">*</span> smok <span class="cs">///</span>
    <span class="o">+</span> <span class="m">0.44</span> <span class="o">*</span>  sbp <span class="cs">///</span>
    <span class="o">-</span> <span class="m">21.68</span> <span class="o">*</span> m2m <span class="cs">///</span>
    <span class="o">+</span> <span class="m">27.30</span> <span class="o">*</span> aboi <span class="cs">///fol_age</span>
    <span class="o">-</span> <span class="m">10.61</span> <span class="o">*</span> <span class="o">!</span>don_related <span class="cs">///</span>
    <span class="o">+</span> <span class="m">8.57</span>  <span class="o">*</span> rec_b_mm_equiv_tx <span class="cs">///</span>
    <span class="o">+</span> <span class="m">8.26</span> <span class="o">*</span>  rec_dr_mm_equiv_tx <span class="cs">///</span>
    <span class="o">-</span><span class="m">50.87</span> <span class="o">*</span>  drwr
<span class="k">sum</span> lkdpi, detail
<span class="cs">//// LDKT, version 2 (Based on the above version; defines all variables needed.)</span>
<span class="k">global</span> srtrdir <span class="s">&quot;~/foo/bar&quot;</span>
<span class="k">use</span> <span class="vg">$srtrdir</span><span class="o">/</span>tx_ki,<span class="k"> clear</span>
<span class="k">keep if</span> don_ty<span class="o">==</span><span class="s">&quot;L&quot;</span>
<span class="k">merge</span> <span class="m">1</span>:<span class="m">1</span> donor_id using <span class="vg">$srtrdir</span><span class="o">/</span>donor_live,<span class="k"> keep</span>(master match)
<span class="c1">// Age spline</span>
<span class="k">gen</span> dage50_spline = (don_age<span class="m">-50</span>)<span class="o">*</span>(don_age<span class="o">&gt;</span><span class="m">50</span>)
<span class="c1">// Sex</span>
<span class="k">gen</span> don_female = don_gender<span class="o">==</span><span class="s">&quot;F&quot;</span>
<span class="k">gen</span> can_female = can_gender<span class="o">==</span><span class="s">&quot;F&quot;</span>
<span class="c1">// Race</span>
<span class="k">gen</span> don_black = don_race<span class="o">==</span><span class="m">16</span>
<span class="c1">// CKD epi equation for eGFR</span>
<span class="k">gen</span> ld_male = don_gender<span class="o">==</span><span class="s">&quot;M&quot;</span>
<span class="m">30</span>

<span class="k">gen</span> k = <span class="nf">cond</span>(ld_male, <span class="m">0.9</span>, <span class="m">0.7</span>)
<span class="k">gen</span> a = <span class="nf">cond</span>(ld_male, <span class="o">-</span><span class="m">0.411</span>, <span class="o">-</span><span class="m">0.329</span>)
<span class="k">gen</span> egfr = <span class="m">141</span> <span class="o">*</span> <span class="cs">///</span>
    (<span class="nf">min</span>(don_ki_creat_preop<span class="o">/</span>k, <span class="m">1</span>))<span class="o">^</span>a <span class="o">*</span> <span class="cs">///</span>
    (<span class="nf">max</span>(don_ki_creat_preop<span class="o">/</span>k, <span class="m">1</span>))<span class="o">^</span>(<span class="o">-</span><span class="m">1.209</span>) <span class="o">*</span> <span class="cs">///</span>
    <span class="m">0.993</span><span class="o">^</span>fol_age <span class="o">*</span> <span class="cs">///</span>
    <span class="nf">cond</span>(ld_male, <span class="m">1</span>, <span class="m">1.018</span>) <span class="o">*</span> <span class="cs">///</span>
    <span class="nf">cond</span>(don_black, <span class="m">1.159</span>, <span class="m">1</span>) <span class="cs">///</span>
<span class="k">    if</span> <span class="o">!</span><span class="nf">missing</span>(don_ki_creat_preop)
<span class="k">sum</span> egfr, detail
<span class="k">rename</span> egfr ld_egfr_preop
<span class="c1">// Donor BMI (20191017: why can_wgt_kg???)</span>
<span class="k">gen</span> don_bmi = can_wgt_kg<span class="o">/</span>(don_hgt_cm<span class="o">/</span><span class="m">100</span>)<span class="o">^</span><span class="m">2</span>
<span class="c1">// donor related</span>
<span class="k">gen</span> don_related = <span class="nf">inlist</span>(don_relationship_ty, <span class="m">1</span>,<span class="m">2</span>,<span class="m">3</span>,<span class="m">4</span>,<span class="m">5</span>,<span class="m">6</span>)
<span class="c1">// m2m?</span>
<span class="k">gen</span> m2m = <span class="m">0</span>
<span class="k">replace</span> m2m = <span class="m">1</span><span class="k"> if</span> (don_female <span class="o">==</span> <span class="m">0</span> <span class="o">&amp;</span> can_female <span class="o">==</span> <span class="m">0</span>)
<span class="c1">// MIN of DRWR and 0.9</span>
<span class="k">gen</span> drwr = don_wgt_kg <span class="o">/</span> rec_wgt_kg
<span class="k">replace</span> drwr = <span class="m">0.9</span><span class="k"> if</span> drwr <span class="o">&gt;</span> <span class="m">0.9</span> <span class="o">&amp;</span> <span class="o">!</span><span class="nf">missing</span>(drwr)
<span class="k">sum</span> don_bp_preop_syst, detail
<span class="k">gen</span> sbp = don_bp_preop_syst
<span class="k">tab</span> don_hist_cigarette
<span class="k">gen</span> smok = don_hist_cigarette <span class="o">==</span> <span class="s">&quot;Y&quot;</span>
<span class="c1">// are they ABO incompatible?</span>
<span class="k">tab</span> don_abo can_abo
<span class="k">capture drop</span> aboi
<span class="k">gen</span> aboi = .
<span class="k">replace</span> aboi = <span class="nf">inlist</span>(don_abo, <span class="s">&quot;A&quot;</span>, <span class="s">&quot;A1&quot;</span>, <span class="s">&quot;A2&quot;</span>) <span class="o">&amp;</span> <span class="nf">inlist</span>(can_abo, <span class="s">&quot;B&quot;</span>, <span class="s">&quot;O&quot;</span>) | <span class="nf">inlist</span>(don_abo, <span class="s">&quot;A1B&quot;</span>, <span class="s">&quot;A2</span>
<span class="k">tab</span> aboi
<span class="k">capture drop</span> lkdpi
<span class="c1">// calculate lkdpi</span>
<span class="k">gen</span> lkdpi = <span class="o">-</span><span class="m">11.3</span> <span class="o">+</span> <span class="m">1.85</span> <span class="o">*</span>  dage50_spline <span class="o">-</span> <span class="m">0.381</span> <span class="o">*</span> ld_egfr_preop <span class="o">+</span> <span class="m">1.17</span> <span class="o">*</span>  don_bmi <span class="o">+</span> <span class="m">22.34</span> <span class="o">*</span> don_black
<span class="k">sum</span> lkdpi, detail
</pre></div>
</div>
<hr class="docutils" />
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./act_0/act_0_0/act_0_0_7"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#patient-survival-death">1. Patient survival/death</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#graft-survival-death-censored-and-all-cause">2. Graft survival (death censored and all-cause)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#delayed-graft-function-dgf">3. Delayed Graft Function (DGF)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#primary-non-function-pnf">4. Primary Non-Function (PNF)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#acute-rejection">5. Acute rejection</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#racial-category">6. Racial category</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pra-panel-reactive-antibody-time-varying-pra">7. PRA (Panel Reactive Antibody), Time-varying PRA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#kidney-disease-etiology-diagnosis">8. Kidney disease etiology/diagnosis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fix-abo-abo-mismatch">9. Fix ABO/ABO mismatch</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#age-categories">10. Age categories</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#body-mass-index-bmi">11. Body Mass Index (BMI)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cit-cold-ischemia-time">12. CIT (Cold Ischemia Time)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#donor-diabetes-mellitus-dm-hypertension-htn-terminal-serum-creatinine-scr-1-5-and-manually-recode-expanded-criteria-donor-ecd-scr-assessment">13. Donor Diabetes Mellitus (DM), Hypertension (HTN), terminal Serum Creatinine (SCr) &gt;1.5, and manually recode Expanded Criteria Donor (ECD), SCr Assessment</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hla-mismatch">14. HLA mismatch</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#duration-of-pre-kt-dialysis-vs-listing">15. Duration of pre-KT dialysis (vs listing?)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hepatitis-c-virus-hcv-by-diagnosis-for-candidate-by-serostatus-for-recipient-by-serostatus-for-donor">16. Hepatitis C Virus (HCV) (by diagnosis for candidate/by serostatus for recipient/by serostatus for donor)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hepatocellular-carcinoma-hcc-by-diagnosis-by-exception-points">17. Hepatocellular Carcinoma (HCC) (by diagnosis/by exception points)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#immunosuppression-induction">18. Immunosuppression/Induction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#insurance">19. Insurance</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#kidney-donor-risk-index-kdri-kidney-donor-profile-index-kdpi">20. Kidney Donor Risk Index (KDRI)/Kidney Donor Profile Index (KDPI)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#donor-risk-index-dri">21. Donor Risk Index (DRI)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estimated-post-transplant-survival-epts">22. Estimated Post Transplant Survival (EPTS)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#machine-perfusion">23. Machine perfusion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-for-end-stage-liver-disease-meld-listing-transplant">24. Model for End-Stage Liver Disease (MELD) (listing /transplant)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#previous-solid-organ-transplant-tx-previous-kidney-transplant-kt">25. Previous solid organ transplant (Tx)/ previous kidney transplant (KT)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#organ-sharing">26. Organ Sharing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#de-identification-code">27. De-identification Code</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transplant-date">28. Transplant Date</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#living-donor-programmed-kidney-injury-ldpki">29. Living Donor Programmed Kidney Injury (LDPKI)</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Your Name
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright Mwaka.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>